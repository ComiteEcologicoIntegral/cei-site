(this.webpackJsonpcei=this.webpackJsonpcei||[]).push([[0],{116:function(e,a,t){},120:function(e,a,t){},124:function(e,a,t){"use strict";t.r(a);var c=t(1),n=t(13),s=t.n(n),r=(t(96),t(97),t(10)),i=t(8),l=t(142),o=t(143),d=t(89),j=t(2),u=function(){return Object(j.jsxs)("div",{className:"container mt-5 mb-3",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h3",{children:"Concentraci\xf3n horaria"}),Object(j.jsx)("p",{children:"Conoce las recomendaciones seg\xfan el \xedndice de calidad del aire"})]}),Object(j.jsxs)(l.a.Container,{fill:!0,defaultActiveKey:"buena",className:"recomendaciones h-100",children:[Object(j.jsxs)(o.a,{fill:!0,children:[Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"buena",className:"nav-buena",children:"Buena"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"acept",className:"nav-acept",children:"Aceptable"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"mala",className:"nav-mala",children:"Mala"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"muy",className:"nav-muy",children:"Muy Mala"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"ext",className:"nav-ext",children:"Extremadamente Mala"})})]}),Object(j.jsxs)(l.a.Content,{children:[Object(j.jsx)(l.a.Pane,{eventKey:"buena",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(j.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(j.jsx)("li",{children:"Sin riesgo para personas vulnerables"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"acept",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(j.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(j.jsx)("li",{children:"Personas vulnerables limitar actividades f\xedsicas"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"mala",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Limitar actividades f\xedsicas al aire libre, incrementar frecuencia de descansos, vigilar que estudiantes no presenten s\xedntomas de afecciones respiratorias."}),Object(j.jsx)("li",{children:"Limitar tiempo de exposici\xf3n"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Considerar suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Se recomienda el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"muy",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(j.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(j.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Acudir al m\xe9dico en caso de s\xedntomas de afectaciones a la salud"}),Object(j.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(j.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(j.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"}),Object(j.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"ext",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(j.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(j.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Acudir al m\xe9dico o solicitar servicios de emergencias en caso de s\xedntomas de afectaciones a la salud"}),Object(j.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(j.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"}),Object(j.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(j.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"})]})})]})]})]})},b=t(140),m=t(81),O=t(130),h=t(138),x=t(131),f=t(82),p=t(139),v=t(83),g=t(19),N=t(20),y=[{value:"PM25",label:"PM2.5"},{value:"PM10",label:"PM10"},{value:"O3",label:"O3"},{value:"CO",label:"CO"},{value:"NO2",label:"NO2"},{value:"SO2",label:"SO2"}],S=[{value:"1",label:"Tiempo real"},{value:"2",label:"12 horas"},{value:"3",label:"24 horas"},{value:"4",label:"\xdaltima semana"},{value:"5",label:"\xdaltimo mes"},{value:"6",label:"\xdaltimo a\xf1o"}],C=function(e){var a=e.onApply,t=Object(g.c)((function(e){return e})).sensorData,n=Object(c.useMemo)((function(){return t.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud})).map((function(e){return{value:e.Sensor_id,label:e.Zona}}))}),[t]),s=Object(c.useState)(!1),r=Object(i.a)(s,2),l=r[0],o=r[1],d=Object(c.useState)(null),u=Object(i.a)(d,2),C=u[0],M=u[1],D=Object(c.useState)(S[0]),P=Object(i.a)(D,2),k=P[0],w=P[1],Y=Object(c.useState)(y[0]),E=Object(i.a)(Y,2),A=E[0],L=E[1],R=function(){return o(!1)};return Object(j.jsxs)("div",{className:"container mt-5",children:[Object(j.jsx)(b.a,{children:Object(j.jsxs)(b.a.Row,{className:"mapa-filtros",children:[Object(j.jsx)(m.a,{className:"mb-3",xs:12,lg:4,children:Object(j.jsx)(N.a,{placeholder:"Ubicaci\xf3n",value:C,onChange:M,options:n})}),Object(j.jsx)(m.a,{className:"mb-3",xs:6,lg:3,children:Object(j.jsx)(N.a,{isDisabled:!0,options:S,onChange:w,value:k})}),Object(j.jsx)(m.a,{xs:6,lg:3,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:10,children:Object(j.jsx)(N.a,{options:y,value:A,onChange:L})}),Object(j.jsx)(m.a,{xs:2,children:Object(j.jsx)(h.a,{placement:"top",overlay:Object(j.jsx)(x.a,{children:"Info. indicadores"}),children:Object(j.jsx)(f.a,{className:"info-btn",variant:"link",onClick:function(){return o(!0)},children:Object(j.jsx)(v.a,{color:"MediumVioletRed"})})},"top")})]})}),Object(j.jsx)(m.a,{children:Object(j.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){a({gas:A,location:C,interval:k}),M(null),w(S[0])},children:"Aplicar"})})]})}),Object(j.jsxs)(p.a,{size:"lg",show:l,onHide:R,children:[Object(j.jsx)(p.a.Header,{closeButton:!0,children:Object(j.jsx)(p.a.Title,{children:"Indicadores"})}),Object(j.jsxs)(p.a.Body,{children:[Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"PM 10"}),"\u2003 Material Particulado menor a 10 micr\xf3metros"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mezcla compleja de part\xedculas l\xedquidas o s\xf3lidas que provienen de fuentes naturales o de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 10 micr\xf3metros."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"PM 2.5"}),"\u2003 Material Particulado menor a 2.5 micr\xf3metros"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mezcla Compleja de Part\xedculas l\xedquidas o s\xf3lidas que provienen principalmente de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 2.5 micr\xf3metros."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"O2"}),"\u2003 Ozono"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Gas compuesto por 3 \xe1tomos de oxigeno que se encuentra principalmente en la estratosfera, puede formarse a nivel superficial debido a condiciones de alta radiaci\xf3n y temperatura."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"CO"}),"\u2003 Mon\xf3xido de Carbono"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Gas incoloro que se forma principalmente por la combusti\xf3n de gasolinas, le\xf1a o carb\xf3n, este compuesto, en altas concentraciones puede ser muy nocivo a la salud."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"SO2"}),"\u2003 Di\xf3xido de Azufre"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Es un gas formado por 2 \xe1tomos de ox\xedgeno y uno de azufre, se forma principalmente por la combusti\xf3n de combustibles f\xf3siles con alto contenido de azufre."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"NO2"}),"\u2003 Di\xf3xido de Nitr\xf3geno"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mol\xe9cula con 2 \xe1tomos de ox\xedgeno y uno de Nitr\xf3geno que se produce principalmente por la combusti\xf3n de combustibles f\xf3siles empleados en veh\xedculos y plantas de energ\xeda."})})]}),Object(j.jsx)(p.a.Footer,{children:Object(j.jsx)(f.a,{variant:"secondary",onClick:R,children:"Cerrar"})})]})]})},M=t(30),D=t(28),P=(t(79),t(23)),k=t(132),w=t(133),Y=t(9),E=t.n(Y),A=function(e){if("number"!=typeof e)return e;var a=e.toFixed(2);return parseInt(a)===e?e:a};function L(e){var a=e.label,t=e.status,n=e.position,l=e.current,o=e.provider,d=e.locationStr,u=e.labels,b=e.lastUpdate,m=(e.map,e.shape),O=void 0===m?"round":m,h=Object(M.a)(e,["label","status","position","current","provider","locationStr","labels","lastUpdate","map","shape"]),x=Object(c.useMemo)((function(){return document.createElement("div")}),[]),p=Object(c.useRef)(),v=Object(c.useState)(null),g=Object(i.a)(v,2),N=g[0],y=g[1],S=Object(c.useCallback)((function(e,a){s.a.render(function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"round";return Object(j.jsxs)("div",{className:"marker-wrapper",style:{zIndex:"round"===t?-1:-10},children:[Object(j.jsx)("div",{className:"marker-".concat(a," marker-base marker-shape-").concat(t)}),Object(j.jsx)("span",{className:"marker-".concat(a),style:{backgroundColor:"transparent"},children:A(e)})]})}(e,a,O),x),y(Object(D.divIcon)({html:x,className:"sensor-icon ".concat("round"===O?"":"behind"),popupAnchor:[7,0]}))}),[O]);return Object(c.useEffect)((function(){S(a,t)}),[a,t,S]),N?Object(j.jsx)(k.a,Object(r.a)(Object(r.a)({position:n,icon:N},h),{},{children:Object(j.jsxs)(w.a,{ref:p,className:"custom-popup",closeButton:function(e){return Object(j.jsx)("button",Object(r.a)(Object(r.a)({},e),{},{type:"button",class:"btn-close","aria-label":"Close"}))},children:[Object(j.jsxs)("div",{className:"px-3 py-2",children:[Object(j.jsxs)("div",{className:"rounded marker-".concat(l.status),style:{display:"flex",justifyContent:"center",padding:"0 0.1rem "},children:[l.indicator,": ",l.label," ",l.units]}),Object(j.jsxs)("div",{className:"data-label",children:[Object(j.jsx)("small",{className:"text-muted",children:"Ubicaci\xf3n"}),Object(j.jsx)("br",{}),Object(j.jsx)("data",{children:d})]}),Object(j.jsxs)("div",{className:"data-label",children:[Object(j.jsx)("small",{className:"text-muted",children:"\xdaltima actualizaci\xf3n"}),Object(j.jsx)("br",{}),Object(j.jsx)("time",{children:E()(b).format("ddd, MMMM D YYYY, h:mm:ss a")})]}),Object(j.jsx)("div",{className:"data-label",children:Object(j.jsx)("small",{className:"text-muted",children:"Tiempo Real"})}),Object(j.jsx)("div",{children:u.map((function(e,a){var t=e.label,c=e.status,n=e.value,s=e.units;return Object(j.jsxs)("div",{className:"d-flex justify-content-between rt-data-row mb-1",children:[Object(j.jsx)(P.b,{to:{pathname:"registro",search:"?gas=".concat(t)},children:t}),Object(j.jsxs)("div",{className:"d-inline-flex justify-content-between px-1 rounded marker-".concat(c),children:[Object(j.jsx)("span",{children:n}),Object(j.jsx)("span",{children:s})]})]},a)}))})]}),Object(j.jsxs)("div",{className:"py-2 px-3 border-top text-center",children:[Object(j.jsx)(f.a,{size:"sm",children:"M\xe1s informaci\xf3n"}),Object(j.jsxs)("p",{className:"lh-sm mt-2 mb-0",children:["Fuente(s): ",Object(j.jsx)("a",{target:"blank",href:o.ref,children:o.name})]})]})]})})):null}L.defaultProps={};var R=L,z=(t(116),t(134)),F=t(148);function I(e){var a=e.center,t=e.children,c=Object(M.a)(e,["center","children"]);return Object(j.jsxs)(z.a,Object(r.a)(Object(r.a)({center:a,scrollWheelZoom:!1,style:{height:"100%",widht:"100%"}},c),{},{children:[Object(j.jsx)(F.a,{attribution:'\xa9 <a href="https://stadiamaps.com/">Stadia Maps</a>, \xa9 <a href="https://openmaptiles.org/">OpenMapTiles</a> \xa9 <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png?api_key=e4368efd-701c-4da6-8372-03f4040a622a"}),t]}))}I.defaultProps={};var q=I,T=[{name:"PM25",label:"PM2.5",units:"\u03bcg/m3"},{name:"PM10",units:"\u03bcg/m3"},{name:"O3",units:"ppm"},{name:"CO",units:"ppm"},{name:"NO2",units:"ppm"},{name:"SO2",units:"ppm"}],_={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},H=["Sinaica"],K="/api",U={"Aire y Salud":{PM10:[50,75,155,235],PM25:[25,45,78,147],O3:[.051,.095,.135,.175],CO:[8.75,11,13.3,15.5],SO2:[.008,.11,.165,.22],NO2:[.107,.21,.23,.25]},NOM:{PM10:[100,135,214,300],PM25:[55,75,97.4,128.8],O3:[.07,.093,.115,.137],CO:[12,13.9,15.9,18.9],SO2:[.253,.345,.435,.566],NO2:[.132,.176,.221,.289]}},B=function(e,a){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Aire y Salud",c=U[t][e],n=c.length-1;n>=0;n--)if(a>c[n])return parseInt(n)+1;return 0},V=function e(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return new Promise((function(n,s){a().then(n).catch((function(){setTimeout((function(){if(!c)return s("Se excedi\xf3 el n\xfamero m\xe1ximo de intentos");e(a,t,c-1).then(n,s)}),t)}))}))},G=function(){return new Promise((function(e,a){fetch("".concat(K,"/sensor-summary")).then((function(e){if(200===e.status)return e.json();a()})).then((function(a){e(a)})).catch((function(e){return a(e)}))}))},Z=function(){return V(G)},Q=t(87),J=Object(Q.a)({name:"data",initialState:{sensorData:[],sensorDataLastUpdate:null},reducers:{setSensorData:function(e,a){Array.isArray(a.payload)&&(e.sensorData=a.payload,e.sensorDataLastUpdate=E()())}}}),W=J.actions.setSensorData,X=J.reducer,$=function(e){var a=e.cacheTime,t=void 0===a?60:a,n=e.useCache,s=void 0===n||n,r=Object(g.c)((function(e){return e})),l=r.sensorDataLastUpdate,o=r.sensorData,d=Object(g.b)(),j=Object(c.useState)(!0),u=Object(i.a)(j,2),b=u[0],m=u[1],O=Object(c.useState)(o),h=Object(i.a)(O,2),x=h[0],f=h[1],p=Object(c.useState)(null),v=Object(i.a)(p,2),N=v[0],y=v[1];return Object(c.useEffect)((function(){(l&&s?E()().diff(l,"minutes"):999)>t?Z().then((function(e){d(W(e)),f(e)})).catch((function(e){console.error(e),f([]),y(e)})).finally((function(){return m(!1)})):m(!1)}),[l,d,t,s]),{loading:b,data:x,error:N}},ee=t(135),ae=t(146),te={center:[25.67,-100.25],zoom:11,minZoom:10};var ce=function(){var e=Object(c.useState)(T[0]),a=Object(i.a)(e,2),t=a[0],n=a[1],s=$({}),l=s.data,o=s.loading,d=s.error,b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],x=m[1],p=Object(c.useCallback)((function(e){O&&O.setView(e,te.zoom,{animate:!0})}),[O]),v=Object(c.useMemo)((function(){return l.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud&&!H.includes(e.Sistema)})).map((function(e){var a,c=t.name,n=t.units,s="PM25"===c&&"PurpleAir"===e.Sistema?e.PM25_Promedio:e[c],r="number"===typeof s?s:"ND";return{position:[e.Latitud,e.Longitud],current:{indicator:t.label?t.label:c,label:r,units:n,status:"ND"!==r?B(c,r):99,ref:"#"},lastUpdate:E.a.utc(e.Dia).local(),locationStr:(null===(a=e.Zona)||void 0===a?void 0:a.length)>0?e.Zona:"ND",provider:{name:e.Sistema,ref:"PurpleAir"===e.Sistema?"https://www.purpleair.com/map?mylocation":"AireNuevoLeon"===e.Sistema?"http://aire.nl.gob.mx/":"Sinaica"===e.Sistema?"https://sinaica.inecc.gob.mx/":"#"},isPurpleAir:"PurpleAir"===e.Sistema,labels:T.map((function(a){var t=a.name,c=a.label,n=a.units,s=t;return"PM25"===t&&"PurpleAir"===e.Sistema&&(s="PM25_Promedio"),{label:c||t,units:n,value:"number"===typeof e[s]?e[s]:"ND",status:e[s]?B(t,e[s]):99,ref:"#"}}))}}))}),[l,t]);return Object(j.jsxs)("div",{children:[Object(j.jsx)(C,{onApply:function(e){var a=e.gas,c=e.location;if(c){var s=l.find((function(e){return e.Sensor_id===c.value}));s&&p([s.Latitud,s.Longitud])}if(a){var r=T.find((function(e){return e.name===a.value}));n(null!==r&&void 0!==r?r:t)}}}),Object(j.jsxs)("div",{className:"my-4",style:{zIndex:0,position:"relative",width:"100%",height:"500px"},children:[d&&Object(j.jsx)("div",{className:"position-absolute w-100 end-0 p-2",style:{zIndex:100},children:Object(j.jsx)("div",{class:"alert alert-danger",role:"alert",children:"Ocurri\xf3 un error al cargar los datos."})}),o&&Object(j.jsx)("div",{className:"w-100 h-100 d-flex position-absolute",style:{zIndex:100,backgroundColor:"rgba(0,0,0,0.2)"},children:Object(j.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(j.jsx)(ee.a,{animation:"border"})})}),Object(j.jsx)("div",{className:"w-100 h-100 position-absolute p-2",style:{zIndex:99,pointerEvents:"none"},children:Object(j.jsx)("div",{className:"position-absolute end-0",children:Object(j.jsx)(h.a,{trigger:"click",placement:"left",overlay:Object(j.jsxs)(ae.a,{children:[Object(j.jsx)(ae.a.Title,{as:"h3",children:"Leyenda"}),Object(j.jsxs)(ae.a.Content,{children:[Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)("div",{style:{boxSizing:"border-box",borderRadius:"100%",width:"35px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores del estado se representan con un c\xedrculo"]}),Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)("div",{style:{boxSizing:"border-box",width:"28px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores de Purple Air se representan con un cuadrado"]})]})]}),children:Object(j.jsx)(f.a,{variant:"link",className:"pe-auto",children:"Leyenda"})})})}),Object(j.jsx)(q,Object(r.a)(Object(r.a)({whenCreated:x},te),{},{children:!o&&v.map((function(e,a){return Object(j.jsx)(R,Object(r.a)(Object(r.a)({map:O},e),{},{label:e.current.label,indicator:e.current.indicator,status:e.current.status,shape:e.isPurpleAir?"square":"round"}),a)}))}))]}),Object(j.jsx)(u,{})]})},ne=t(136),se=t(137),re=[{value:"PM25",label:"PM2.5"},{value:"PM10",label:"PM10"},{value:"O3",label:"O3"},{value:"CO",label:"CO"},{value:"NO2",label:"NO2"},{value:"SO2",label:"SO2"}];var ie=function(e){var a=e.createQueryGraph,t=e.createQueryCal,n=e.radioValue,s=e.setRadioValue,r=e.updateMainFiltros,l=Object(g.b)(),o=Object(g.c)((function(e){return e})),d=o.sensorDataLastUpdate,u=o.sensorData,O=Object(c.useState)(null),h=Object(i.a)(O,2),x=h[0],p=h[1],v=[];Object(c.useEffect)((function(){(d?E()().diff(d,"minutes"):999)>60?Z().then((function(e){l(W(e)),p(e)})).catch((function(e){return console.error(e)})):p(u)}),[]),x&&x.forEach((function(e){v.push({value:e.Sensor_id,label:e.Zona})}));var y=Object(c.useRef)(null),S=Object(c.useRef)(re[0]);return Object(j.jsxs)("div",{className:"mt-5",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h2",{children:"Registro Hist\xf3rico"}),Object(j.jsx)("p",{children:"Consulta los datos hist\xf3ricos de la calidad del aire"})]}),Object(j.jsxs)(b.a,{children:[Object(j.jsx)(b.a.Row,{className:"mb-3",children:Object(j.jsx)(m.a,{xs:12,children:Object(j.jsx)(N.a,{isMulti:!0,options:v,placeholder:"Ubicaci\xf3n",onChange:function(e){y.current=e}})})}),Object(j.jsxs)(b.a.Row,{children:[Object(j.jsx)(m.a,{children:Object(j.jsx)(ne.a,{toggle:!0,children:[{name:"Grafica",value:"1"},{name:"Calendario",value:"2"}].map((function(e,a){return Object(j.jsx)(se.a,{className:"toggle-vista",type:"radio",variant:"light",name:"radio",value:e.value,checked:n===e.value,onChange:function(e){return s(e.currentTarget.value)},children:e.name},a)}))})}),Object(j.jsx)(m.a,{className:"mb-3",children:Object(j.jsx)(N.a,{options:re,placeholder:"Indicador",onChange:function(e){S.current=e},defaultValue:re[0]})}),Object(j.jsx)(m.a,{xs:12,sm:3,className:"mb-3",children:Object(j.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){return r(y.current,S.current),void("1"==n?a():t())},children:"Aplicar"})})]})]}),Object(j.jsx)("hr",{className:"mt-2 mb-4"})]})},le=t(63),oe=t.n(le);var de=function(e){var a=e.setDesde,t=e.setHasta,n=e.data,s=e.layout,r=e.summary;return Object(c.useEffect)((function(){a(null),t(null)}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)(b.a,{className:"mt-4 mb-4",children:Object(j.jsxs)(b.a.Row,{className:"d-flex justify-content-evenly",children:[Object(j.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:2,children:Object(j.jsxs)(b.a.Label,{className:"col-form-label",children:["Desde:"," "]})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return a(E()(e.target.value))}})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"time"})})]})}),Object(j.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:2,children:Object(j.jsxs)(b.a.Label,{className:"col-form-label",children:["Hasta:"," "]})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return t(E()(e.target.value))}})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"time"})})]})})]})}),Object(j.jsxs)(O.a,{className:"mb-5",children:[Object(j.jsxs)(m.a,{sm:12,lg:4,xl:3,children:[Object(j.jsx)(O.a,{children:Object(j.jsx)(f.a,{className:"btn btn-light mb-4",block:!0,children:"Descargar datos"})}),Object(j.jsxs)(O.a,{className:"d-flex justify-content-around",children:[Object(j.jsx)(m.a,{sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado",children:[Object(j.jsxs)(m.a,{sm:5,children:[Object(j.jsx)("p",{className:"tipo",children:"M\xe1ximo"}),Object(j.jsx)("p",{className:"desc",children:r&&(null===r||void 0===r?void 0:r.max.date)?"Registrado el ".concat(null===r||void 0===r?void 0:r.max.date):""})]}),Object(j.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero muymala",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.max.value)?r.max.value.toFixed(2):"-"})})]})}),Object(j.jsx)(m.a,{sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado",children:[Object(j.jsxs)(m.a,{sm:5,children:[Object(j.jsx)("p",{className:"tipo",children:"M\xednimo"}),Object(j.jsx)("p",{className:"desc",children:r&&(null===r||void 0===r?void 0:r.min.date)?"Registrado el ".concat(null===r||void 0===r?void 0:r.min.date):""})]}),Object(j.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero acept",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.min.value)?r.min.value.toFixed(2):"-"})})]})}),Object(j.jsx)(m.a,{sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado",children:[Object(j.jsx)(m.a,{sm:5,children:Object(j.jsx)("p",{className:"tipo",children:"Promedio"})}),Object(j.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero mala",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.avg.value)?r.avg.value.toFixed(2):"-"})})]})})]})]}),Object(j.jsx)(m.a,{sm:12,lg:8,xl:9,children:Object(j.jsx)("div",{className:"grafico mb-4",children:Object(j.jsx)(oe.a,{data:n,layout:s})})})]})]})},je=(t(120),t(144)),ue=t(147);var be=t(141),me=function(e){var a=e.value,t=e.onChange,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],l=s[1];function o(e){return e.isAfter(new Date,"day")}function d(e){return function(e){return a.isSame(e,"day")}(e)?"selected":function(e){return e.isSame(new Date,"day")}(e)?"today":o(e)?"after":function(e){return e.isSame(a,"month")}(e)?"":"month"}function u(){return a.clone().subtract(1,"month")}function b(){return a.clone().endOf("month").add(1,"day")}function h(){return a.isSame(new Date,"month")}function x(){return a.isSame(new Date("01-01-2018"),"month")}return Object(c.useEffect)((function(){l(function(e){for(var a=e.clone().startOf("month").startOf("isoWeek"),t=e.clone().endOf("month").endOf("isoWeek").subtract(1,"day"),c=a.clone().subtract(2,"day"),n=[];c.isBefore(t,"day");)n.push(Array(7).fill(0).map((function(){return c.add(1,"day").clone()})));return n}(a))}),[a]),Object(j.jsxs)("div",{className:"calendar mt-5",children:[Object(j.jsx)("div",{className:"cal-header",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,className:"previous",onClick:function(){return!x()&&t(u)},children:x()?null:String.fromCharCode(171)}),Object(j.jsxs)(m.a,{sm:6,className:"current",children:[a.format("MMM"),", ",a.format("YYYY")]}),Object(j.jsx)(m.a,{sm:3,className:"next",onClick:function(){return!h()&&t(b)},children:h()?null:String.fromCharCode(187)})]})}),Object(j.jsxs)("div",{className:"body",children:[Object(j.jsx)("div",{className:"day-names",children:["D","L","M","M","J","V","S"].map((function(e,a){return Object(j.jsx)("div",{className:"weekday",children:e},a)}))}),r.map((function(e,a){return Object(j.jsx)("div",{children:e.map((function(e,a){return Object(j.jsx)("div",{className:"day",onClick:function(){return!o(e)&&t(e)},children:Object(j.jsx)("div",{className:d(e),children:e.format("D")},Object(be.a)())})}))},a)}))]})]})},Oe=t(50);t(69);E.a.locale("es");var he={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},xe=[{value:"1",label:"enero"},{value:"2",label:"febrero"},{value:"3",label:"marzo"},{value:"4",label:"abril"},{value:"5",label:"mayo"},{value:"6",label:"junio"},{value:"7",label:"julio"},{value:"8",label:"agosto"},{value:"9",label:"septiembre"},{value:"10",label:"octubre"},{value:"11",label:"noviembre"},{value:"12",label:"diciembre"}],fe=[{value:"2018",label:"2018"},{value:"2019",label:"2019"},{value:"2020",label:"2020"},{value:"2021",label:"2021"}];var pe=function(e){var a=e.q,t=e.create,n=e.data,s=e.indi,r=e.setDesde,l=e.setHasta,o=e.downloadFile;function d(e){switch(B(s,e)){case 0:return"bueno";case 1:return"acept";case 2:return"mala";case 3:return"muymala";case 4:return"extmala";default:return"no-data"}}var u=Object(c.useState)(E()()),b=Object(i.a)(u,2),h=b[0],x=b[1];Object(c.useEffect)((function(){r(h),l(h)}),[]);var p=Object(c.useState)((new Date).getMonth()+1),v=Object(i.a)(p,2),g=v[0],y=v[1],S=Object(c.useState)(fe[fe.length-1].value),C=Object(i.a)(S,2),M=C[0],D=C[1];Object(c.useEffect)((function(){r(h),l(h),(n||a)&&t(h,h)}),[h]),Object(c.useEffect)((function(){var e=new Date("".concat(g,"/").concat(h.clone().format("DD"),"/").concat(M));x(E()(e))}),[g,M]);var P=[],k=[],w=0,Y=0;if(n&&0!==n.length){for(;Y<12&&w<n.length;){for(var A="T"+Y.toString().padStart(2,0)+":",L=[],R=w;w<n.length&&n[w].dia.includes(A);)L.push(Object(j.jsxs)("p",{children:[Object(j.jsx)(Oe.b,{className:d(n[w][s])}),n[w].zona,": ",n[w][s]?" ".concat(n[w][s]," ").concat(he[s]):" No hay registro"]})),w++;P.push(Object(j.jsx)(je.a,{id:n[R].registros_id,children:Object(j.jsxs)(ue.a,{children:[Object(j.jsx)(ue.a.Header,{children:Object(j.jsxs)(je.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[R].registros_id,children:[Object(j.jsx)(Oe.a,{color:"lightgray"})," ",Y.toString().padStart(2,0),":00"]})}),Object(j.jsx)(je.a.Collapse,{eventKey:n[R].registros_id,children:Object(j.jsx)(ue.a.Body,{children:L})})]})},n[R].registros_id)),Y++}for(;Y<24&&w<n.length;){for(var z="T"+Y.toString().padStart(2,0),F=[],I=w;w<n.length&&n[w].dia.includes(z);)F.push(Object(j.jsxs)("p",{children:[Object(j.jsx)(Oe.b,{className:d(n[w][s])})," ",n[w].zona,": ",n[w][s]?"".concat(n[w][s]," ").concat(he[s]):"No hay registro"]})),w++;k.push(Object(j.jsx)(je.a,{id:n[I].registros_id,children:Object(j.jsxs)(ue.a,{children:[Object(j.jsx)(ue.a.Header,{children:Object(j.jsxs)(je.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[I].registros_id,children:[Object(j.jsx)(Oe.a,{color:"lightgray"})," ",Y.toString().padStart(2,0),":00"]})}),Object(j.jsx)(je.a.Collapse,{eventKey:n[I].registros_id,children:Object(j.jsx)(ue.a.Body,{children:F})})]})},n[I].registros_id)),Y++}}else P.push(Object(j.jsx)("p",{children:"No hay datos para este d\xeda"}));return Object(j.jsx)("div",{className:"container mb-10",children:Object(j.jsxs)(O.a,{className:"mb-5",children:[Object(j.jsx)(m.a,{sm:12,lg:6,children:Object(j.jsxs)("div",{children:[Object(j.jsx)(f.a,{className:"btn btn-light mb-4 mt-4",block:!0,onClick:o,children:"Descargar datos del mes"}),Object(j.jsxs)(O.a,{className:"mb-4",children:[Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(N.a,{options:xe,placeholder:"Mes",onChange:function(e){return y(e.value)},defaultValue:xe[(new Date).getMonth()]})}),Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(N.a,{options:fe,placeholder:"A\xf1o",onChange:function(e){return D(e.value)},defaultValue:fe[fe.length-1]})})]}),Object(j.jsxs)("div",{className:"detalles",children:[Object(j.jsxs)("h4",{children:[h&&h.format("DD/MM/YYYY")," Detalle por hora"]}),Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:6,children:P}),Object(j.jsx)(m.a,{sm:6,children:k})]})]})]})}),Object(j.jsx)(m.a,{sm:12,lg:6,className:"d-flex align-items-start justify-content-center",children:Object(j.jsx)(me,{value:h,onChange:x})})]})})},ve=t(84),ge=t.n(ve);var Ne=function(e){var a=e.q,t=e.fecha,n=e.ubic,s=e.ind,l=Object(c.useState)(null),o=Object(i.a)(l,2),d=o[0],u=o[1],b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],h=m[1],x=Object(c.useRef)(null),f=Object(c.useRef)(d),p="";Object(c.useEffect)((function(){t&&(d&&d.isSame(t.clone().startOf("month"))||(f.current=d,u(t.clone().startOf("month"))))}),[t]),Object(c.useEffect)((function(){var e="";a&&(e=a.substring(0,a.indexOf("&inicio"))),x.current&&x.current===e&&f.current==d||(x.current!==a&&(x.current=e),f.current!=d&&(f.current=d),n&&d&&(p="ubic=",n.forEach((function(e){p+=e.value+","})),p=p.slice(0,-1),p+="&ind="+s+"&inicio="+d.clone().format("YYYY-MM-DD")+"&fin="+d.clone().endOf("month").format("YYYY-MM-DD"),console.log("Query HM: "+p),fetch("".concat(K,"/prom-data?").concat(p)).then((function(e){return e.json()})).then((function(e){return h(e)})).catch((function(e){return console.log(e)}))))}),[a,d]);var v={},g=[];if(a&&O&&O.length>0){for(var N=0,y={},S=0;S<n.length&&O[N];S++){for(var C=O[N].zona,M=new Date(O[N].fecha.replace(/-/g,"/").replace(/T.+/,"")),D=1,P={name:C,data:[]};M.getDate()!==D;)y.x=D,y.y=-1,P.data.push(Object(r.a)({},y)),D++;for(;N<O.length&&O[N].zona===C;)y.x=D,D==parseInt(O[N].fecha.substring(8))?(""!==O[N].prom?(y.y=O[N].prom,y.fecha=O[N].fecha):y.y=-1,N++):y.y=-1,P.data.push(Object(r.a)({},y)),D++;g.push(Object(r.a)({},P))}v={chart:{type:"heatmap",toolbar:{show:!1}},plotOptions:{heatmap:{enableShades:!1,radius:1,useFillColorAsStroke:!1,colorScale:{ranges:[{from:-2,to:0,name:"No data",color:"#D3D3D3"},{from:0,to:U["Aire y Salud"][s][0],name:"Buena",color:"#00E400"},{from:U["Aire y Salud"][s][0],to:U["Aire y Salud"][s][1],name:"Aceptable",color:"#FFFF00"},{from:U["Aire y Salud"][s][1],to:U["Aire y Salud"][s][2],name:"Mala",color:"#FF7E00"},{from:U["Aire y Salud"][s][2],to:U["Aire y Salud"][s][3],name:"Muy mala",color:"#FF0000"},{from:U["Aire y Salud"][s][3],to:1.5*U["Aire y Salud"][s][3],name:"Extremadamente mala",color:"#8F3F97"}]}}},dataLabels:{enabled:!1},stroke:{width:1},xaxis:{position:"bottom"},legend:{position:"top",showForSingleSeries:!0},tooltip:{custom:function(e){var a=e.series,t=e.seriesIndex,c=e.dataPointIndex,n=e.w;return-1!==a[t][c]?'<div class="arrow_box hmTooltip"><p>'+n.globals.initialSeries[t].data[c].fecha+"</p><p><b>"+a[t][c].toFixed(4)+" "+_[s]+"</b></p></div>":'<div style="display:none;">'}}}}return Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{className:"mb-5",children:"Promedios diarios del mes"}),a&&Object(j.jsx)(ge.a,{options:v,series:g,type:"heatmap",height:100*g.length})]})};E.a.locale("es");var ye=function(){var e=Object(c.useState)(null),a=Object(i.a)(e,2),t=a[0],n=a[1],s=Object(c.useState)(null),l=Object(i.a)(s,2),o=l[0],d=l[1],u=Object(c.useState)("1"),b=Object(i.a)(u,2),m=b[0],O=b[1],h=Object(c.useState)(null),x=Object(i.a)(h,2),f=x[0],p=x[1],v=Object(c.useState)(!1),g=Object(i.a)(v,2),N=g[0],y=g[1],S=Object(c.useState)(null),C=Object(i.a)(S,2),M=C[0],D=C[1],P=Object(c.useState)(null),k=Object(i.a)(P,2),w=k[0],Y=k[1],A=Object(c.useRef)({value:"PM25"}),L=Object(c.useRef)(null);function R(e,a){if(L.current){e&&a||(e=M,a=w);var t="ubic=";L.current.forEach((function(e){t+=e.value+","})),t=t.slice(0,-1),t+="&ind="+A.current.value+"&inicio="+e.format("YYYY-MM-DD")+"&fin="+a.format("YYYY-MM-DD"),console.log(t),p(t)}else alert("Selecciona una ubicaci\xf3n.")}function z(){if(f){var e="ubic=";L.current.forEach((function(a){e+=a.value+","})),e=e.slice(0,-1),e+="2"===m?"&ind="+A.current.value+"&inicio="+M.startOf("month").format("YYYY-MM-DD")+"&fin="+w.endOf("month").format("YYYY-MM-DD"):"&ind="+A.current.value+"&inicio="+M.format("YYYY-MM-DD")+"&fin="+w.format("YYYY-MM-DD"),fetch("".concat(K,"/download-data?").concat(e)).then((function(e){return e.blob()})).then((function(e){var a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download="data.csv";t.addEventListener("click",(function e(){setTimeout((function(){URL.revokeObjectURL(a),t.removeEventListener("click",e)}),150)}),!1),t.click()}))}}return Object(c.useEffect)((function(){f&&("1"===m?fetch("".concat(K,"/get-graph?").concat(f)).then((function(e){return e.json()})).then((function(e){n(e.plot),d(e.summary),y(!1)})):fetch("".concat(K,"/datos-fecha?").concat(f)).then((function(e){return e.json()})).then((function(e){return n(e)})))}),[f]),Object(c.useEffect)((function(){n(null)}),[m]),Object(j.jsxs)("div",{className:"container mb-10",children:[Object(j.jsx)(ie,{createQueryGraph:function(){if(L)if(M&&w){y(!0);var e=L.current.map((function(e){return e.label})).reduce((function(e,a){return""===e?"locations=".concat(a):"".concat(e,"&locations=").concat(a)}),""),a="".concat(e,"&gas=").concat(A.current.value,"&start_date=").concat(E.a.utc(M).format("MM/DD/YYYY"),"&end_date=").concat(E.a.utc(w).format("MM/DD/YYYY"));console.log(a),p(a)}else alert("Selecciona las fechas.");else alert("Selecciona una ubicaci\xf3n.")},createQueryCal:R,radioValue:m,setRadioValue:O,updateMainFiltros:function(e,a){L.current=e,A.current=a}}),"1"===m&&Object(j.jsx)(de,Object(r.a)({setDesde:D,setHasta:Y,downloadFile:z,summary:o},t)),"2"===m&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(pe,{q:f,create:R,data:t,indi:A.current.value,setDesde:D,setHasta:Y,downloadFile:z}),Object(j.jsx)(Ne,{q:f,fecha:M,ubic:L.current,ind:A.current.value})]}),Object(j.jsx)("div",{children:Object(j.jsx)("img",{src:"loading.gif",alt:"Cargando...",className:"loading",style:N?{}:{display:"none"}})})]})},Se=t(88),Ce=[{value:"PM25",label:"PM2.5"},{value:"PM10",label:"PM10"},{value:"O3",label:"O3"},{value:"CO",label:"CO"},{value:"NO2",label:"NO2"},{value:"SO2",label:"SO2"}],Me=function(e){var a=Object(c.useRef)(e.id),t=e.sensores,n=Object(c.useRef)(t[0].value?t[0].value:null),s=Object(c.useRef)(Ce[0].value),r=Object(c.useRef)(null),i=Object(c.useRef)(null);function l(){var t={ubic:n.current,ind:s.current,desde:r.current,hasta:i.current};e.modifyData(t,a.current)}return Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)("div",{className:"compara-filtros mt-2 mb-4",id:"filtro-"+a.current,children:Object(j.jsxs)(b.a,{children:[Object(j.jsx)(b.a.Group,{as:O.a,children:Object(j.jsx)(m.a,{sm:12,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(N.a,{options:t,defaultValue:t[0],className:"mb-2",onChange:function(e){n.current=e.value,l()}})}),Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(N.a,{options:Ce,defaultValue:Ce[0],onChange:function(e){s.current=e.value,l()}})})]})})}),Object(j.jsx)(b.a.Group,{as:O.a,children:Object(j.jsx)(m.a,{sm:12,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:6,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,children:Object(j.jsx)("p",{children:"Desde:"})}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){r.current=e.target.value,l()}})})]})}),Object(j.jsx)(m.a,{sm:6,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,children:Object(j.jsx)("p",{children:"Hasta:"})}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){i.current=e.target.value,l()}})})]})})]})})})]})})})};var De=function(){var e=Object(g.b)(),a=Object(g.c)((function(e){return e})),t=a.sensorDataLastUpdate,n=a.sensorData,s=Object(c.useState)(null),r=Object(i.a)(s,2),l=r[0],o=r[1],d=[];Object(c.useEffect)((function(){(t?E()().diff(t,"minutes"):999)>60?Z().then((function(a){e(W(a)),o(a)})).catch((function(e){return console.error(e)})):o(n)}),[]),l&&l.forEach((function(e){d.push({value:e.Sensor_id,label:e.Zona})}));var u=Object(c.useRef)(-1),b=Object(c.useState)([]),h=Object(i.a)(b,2),x=h[0],p=h[1],v=Object(c.useRef)([]),N=Object(c.useState)(null),y=Object(i.a)(N,2),S=y[0],C=y[1];function M(e,a){v.current[a]=e}Object(c.useEffect)((function(){!function(){var e=[];if(S){for(var a=function(a){var t=d.find((function(e){return e.value===v.current[a].ubic})).label,c="PM25"==v.current[a].ind?"PM2.5":v.current[a].ind;S[a].name="".concat(t," (").concat(c,")"),S[a].type="scatter",S[a].mode="lines+markers",S[a].marker={color:Y[a]},S[a].text=S[a].dia.map((function(e){return E.a.utc(new Date(e)).local()})),S[a].hovertemplate="<i>Medida</i>: %{y:.4f}<br><b>%{text}</b>",e.push(S[a])},t=0;t<S.length;t++)a(t);console.log(e),w(e)}}()}),[S]);var D=Object(c.useState)([]),P=Object(i.a)(D,2),k=P[0],w=P[1],Y=["red","green","blue","orange"];return Object(j.jsxs)("div",{className:"container mt-5",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h2",{children:"Compara datos"}),Object(j.jsx)("p",{children:"Compara la calidad del aire en diferente lugar y tiempo"})]}),Object(j.jsx)("hr",{className:"mb-4"}),Object(j.jsx)(O.a,{className:"mt-2 mb-1 d-flex justify-content-center",id:"filtros",children:x}),Object(j.jsx)(O.a,{className:"d-flex justify-content-end",children:Object(j.jsxs)(m.a,{sm:6,className:"d-flex justify-content-between",children:[Object(j.jsx)(f.a,{onClick:function(){u.current<3&&(u.current=u.current+1,p([].concat(Object(Se.a)(x),[Object(j.jsx)(Me,{id:u.current,modifyData:M,sensores:d})])))},children:"Agregar un filtro"}),Object(j.jsx)(f.a,{onClick:function(){return function(){if(-1!=u.current){var e=document.getElementById("filtro-".concat(u.current)).parentNode;e.parentNode.removeChild(e),u.current=u.current-1}}()},children:"Eliminar un filtro"}),Object(j.jsx)(f.a,{onClick:function(){return function(){if(!(u.current<0)){for(var e="",a="",t="",c="",n=0;n<=u.current;n++){if(!(v.current[n]&&v.current[n].desde&&v.current[n].hasta))return void alert("Llena todos los campos");e+=v.current[n].ubic+",",a+=v.current[n].ind+",",t+=v.current[n].desde+",",c+=v.current[n].hasta+","}e=e.slice(0,-1),a=a.slice(0,-1),t=t.slice(0,-1),c=c.slice(0,-1);var s="ubic=".concat(e,"&ind=").concat(a,"&inicio=").concat(t,"&fin=").concat(c);console.log(s),fetch("".concat(K,"/compare?").concat(s)).then((function(e){return e.json()})).then((function(e){C(e)}))}}()},children:"Generar gr\xe1fica"})]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)(m.a,{sm:12,children:Object(j.jsx)("div",{class:"grafico mt-5",children:Object(j.jsx)(oe.a,{data:k,layout:{title:"Compara datos",hovermode:"closest",width:1e3,height:500}})})})})]})},Pe=t(12),ke=t(145),we=function(){var e=Object(c.useState)(!1),a=Object(i.a)(e,2),t=a[0],n=a[1];return Object(j.jsxs)(ke.a,{variant:"dark",expand:"lg",expanded:t,children:[Object(j.jsx)(ke.a.Brand,{children:Object(j.jsx)(P.c,{to:"/",children:Object(j.jsx)("img",{src:"/logo.jpg",width:"40",height:"40",className:"d-inline-block align-top",alt:"React Bootstrap logo"})})}),Object(j.jsx)(ke.a.Text,{children:Object(j.jsx)("h1",{className:"white h1-nav mb-0",children:"Comit\xe9 Ecol\xf3gico Integral (Beta)"})}),Object(j.jsx)(ke.a.Toggle,{"aria-controls":"basic-navbar-nav",onClick:function(){return n(!t&&"expanded")}}),Object(j.jsx)(ke.a.Collapse,{id:"basic-navbar-nav",children:Object(j.jsxs)(o.a,{className:"ml-auto",children:[Object(j.jsx)(P.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",exact:!0,to:"/",children:"Mapa"}),Object(j.jsx)(P.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/registro",children:"Registro hist\xf3rico"}),Object(j.jsx)(P.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/compara",children:"Compara datos"}),Object(j.jsx)(P.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/",children:"Acerca de"})]})})]})},Ye=function(){return Object(j.jsx)("footer",{children:Object(j.jsx)("div",{className:"container",children:Object(j.jsx)("div",{className:"row",children:Object(j.jsxs)("div",{className:"col-auto py-3",children:[Object(j.jsxs)("p",{className:"mb-1 mt-2",children:["Los datos oficiales provienen de"," ",Object(j.jsx)("a",{className:"text-white",href:"https://sinaica.inecc.gob.mx/",children:"Sinaica"})," ","y de ",Object(j.jsx)("a",{className:"text-white",href:"http://aire.nl.gob.mx/",children:"Sima"})]}),Object(j.jsx)("p",{className:"mb-1",children:"Patrocinado por Natuuramika\xae 2021"}),Object(j.jsx)("p",{children:"Proyecto Solidario TEC de Monterrey"})]})})})})};var Ee=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(P.a,{children:[Object(j.jsx)(we,{}),Object(j.jsxs)(Pe.c,{children:[Object(j.jsx)(Pe.a,{exact:!0,path:"/",component:ce}),Object(j.jsx)(Pe.a,{exact:!0,path:"/registro",component:ye}),Object(j.jsx)(Pe.a,{exact:!0,path:"/compara",component:De})]}),Object(j.jsx)(Ye,{})]})})},Ae=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,149)).then((function(a){var t=a.getCLS,c=a.getFID,n=a.getFCP,s=a.getLCP,r=a.getTTFB;t(e),c(e),n(e),s(e),r(e)}))},Le=t(17),Re=t(75),ze=t(85),Fe=t.n(ze),Ie=Object(Re.a)({key:"root",storage:Fe.a},X),qe=t(86),Te=function(){var e=Object(Le.e)(Ie);return{store:e,persistor:Object(Re.b)(e)}}(),_e=Te.store,He=Te.persistor;s.a.render(Object(j.jsx)(g.a,{store:_e,children:Object(j.jsx)(qe.a,{loading:null,persistor:He,children:Object(j.jsx)(P.a,{children:Object(j.jsx)(Ee,{})})})}),document.getElementById("root")),Ae()},96:function(e,a,t){},97:function(e,a,t){}},[[124,1,2]]]);
//# sourceMappingURL=main.22e9f91e.chunk.js.map