{"version":3,"sources":["../node_modules/react-bootstrap/esm/ButtonGroup.js","../node_modules/react-bootstrap/esm/ToggleButton.js","components/RHFiltros.js","components/Grafica.js","Registro.js","constants.js","handlers/data.js"],"names":["ButtonGroup","React","forwardRef","_ref","ref","bsPrefix","size","toggle","vertical","className","_ref$as","as","Component","rest","_objectWithoutPropertiesLoose","prefix","useBootstrapPrefix","baseClass","createElement","_extends","classNames","displayName","defaultProps","role","noop","ToggleButton","children","name","checked","type","onChange","value","disabled","inputRef","props","_useState","useState","focused","setFocused","handleFocus","useCallback","e","target","tagName","handleBlur","Button","undefined","active","autoComplete","onFocus","onBlur","systemOptions","label","opt","RHFiltros","createQueryGraph","createQueryCal","radioValue","setRadioValue","updateMainFiltros","dispatch","useDispatch","useSelector","state","sensorDataLastUpdate","sensorData","sensRaw","setSensRaw","sensores","useEffect","moment","diff","fetchSummaryData","then","data","setSensorData","catch","err","console","error","system","setSystem","indicadores","indOptions","setIndOptions","location","setLocation","sistema","useRef","ubicacion","indicador","forEach","element","Sistema","idBlacklistpriv","includes","Sensor_id","push","Zona","Form","Row","Col","xs","options","placeholder","current","map","radio","idx","variant","currentTarget","defaultValue","sm","block","onClick","Grafica","setDesde","setHasta","setDesdeHora","setHastaHora","layout","downloadFile","summary","lg","Label","Control","required","event","xl","max","date","toFixed","min","avg","porcentajes","arribaLimite","buenos","nulos","config","responsive","locale","Calendario","lazy","HeatMap","Registro","setData","summaryData","setSummaryData","queryString","setQueryString","loading","setLoading","noData","setNoData","desde","hasta","desdeHora","hastaHora","ind","syst","initialDate","endingDate","queryStr","format","alert","startOf","endOf","getQueryStringToDownload","fetch","apiUrl","response","blob","url","URL","createObjectURL","a","document","href","download","addEventListener","clickHandler","setTimeout","revokeObjectURL","removeEventListener","click","json","hasOwnProperty","fechasArray","plot","x","fecha","time","duration","subtract","split","Modal","show","onHide","aria-labelledby","centered","Header","closeButton","Body","utc","u","i","s","src","alt","style","display","fallback","q","create","indi","ubic","gases","units","unidad","PM25","PM10","CO","O3","NO2","SO2","idBlacklist","mapBlacklist","process","REACT_APP_API_URL","retry","fn","ms","retries","Promise","resolve","reject","fetchSummaryDataFn","res","status"],"mappings":"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","file":"static/js/11.6e26636c.chunk.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport classNames from 'classnames';\nimport React from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nvar defaultProps = {\n  vertical: false,\n  toggle: false,\n  role: 'group'\n};\nvar ButtonGroup = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      size = _ref.size,\n      toggle = _ref.toggle,\n      vertical = _ref.vertical,\n      className = _ref.className,\n      _ref$as = _ref.as,\n      Component = _ref$as === void 0 ? 'div' : _ref$as,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"bsPrefix\", \"size\", \"toggle\", \"vertical\", \"className\", \"as\"]);\n\n  var prefix = useBootstrapPrefix(bsPrefix, 'btn-group');\n  var baseClass = prefix;\n  if (vertical) baseClass = prefix + \"-vertical\";\n  return /*#__PURE__*/React.createElement(Component, _extends({}, rest, {\n    ref: ref,\n    className: classNames(className, baseClass, size && prefix + \"-\" + size, toggle && prefix + \"-toggle\")\n  }));\n});\nButtonGroup.displayName = 'ButtonGroup';\nButtonGroup.defaultProps = defaultProps;\nexport default ButtonGroup;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport classNames from 'classnames';\nimport React, { useCallback, useState } from 'react';\nimport Button from './Button';\n\nvar noop = function noop() {\n  return undefined;\n};\n\nvar ToggleButton = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var children = _ref.children,\n      name = _ref.name,\n      className = _ref.className,\n      checked = _ref.checked,\n      type = _ref.type,\n      onChange = _ref.onChange,\n      value = _ref.value,\n      disabled = _ref.disabled,\n      inputRef = _ref.inputRef,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"name\", \"className\", \"checked\", \"type\", \"onChange\", \"value\", \"disabled\", \"inputRef\"]);\n\n  var _useState = useState(false),\n      focused = _useState[0],\n      setFocused = _useState[1];\n\n  var handleFocus = useCallback(function (e) {\n    if (e.target.tagName === 'INPUT') setFocused(true);\n  }, []);\n  var handleBlur = useCallback(function (e) {\n    if (e.target.tagName === 'INPUT') setFocused(false);\n  }, []);\n  return /*#__PURE__*/React.createElement(Button, _extends({}, props, {\n    ref: ref,\n    className: classNames(className, focused && 'focus', disabled && 'disabled'),\n    type: undefined,\n    active: !!checked,\n    as: \"label\"\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: name,\n    type: type,\n    value: value,\n    ref: inputRef,\n    autoComplete: \"off\",\n    checked: !!checked,\n    disabled: !!disabled,\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    onChange: onChange || noop\n  }), children);\n});\nToggleButton.displayName = 'ToggleButton';\nexport default ToggleButton;","import moment from 'moment';\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Form, ButtonGroup, Button, Col, ToggleButton } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport Select from 'react-select';\r\nimport { fetchSummaryData } from '../handlers/data';\r\nimport { setSensorData } from '../redux/reducers';\r\nimport { indicadores, idBlacklistpriv } from '../constants'\r\n\r\n// Diferente a la que esta definida en constants porque este debe de decir AireNL/Sinaica junto\r\nconst systemOptions = [\r\n    { value: \"PurpleAir\", label: 'PurpleAir', opt: 'P' },\r\n    { value: \"AireNuevoLeon\", label: 'AireNuevoLeon/Sinaica', opt: 'G' }\r\n]\r\n\r\n// Componente para la página de Registro Histórico\r\nfunction RHFiltros({\r\n    createQueryGraph,\r\n    createQueryCal,\r\n    radioValue,\r\n    setRadioValue,\r\n    updateMainFiltros,\r\n}) {\r\n    /* \r\n        Parámetros:\r\n            - createQueryGraph: función para crear query de la gráfica\r\n            - createQueryCal: función para crear query del calendario\r\n            - radioValue: sección seleccionada\r\n            - setRadioValue: función para cambiar el radioValue\r\n            - updateMainFiltros: función para updatear en el componente padre los inputs seleccionados\r\n    */\r\n\r\n\r\n    const radios = [\r\n        { name: 'Grafica', value: '1' },\r\n        { name: 'Calendario', value: '2' },\r\n    ];\r\n\r\n    const dispatch = useDispatch();\r\n    const { sensorDataLastUpdate, sensorData } = useSelector((state) => state);\r\n\r\n    const [sensRaw, setSensRaw] = useState(null);\r\n    let sensores = [];\r\n\r\n    useEffect(() => {\r\n        // TODO: convertir a hook\r\n        const diff = sensorDataLastUpdate\r\n            ? moment().diff(sensorDataLastUpdate, 'minutes')\r\n            : 999;\r\n\r\n        if (diff > 60) {\r\n            fetchSummaryData()\r\n                .then((data) => {\r\n                    dispatch(setSensorData(data));\r\n                    setSensRaw(data);\r\n                })\r\n                .catch((err) => console.error(err));\r\n        } else {\r\n            setSensRaw(sensorData);\r\n        }\r\n    }, []);\r\n\r\n    const [system, setSystem] = useState(\"\")\r\n    const [indOptions, setIndOptions] = useState(indicadores);\r\n    const [location, setLocation] = useState(null)\r\n\r\n    const sistema = useRef(null);\r\n    const ubicacion = useRef(null);\r\n    const indicador = useRef(indicadores[0]);\r\n\r\n    useEffect(() => {\r\n        system.value === \"PurpleAir\" ? setIndOptions([indicadores[0]]) : setIndOptions(indicadores)\r\n    }, [system]); // Updatea los gases disponibles cuando cambia la variable sistemas\r\n\r\n    // Crear valores para el dropdown:\r\n    if (sensRaw) {\r\n        sensRaw.forEach((element) => {\r\n            if (system.value === element.Sistema &&\r\n                !idBlacklistpriv.includes(element.Sensor_id)) {\r\n                sensores.push({ value: element.Sensor_id, label: element.Zona });\r\n            }\r\n        });\r\n    }\r\n\r\n    // Función general para crear el query\r\n    function createQuery() {\r\n        updateMainFiltros(ubicacion.current, indicador.current, sistema.current); // Actualiza los valores de los filtros en el componente padre\r\n        if (radioValue === '1') {\r\n            createQueryGraph();\r\n        } else {\r\n            createQueryCal();\r\n        }\r\n    }\r\n    return (\r\n        <div className=\"mt-5\">\r\n            <div className=\"ta-center mb-5\">\r\n                <h2>Registro Histórico</h2>\r\n                <p>Consulta los datos históricos de la calidad del aire</p>\r\n            </div>\r\n            <Form>\r\n                <Form.Row className=\"mb-3\">\r\n                    <Col xs={6}>\r\n                        <Select\r\n                            options={systemOptions}\r\n                            placeholder={'Sistema'}\r\n                            onChange={(value) => {\r\n                                setLocation(null)\r\n                                ubicacion.current = null\r\n                                sistema.current = value\r\n                                setSystem(value)\r\n                            }}\r\n                        />\r\n                    </Col>\r\n                    <Col xs={6}>\r\n                        <Select\r\n                            options={sensores}\r\n                            value={location}\r\n                            placeholder={'Ubicación'}\r\n                            onChange={(value) => {\r\n                                setLocation(value)\r\n                                ubicacion.current = value;\r\n                            }}\r\n                        />\r\n                    </Col>\r\n                </Form.Row>\r\n                <Form.Row>\r\n                    <Col>\r\n                        <ButtonGroup toggle>\r\n                            {radios.map((radio, idx) => (\r\n                                <ToggleButton\r\n                                    className=\"toggle-vista\"\r\n                                    key={idx}\r\n                                    type=\"radio\"\r\n                                    variant=\"light\"\r\n                                    name=\"radio\"\r\n                                    value={radio.value}\r\n                                    checked={radioValue === radio.value}\r\n                                    onChange={(e) =>\r\n                                        setRadioValue(e.currentTarget.value)\r\n                                    }\r\n                                >\r\n                                    {radio.name}\r\n                                </ToggleButton>\r\n                            ))}\r\n                        </ButtonGroup>\r\n                    </Col>\r\n                    <Col className=\"mb-3\">\r\n                        <Select\r\n                            options={indOptions}\r\n                            placeholder={'Indicador'}\r\n                            onChange={(value) => {\r\n                                indicador.current = value;\r\n                            }}\r\n                            defaultValue={indicadores[0]}\r\n                        />\r\n                    </Col>\r\n                    <Col xs={12} sm={3} className=\"mb-3\">\r\n                        <Button\r\n                            className=\"btn-aplicar\"\r\n                            variant=\"primary\"\r\n                            block\r\n                            onClick={() => createQuery()}\r\n                        >\r\n                            Aplicar\r\n                        </Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n            <hr className=\"mt-2 mb-4\" />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default RHFiltros;\r\n","import moment from 'moment';\r\nimport React, { useEffect } from 'react';\r\nimport { Form, Button, Row, Col } from 'react-bootstrap';\r\nimport Plot from 'react-plotly.js';\r\n\r\nfunction Grafica({ setDesde, setHasta, setDesdeHora, setHastaHora, data, layout, downloadFile, summary}) {\r\n    useEffect(() => {\r\n        setDesde(null);\r\n        setHasta(null);\r\n        setDesdeHora('00:00:00')\r\n        setHastaHora('00:00:00')\r\n    }, []);\r\n    return (\r\n        <div>\r\n            <Form className=\"mt-4 mb-4\">\r\n                <Form.Row className=\"d-flex justify-content-evenly\">\r\n                    <Col xs={12} lg={5} className=\"mb-3\">\r\n                        <Row>\r\n                            <Col xs={2}>\r\n                                <Form.Label className=\"col-form-label\">\r\n                                    Desde:{' '}\r\n                                </Form.Label>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    type=\"date\"\r\n                                    required\r\n                                    onChange={(event) => setDesde(moment(event.target.value))}\r\n                                ></Form.Control>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    onChange={(event) => setDesdeHora(event.target.value + ':00')}\r\n                                    type=\"time\"></Form.Control>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col xs={12} lg={5} className=\"mb-3\">\r\n                        <Row>\r\n                            <Col xs={2}>\r\n                                <Form.Label className=\"col-form-label\">\r\n                                    Hasta:{' '}\r\n                                </Form.Label>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    type=\"date\"\r\n                                    required\r\n                                    onChange={(event) =>\r\n                                        setHasta(moment(event.target.value))\r\n                                    }\r\n                                ></Form.Control>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    onChange={(event) => setHastaHora(event.target.value + ':00')}\r\n                                    type=\"time\"></Form.Control>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n\r\n            <Row className=\"mb-5\">\r\n                <Col xs={12} lg={4} xl={2}>\r\n                    <Row xs={12}>\r\n                        <Button className=\"btn btn-light mb-4\" block\r\n                                onClick = {() => {\r\n                                    downloadFile()\r\n                                }}>\r\n                            Descargar datos\r\n                        </Button>\r\n                    </Row>\r\n                    <Row className=\"d-flex justify-content-center\">\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Máximo</p>\r\n                                    <p className=\"desc text-center\">{summary && summary?.max.date ? `Registrado el ${summary?.max.date}` : ''}</p>\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero muymala text-center\">\r\n                                        {summary && typeof summary?.max.value === 'number'\r\n                                            ? summary.max.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Mínimo</p>\r\n                                    <p className=\"desc text-center\">{summary && summary?.min.date ? `Registrado el ${summary?.min.date}` : ''}</p>\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero acept text-center\">\r\n                                        {summary && typeof summary?.min.value === 'number'\r\n                                            ? summary.min.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex align-items-center justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Promedio</p>\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero mala text-center\">\r\n                                        {summary && typeof summary?.avg.value === 'number'\r\n                                            ? summary.avg.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex align-items-center justify-content-center\">\r\n                                <Row sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Arriba de la norma</p>\r\n                                </Row>\r\n                                <Row sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-center\">\r\n                                    <p className={`numero text-center ${summary ? (summary.porcentajes.arribaLimite === 0 ? \"bueno\" : summary.porcentajes.arribaLimite > 25 ? \"muymala\" : \"mala\") : null}`}>{summary ? summary.porcentajes.arribaLimite + '%' : '-'}</p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={12} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado\">\r\n                                <Col xs={6} sm={6}\r\n                                    className=\"d-flex flex-column align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Datos Válidos</p>\r\n                                    <p className=\"numero bueno text-center\">{summary ? summary.porcentajes.buenos + '%' : '-'}</p>\r\n                                </Col>\r\n                                <Col xs={6} sm={6}\r\n                                    className=\"d-flex flex-column align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Datos Nulos</p>\r\n                                    <p className=\"numero muymala text-center\">{summary ? summary.porcentajes.nulos + '%' : '-'}</p>\r\n                                </Col>\r\n                            </Row>\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n\r\n                <Col sm={12} lg={8} xl={10}>\r\n                    <div className=\"grafico mb-4\">\r\n                        {data && (\r\n                            <Plot className=\"grafico-resize\" data={data} layout={layout} config={{ responsive: true }} />\r\n                        )}\r\n                        {typeof data == 'undefined' && (\r\n                            <div>Seleccionar un sensor, contaminante y fechas para ver sus datos</div>\r\n                        )}\r\n                    </div>\r\n                </Col>\r\n                <Row className=\"d-block d-sm-none w-100\" xs={11}>\r\n                    <p>*Para una mejor visualización, utiliza el telefono horizontalmente.</p>\r\n                </Row>\r\n            </Row>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Grafica;\r\n","import React, { useState, useEffect, useRef, Suspense, lazy } from \"react\";\r\nimport RHFiltros from \"./components/RHFiltros\";\r\nimport Grafica from \"./components/Grafica\";\r\nimport moment from \"moment\";\r\nimport \"moment/locale/es\";\r\nimport { apiUrl } from \"./constants\";\r\nimport { Modal } from \"react-bootstrap\";\r\n\r\nmoment.locale(\"es\");\r\n\r\nconst Calendario = lazy(() => import(\"./components/Calendario\")) \r\nconst HeatMap  = lazy(() => import(\"./components/HeatMap\"));\r\n\r\nfunction Registro() {\r\n  const [data, setData] = useState(null);\r\n  const [summaryData, setSummaryData] = useState(null);\r\n  const [radioValue, setRadioValue] = useState(\"1\"); // sección seleccionada (Gráfica/Calendario)\r\n  const [queryString, setQueryString] = useState(null); // string del query\r\n\r\n  const [loading, setLoading] = useState(false); // gif\r\n  const [noData, setNoData] = useState(false); // Desplegar mensaje si no se encontraron datos en la BD\r\n\r\n  // Datos de los filtros:\r\n  //const [indi, setIndi] = useState('PM25');\r\n  const [desde, setDesde] = useState(null);\r\n  const [hasta, setHasta] = useState(null);\r\n  const [desdeHora, setDesdeHora] = useState(\"00:00:00\");\r\n  const [hastaHora, setHastaHora] = useState(\"00:00:00\");\r\n  const ind = useRef({ value: \"PM25\" });\r\n  const ubicacion = useRef(null);\r\n  const syst = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (queryString) {\r\n      if (radioValue === \"1\") {\r\n        // Sección gráfica\r\n        fetch(`${apiUrl}/get-graph-opt?${queryString}`)\r\n          .then((response) => response.json())\r\n          .then((json) => {\r\n            if (json.hasOwnProperty(\"message\")) setNoData(true);\r\n            // Hacer cambio de horario por la zona horaria\r\n            let fechasArray = [];\r\n            if (json.plot.data) {\r\n              json.plot.data[0].x.forEach((fecha) => {\r\n                let time = moment.duration(\"05:00:00\");\r\n                fecha = moment(fecha).subtract(time).format();\r\n                fechasArray.push(fecha.split(\"-05:00\")[0]);\r\n              });\r\n            }\r\n            json.plot.data[0].x = fechasArray;\r\n\r\n            setData(json.plot);\r\n            setSummaryData(json.summary);\r\n            setLoading(false);\r\n          });\r\n      } else {\r\n        // Sección calendario\r\n        fetch(`${apiUrl}/datos-fecha?${queryString}`)\r\n          .then((response) => response.json())\r\n          .then((json) => setData(json));\r\n      }\r\n    }\r\n  }, [queryString]); // Cada que cambia el string del query creado, hacemos un request al api\r\n\r\n  useEffect(() => {\r\n    setData(null);\r\n  }, [radioValue]); // Cuando cambiamos entre Gráfica y Calendario, borramos los datos\r\n\r\n  // Esta función es llamada por un componente hijo para actualizar los valores cada que cambian en los filtros\r\n  function updateMainFiltros(u, i, s) {\r\n    syst.current = s;\r\n    ubicacion.current = u;\r\n    ind.current = i;\r\n  }\r\n\r\n  // Crea el string del query para la gráfica\r\n  function createQueryGraph() {\r\n    if (!ubicacion.current) {\r\n      alert(\"Selecciona una ubicación.\");\r\n      return;\r\n    }\r\n    if (!desde || !hasta) {\r\n      alert(\"Selecciona las fechas.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true); // Muestra gif de loading\r\n\r\n    let queryStr = `location=${ubicacion.current.label}&gas=${\r\n      ind.current.value\r\n    }&system=${syst.current.opt}&start_date=${moment\r\n      .utc(desde)\r\n      .format(\"MM/DD/YYYY\")}${\"/\"}${desdeHora}&end_date=${moment\r\n      .utc(hasta)\r\n      .format(\"MM/DD/YYYY\")}${\"/\"}${hastaHora}`;\r\n\r\n    setQueryString(queryStr);\r\n  }\r\n\r\n  // Crea el string del query para el calendario\r\n  function createQueryCal(initialDate, endingDate) {\r\n    // Ejemplo:\r\n    // http://127.0.0.1:8000/datos-fecha?ubic=PA39362&ind=PM25&inicio=2020-10-05&fin=2020-10-06\r\n\r\n    if (!ubicacion.current) {\r\n      alert(\"Selecciona una ubicación.\");\r\n      return;\r\n    }\r\n\r\n    if (!initialDate || !endingDate) {\r\n      initialDate = desde;\r\n      endingDate = hasta;\r\n    }\r\n\r\n    let queryStr = \"ubic=\";\r\n    queryStr += ubicacion.current.value;\r\n\r\n    queryStr +=\r\n      \"&ind=\" +\r\n      ind.current.value +\r\n      \"&inicio=\" +\r\n      initialDate.format(\"YYYY-MM-DD\") +\r\n      \"&fin=\" +\r\n      endingDate.format(\"YYYY-MM-DD\");\r\n\r\n    setQueryString(queryStr);\r\n  }\r\n\r\n  function getQueryStringToDownload() {\r\n    if (queryString) {\r\n      let queryStr = \"location=\";\r\n\r\n      queryStr += ubicacion.current.value;\r\n      if (radioValue === \"2\") {\r\n        // Para el calendario se descarga todo el mes\r\n        queryStr +=\r\n          \"&gas=\" +\r\n          ind.current.value +\r\n          \"&start_date=\" +\r\n          desde.startOf(\"month\").format(\"YYYY-MM-DD\") +\r\n          \"&end_date=\" +\r\n          hasta.endOf(\"month\").format(\"YYYY-MM-DD\");\r\n      } else {\r\n        // Para la sección de la gráfica se descarga según las fechas seleccionadas\r\n        queryStr +=\r\n          \"&gas=\" +\r\n          ind.current.value +\r\n          \"&start_date=\" +\r\n          desde.format(\"YYYY-MM-DD\") +\r\n          \"&end_date=\" +\r\n          hasta.format(\"YYYY-MM-DD\");\r\n      }\r\n\r\n      return queryStr;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  function downloadFile() {\r\n    let queryStr = getQueryStringToDownload();\r\n\r\n    if (queryStr) {\r\n      fetch(`${apiUrl}/download-data?${queryStr}`)\r\n        .then((response) => response.blob())\r\n        .then((blob) => {\r\n          const url = URL.createObjectURL(blob);\r\n\r\n          const a = document.createElement(\"a\");\r\n          a.href = url;\r\n          a.download = \"data.csv\";\r\n\r\n          const clickHandler = () => {\r\n            setTimeout(() => {\r\n              URL.revokeObjectURL(url);\r\n              a.removeEventListener(\"click\", clickHandler);\r\n            }, 150);\r\n          };\r\n\r\n          a.addEventListener(\"click\", clickHandler, false);\r\n          a.click();\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mb-10\">\r\n      {/* Sería bueno refactorear esto a un componente */}\r\n      <Modal\r\n        show={noData}\r\n        onHide={() => setNoData(false)}\r\n        aria-labelledby=\"contained-modal-title-vcenter\"\r\n        centered\r\n      >\r\n        <Modal.Header closeButton>\r\n          <h5>Datos no encontrados</h5>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <p>Revise los parametros e intente de nuevo.</p>\r\n        </Modal.Body>\r\n      </Modal>\r\n      <RHFiltros\r\n        createQueryGraph={createQueryGraph}\r\n        createQueryCal={createQueryCal}\r\n        radioValue={radioValue}\r\n        setRadioValue={setRadioValue}\r\n        updateMainFiltros={updateMainFiltros}\r\n      />\r\n      <div className=\"text-center\">\r\n        <img\r\n          src=\"loading.gif\"\r\n          alt=\"Cargando...\"\r\n          className=\"loading\"\r\n          style={loading ? {} : { display: \"none\" }}\r\n        />\r\n      </div>\r\n      {radioValue === \"1\" && (\r\n        <Grafica\r\n          setDesde={setDesde}\r\n          setHasta={setHasta}\r\n          setDesdeHora={setDesdeHora}\r\n          setHastaHora={setHastaHora}\r\n          downloadFile={downloadFile}\r\n          summary={summaryData}\r\n          {...data}\r\n        />\r\n      )}\r\n      {radioValue === \"2\" && (\r\n        <>\r\n          <Suspense fallback={<div>Loading...</div>}>\r\n            <Calendario\r\n              q={queryString}\r\n              create={createQueryCal}\r\n              data={data}\r\n              indi={ind.current.value}\r\n              setDesde={setDesde}\r\n              setHasta={setHasta}\r\n              downloadFile={downloadFile}\r\n            />\r\n            <HeatMap\r\n              q={queryString}\r\n              fecha={desde}\r\n              ubic={ubicacion.current}\r\n              ind={ind.current.value}\r\n            />\r\n          </Suspense>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Registro;\r\n","export const gases = [\r\n    {\r\n        name: 'PM25',\r\n        label: 'PM2.5',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'PM10',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'O3',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'CO',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'NO2',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'SO2',\r\n        units: 'ppm',\r\n    },\r\n];\r\n\r\n// Opciones del dropdown de sistemas:\r\nexport const systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"Sinaica\", label: 'Sinaica', opt: 'G'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon', opt: 'G'}\r\n]\r\n\r\n// Opciones del dropdown de gases:\r\nexport const indicadores = [\r\n    { value: 'PM25', label: 'PM2.5' },\r\n    { value: 'PM10', label: 'PM10' },\r\n    { value: 'O3', label: 'O3' },\r\n    { value: 'CO', label: 'CO' },\r\n    { value: 'NO2', label: 'NO2' },\r\n    { value: 'SO2', label: 'SO2' },\r\n];\r\n\r\nexport const unidad = {\r\n    PM25: 'µg/m3',\r\n    PM10: 'µg/m3',\r\n    CO: 'ppm',\r\n    O3: 'ppm',\r\n    NO2: 'ppm',\r\n    SO2: 'ppm',\r\n};\r\nexport const idBlacklist = [\r\n    'P36757',\r\n    'P47305',\r\n    'P39499',\r\n    'P46239',\r\n    'P50855',\r\n    'P35099',\r\n    'P39709',\r\n    'P39497',\r\n    'P39285',\r\n    'P39355',\r\n\r\n\r\n\r\n];\r\nexport const idBlacklistpriv = [\r\n    'P39497',\r\n    'P39285',\r\n    'P39355'\r\n\r\n];\r\nexport const mapBlacklist = [\r\n    'Sinaica', \r\n\r\n];\r\n\r\nexport const apiUrl =\r\n    process.env.NODE_ENV === 'production'\r\n        ? process.env.REACT_APP_API_URL\r\n        : 'http://127.0.0.1:8000';\r\n","import { apiUrl } from '../constants';\r\n\r\nconst retry = (fn, ms = 1000, retries = 5) =>\r\n    new Promise((resolve, reject) => {\r\n        fn()\r\n            .then(resolve)\r\n            .catch(() => {\r\n                setTimeout(() => {\r\n                    if (!retries) {\r\n                        return reject(\r\n                            'Se excedió el número máximo de intentos'\r\n                        );\r\n                    }\r\n                    retry(fn, ms, retries - 1).then(resolve, reject);\r\n                }, ms);\r\n            });\r\n    });\r\n\r\nconst fetchSummaryDataFn = () =>\r\n    new Promise((resolve, reject) => {\r\n        fetch(`${apiUrl}/sensor-summary`)\r\n            .then((res) => {\r\n                if (res.status === 200) {\r\n                    return res.json();\r\n                } else {\r\n                    reject();\r\n                }\r\n            })\r\n            .then((json) => {\r\n                resolve(json);\r\n            })\r\n            .catch((err) => reject(err));\r\n    });\r\n\r\nexport const fetchSummaryData = () => {\r\n    return retry(fetchSummaryDataFn);\r\n};\r\n"],"sourceRoot":""}