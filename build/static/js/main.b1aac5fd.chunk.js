(this.webpackJsonpcei=this.webpackJsonpcei||[]).push([[0],{116:function(e,t,a){},120:function(e,t,a){},124:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a(13),s=a.n(n),r=(a(96),a(97),a(9)),i=a(8),l=a(142),o=a(143),d=a(89),j=a(2),u=function(e){var t;return Object(j.jsxs)("div",{className:"container mt-5 mb-3",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h3",{children:"Concentraci\xf3n horaria"}),Object(j.jsx)("p",{children:"Conoce las recomendaciones seg\xfan el \xedndice de calidad del aire"})]}),Object(j.jsxs)(l.a.Container,{fill:!0,defaultActiveKey:null!==(t=e.selected)&&void 0!==t?t:"buena",className:"recomendaciones h-100",children:[Object(j.jsxs)(o.a,{fill:!0,children:[Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"buena",className:"nav-buena",children:"Buena"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"acept",className:"nav-acept",children:"Aceptable"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"mala",className:"nav-mala",children:"Mala"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"muy",className:"nav-muy",children:"Muy Mala"})}),Object(j.jsx)(o.a.Item,{children:Object(j.jsx)(d.a,{eventKey:"ext",className:"nav-ext",children:"Extremadamente Mala"})})]}),Object(j.jsxs)(l.a.Content,{children:[Object(j.jsx)(l.a.Pane,{eventKey:"buena",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(j.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(j.jsx)("li",{children:"Sin riesgo para personas vulnerables"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"acept",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(j.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(j.jsx)("li",{children:"Personas vulnerables limitar actividades f\xedsicas"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"mala",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Limitar actividades f\xedsicas al aire libre, incrementar frecuencia de descansos, vigilar que estudiantes no presenten s\xedntomas de afecciones respiratorias."}),Object(j.jsx)("li",{children:"Limitar tiempo de exposici\xf3n"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Considerar suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Se recomienda el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"muy",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(j.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(j.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Acudir al m\xe9dico en caso de s\xedntomas de afectaciones a la salud"}),Object(j.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(j.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(j.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"}),Object(j.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(j.jsx)(l.a.Pane,{eventKey:"ext",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(j.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(j.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(j.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(j.jsx)("li",{children:"Acudir al m\xe9dico o solicitar servicios de emergencias en caso de s\xedntomas de afectaciones a la salud"}),Object(j.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(j.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"}),Object(j.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(j.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(j.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"})]})})]})]})]})},b=a(140),m=a(81),O=a(130),h=a(138),x=a(131),f=a(82),p=a(139),v=a(83),g=a(20),y=a(18),N=[{name:"PM25",label:"PM2.5",units:"\u03bcg/m3"},{name:"PM10",units:"\u03bcg/m3"},{name:"O3",units:"ppm"},{name:"CO",units:"ppm"},{name:"NO2",units:"ppm"},{name:"SO2",units:"ppm"}],S=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"Sinaica",label:"Sinaica",opt:"G"},{value:"AireNuevoLeon",label:"AireNuevoLeon",opt:"G"}],C=[{value:"PM25",label:"PM2.5"},{value:"PM10",label:"PM10"},{value:"O3",label:"O3"},{value:"CO",label:"CO"},{value:"NO2",label:"NO2"},{value:"SO2",label:"SO2"}],M={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},P=["P36757","P47305","P39499","P46239","P50855","P35099","P39709","P39497","P39285","P39355"],D=["P39497","P39285","P39355"],k=["Sinaica"],w="/api",A=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"AireNuevoLeon",label:"AireNuevoLeon",opt:"G"}],Y=[{value:"1",label:"Tiempo real"},{value:"2",label:"12 horas"},{value:"3",label:"24 horas"},{value:"4",label:"\xdaltima semana"},{value:"5",label:"\xdaltimo mes"},{value:"6",label:"\xdaltimo a\xf1o"}],R=function(e){var t=e.onApply,a=Object(g.c)((function(e){return e})).sensorData,n=Object(c.useState)(""),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(c.useMemo)((function(){return a.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud&&e.Sistema===r.label&&!P.includes(e.Sensor_id)&&!D.includes(e.Sensor_id)})).map((function(e){return{value:e.Sensor_id,label:e.Zona}}))}),[a,r]),d=Object(c.useState)(C),u=Object(i.a)(d,2),N=u[0],S=u[1];Object(c.useEffect)((function(){"PurpleAir"===r.label?S([C[0]]):S(C)}),[r]);var M=Object(c.useState)(!1),k=Object(i.a)(M,2),w=k[0],R=k[1],L=Object(c.useState)(null),E=Object(i.a)(L,2),z=E[0],I=E[1],F=Object(c.useState)(Y[0]),H=Object(i.a)(F,2),_=H[0],q=H[1],T=Object(c.useState)(C[0]),B=Object(i.a)(T,2),U=B[0],K=B[1],G=function(){return R(!1)};return Object(j.jsxs)("div",{className:"container mt-5",children:[Object(j.jsxs)(b.a,{children:[Object(j.jsx)("p",{style:{fontSize:"0.9em"},children:"*Recuerda que el sistema PurpleAir solo tiene disponible el contaminante PM2.5"}),Object(j.jsxs)(b.a.Row,{className:"mapa-filtros",children:[Object(j.jsxs)(m.a,{className:"mb-3",xs:12,lg:4,children:[Object(j.jsx)(y.a,{placeholder:"Sistema",value:r,onChange:function(e){l(e),I(null)},options:A}),Object(j.jsx)(y.a,{placeholder:"Ubicaci\xf3n",value:z,onChange:I,options:o})]}),Object(j.jsx)(m.a,{className:"mb-3",xs:6,lg:3,children:Object(j.jsx)(y.a,{isDisabled:!0,options:Y,onChange:q,value:_})}),Object(j.jsx)(m.a,{xs:6,lg:3,children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:10,children:Object(j.jsx)(y.a,{options:N,value:U,onChange:K})}),Object(j.jsx)(m.a,{xs:2,children:Object(j.jsx)(h.a,{placement:"top",overlay:Object(j.jsx)(x.a,{children:"Info. indicadores"}),children:Object(j.jsx)(f.a,{className:"info-btn",variant:"link",onClick:function(){return R(!0)},children:Object(j.jsx)(v.a,{color:"MediumVioletRed"})})},"top")})]})}),Object(j.jsx)(m.a,{children:Object(j.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){t({gas:U,location:z,interval:_}),I(null),q(Y[0])},children:"Aplicar"})})]})]}),Object(j.jsxs)(p.a,{size:"lg",show:w,onHide:G,children:[Object(j.jsx)(p.a.Header,{closeButton:!0,children:Object(j.jsx)(p.a.Title,{children:"Indicadores"})}),Object(j.jsxs)(p.a.Body,{children:[Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"PM 10"}),"\u2003 Material Particulado menor a 10 micr\xf3metros"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mezcla compleja de part\xedculas l\xedquidas o s\xf3lidas que provienen de fuentes naturales o de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 10 micr\xf3metros."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"PM 2.5"}),"\u2003 Material Particulado menor a 2.5 micr\xf3metros"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mezcla Compleja de Part\xedculas l\xedquidas o s\xf3lidas que provienen principalmente de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 2.5 micr\xf3metros."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"O2"}),"\u2003 Ozono"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Gas compuesto por 3 \xe1tomos de oxigeno que se encuentra principalmente en la estratosfera, puede formarse a nivel superficial debido a condiciones de alta radiaci\xf3n y temperatura."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"CO"}),"\u2003 Mon\xf3xido de Carbono"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Gas incoloro que se forma principalmente por la combusti\xf3n de gasolinas, le\xf1a o carb\xf3n, este compuesto, en altas concentraciones puede ser muy nocivo a la salud."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"SO2"}),"\u2003 Di\xf3xido de Azufre"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Es un gas formado por 2 \xe1tomos de ox\xedgeno y uno de azufre, se forma principalmente por la combusti\xf3n de combustibles f\xf3siles con alto contenido de azufre."})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)("h3",{className:"mod-sub",children:[Object(j.jsx)("span",{className:"mod-ind morado",children:"NO2"}),"\u2003 Di\xf3xido de Nitr\xf3geno"]})}),Object(j.jsx)(O.a,{children:Object(j.jsx)("p",{className:"mod-desc",children:"Mol\xe9cula con 2 \xe1tomos de ox\xedgeno y uno de Nitr\xf3geno que se produce principalmente por la combusti\xf3n de combustibles f\xf3siles empleados en veh\xedculos y plantas de energ\xeda."})})]}),Object(j.jsx)(p.a.Footer,{children:Object(j.jsx)(f.a,{variant:"secondary",onClick:G,children:"Cerrar"})})]})]})},L=a(30),E=a(28),z=(a(79),a(23)),I=a(132),F=a(133),H=a(10),_=a.n(H),q=function(e){if("number"!=typeof e)return e;var t=e.toFixed(2);return parseInt(t)===e?e:t};function T(e){var t=e.ICAR,a=e.label,n=e.status,l=e.position,o=e.current,d=e.provider,u=e.locationStr,O=e.labels,h=e.lastUpdate,x=(e.map,e.shape),p=void 0===x?"round":x,v=Object(L.a)(e,["ICAR","label","status","position","current","provider","locationStr","labels","lastUpdate","map","shape"]),g=Object(c.useMemo)((function(){return document.createElement("div")}),[]),y=Object(c.useRef)(),N=Object(c.useState)(null),S=Object(i.a)(N,2),C=S[0],M=S[1],P=Object(c.useCallback)((function(e,t){s.a.render(function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"round";return Object(j.jsxs)("div",{className:"marker-wrapper",style:{zIndex:"round"===a?-1:-10},children:[Object(j.jsx)("div",{className:"marker-".concat(t," marker-base marker-shape-").concat(a)}),Object(j.jsx)("span",{className:"marker-".concat(t),style:{backgroundColor:"transparent"},children:q(e)})]})}(e,t,p),g),M(Object(E.divIcon)({html:g,className:"sensor-icon ".concat("round"===p?"":"behind"),popupAnchor:[7,0]}))}),[p]);return Object(c.useEffect)((function(){P(a,n)}),[a,n,P]),C?Object(j.jsx)(I.a,Object(r.a)(Object(r.a)({position:l,icon:C},v),{},{children:Object(j.jsxs)(F.a,{ref:y,className:"custom-popup",closeButton:function(e){return Object(j.jsx)("button",Object(r.a)(Object(r.a)({},e),{},{type:"button",class:"btn-close","aria-label":"Close"}))},children:[Object(j.jsxs)("div",{className:"px-3 py-2",children:[Object(j.jsxs)("div",{className:"rounded marker-".concat(o.status),style:{display:"flex",justifyContent:"center",padding:"0 0.1rem "},children:[o.indicator,": ",o.label," ",o.units]}),Object(j.jsxs)("div",{className:"data-label",children:[Object(j.jsx)("small",{className:"text-muted",children:"Ubicaci\xf3n"}),Object(j.jsx)("br",{}),Object(j.jsx)("data",{children:u})]}),Object(j.jsxs)("div",{className:"data-label",children:[Object(j.jsx)("small",{className:"text-muted",children:"\xdaltima actualizaci\xf3n"}),Object(j.jsx)("br",{}),Object(j.jsx)("time",{children:_()(h).format("ddd, MMMM D YYYY, h:mm:ss a")})]}),Object(j.jsxs)("div",{className:"data-label2",children:[Object(j.jsx)("small",{className:"text-muted",children:"Tiempo Real"}),Object(j.jsx)("small",{className:"text-muted ml-5",children:"Indice Calidad Aire"})]}),Object(j.jsx)(b.a,{children:O.map((function(e,a){var c=e.label,n=e.status,s=e.value,r=e.units;return Object(j.jsxs)(b.a.Row,{className:"d-flex justify-content-between  mb-1 ",children:[Object(j.jsx)(m.a,{xs:3,children:Object(j.jsx)(z.b,{to:{pathname:"registro",search:"?gas=".concat(c)},children:c})}),Object(j.jsxs)(m.a,{className:"d-flex justify-content-between px-1 rounded marker-".concat(n),xs:5,children:[Object(j.jsx)("span",{children:s}),Object(j.jsx)("span",{children:r})]}),Object(j.jsx)(m.a,{className:"d-flex justify-content-between px-1 rounded marker-".concat(n),xs:3,children:"PM2.5"===c?"-1.00"==t||"0.00"==t?Object(j.jsx)("span",{children:"ND"}):Object(j.jsx)("span",{children:t.toFixed(2)}):Object(j.jsx)("span",{children:"ND"})})]},a)}))})]}),Object(j.jsxs)("div",{className:"py-2 px-3 border-top text-center",children:[Object(j.jsx)(f.a,{size:"sm",children:"M\xe1s informaci\xf3n"}),Object(j.jsxs)("p",{className:"lh-sm mt-2 mb-0",children:["Fuente(s): ",Object(j.jsx)("a",{target:"blank",href:d.ref,children:d.name})]})]})]})})):null}T.defaultProps={};var B=T,U=(a(116),a(134)),K=a(148);function G(e){var t=e.center,a=e.children,c=Object(L.a)(e,["center","children"]);return Object(j.jsxs)(U.a,Object(r.a)(Object(r.a)({center:t,scrollWheelZoom:!1,style:{height:"100%",widht:"100%"}},c),{},{children:[Object(j.jsx)(K.a,{attribution:'\xa9 <a href="https://stadiamaps.com/">Stadia Maps</a>, \xa9 <a href="https://openmaptiles.org/">OpenMapTiles</a> \xa9 <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png?api_key=e4368efd-701c-4da6-8372-03f4040a622a"}),a]}))}G.defaultProps={};var V=G,Z={"Aire y Salud":{PM10:[50,75,155,235],PM25:[25,45,78,147],O3:[.051,.095,.135,.175],CO:[8.75,11,13.3,15.5],SO2:[.008,.11,.165,.22],NO2:[.107,.21,.23,.25]},NOM:{PM10:[100,135,214,300],PM25:[55,75,97.4,128.8],O3:[.07,.093,.115,.137],CO:[12,13.9,15.9,18.9],SO2:[.253,.345,.435,.566],NO2:[.132,.176,.221,.289]}},Q=["buena","acept","mala","muy","ext"],J=function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Aire y Salud",c=Z[a][e],n=c.length-1;n>=0;n--)if(t>c[n])return parseInt(n)+1;return 0},W=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return new Promise((function(n,s){t().then(n).catch((function(){setTimeout((function(){if(!c)return s("Se excedi\xf3 el n\xfamero m\xe1ximo de intentos");e(t,a,c-1).then(n,s)}),a)}))}))},X=function(){return new Promise((function(e,t){fetch("".concat(w,"/sensor-summary")).then((function(e){if(200===e.status)return e.json();t()})).then((function(t){e(t)})).catch((function(e){return t(e)}))}))},$=function(){return W(X)},ee=a(87),te=Object(ee.a)({name:"data",initialState:{sensorData:[],sensorDataLastUpdate:null},reducers:{setSensorData:function(e,t){Array.isArray(t.payload)&&(e.sensorData=t.payload,e.sensorDataLastUpdate=_()())}}}),ae=te.actions.setSensorData,ce=te.reducer,ne=function(e){var t=e.cacheTime,a=void 0===t?60:t,n=e.useCache,s=void 0===n||n,r=Object(g.c)((function(e){return e})),l=r.sensorDataLastUpdate,o=r.sensorData,d=Object(g.b)(),j=Object(c.useState)(!0),u=Object(i.a)(j,2),b=u[0],m=u[1],O=Object(c.useState)(o),h=Object(i.a)(O,2),x=h[0],f=h[1],p=Object(c.useState)(null),v=Object(i.a)(p,2),y=v[0],N=v[1];return Object(c.useEffect)((function(){(l&&s?_()().diff(l,"minutes"):999)>a?$().then((function(e){d(ae(e)),f(e)})).catch((function(e){console.error(e),f([]),N(e)})).finally((function(){return m(!1)})):m(!1)}),[l,d,a,s]),{loading:b,data:x,error:y}},se=a(135),re=a(146),ie={center:[25.67,-100.25],zoom:11,minZoom:10};var le=function(){var e=Object(c.useState)(N[0]),t=Object(i.a)(e,2),a=t[0],n=t[1],s=ne({}),l=s.data,o=s.loading,d=s.error,b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],x=m[1],p=Object(c.useState)(0),v=Object(i.a)(p,2),g=v[0],y=v[1],S=Object(c.useCallback)((function(e){O&&O.setView(e,ie.zoom,{animate:!0})}),[O]),C=Object(c.useMemo)((function(){var e=0,t=l.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud&&!k.includes(e.Sistema)&&!P.includes(e.Sensor_id)}));console.log(t);var c=t.map((function(t){var c,n=a.name,s=a.units,r="PM25"===n&&"PurpleAir"===t.Sistema?t.PM25_Promedio:t[n],i="number"===typeof r?r:"ND",l=J(n,i);return l>e&&(e=l),{ICAR:+t.ICAR,position:[t.Latitud,t.Longitud],current:{indicator:a.label?a.label:n,label:i,units:s,status:"ND"!==i?J(n,i):99,ref:"#"},lastUpdate:_.a.utc(t.Dia).local(),locationStr:(null===(c=t.Zona)||void 0===c?void 0:c.length)>0?t.Zona:"ND",provider:{name:t.Sistema,ref:"PurpleAir"===t.Sistema?"https://www.purpleair.com/map?mylocation":"AireNuevoLeon"===t.Sistema?"http://aire.nl.gob.mx/":"Sinaica"===t.Sistema?"https://sinaica.inecc.gob.mx/":"#"},isPurpleAir:"PurpleAir"===t.Sistema,labels:N.map((function(e){var a=e.name,c=e.label,n=e.units,s=a;return"PM25"===a&&"PurpleAir"===t.Sistema&&(s="PM25_Promedio"),{label:c||a,units:n,value:"number"===typeof t[s]?t[s]:"ND",status:t[s]?J(a,t[s]):99,ref:"#"}}))}}));return y(e),c}),[l,a,y]);return Object(j.jsxs)("div",{children:[Object(j.jsx)(R,{onApply:function(e){var t=e.gas,c=e.location;if(c){var s=l.find((function(e){return e.Sensor_id===c.value}));if(s&&S([s.Latitud,s.Longitud]),t){var r=N.find((function(e){return e.name===t.value}));n(null!==r&&void 0!==r?r:a)}}else alert("Selecciona una ubicaci\xf3n")}}),Object(j.jsxs)("div",{className:"my-4",style:{zIndex:0,position:"relative",width:"100%",height:"500px"},children:[d&&Object(j.jsx)("div",{className:"position-absolute w-100 end-0 p-2",style:{zIndex:100},children:Object(j.jsx)("div",{class:"alert alert-danger",role:"alert",children:"Ocurri\xf3 un error al cargar los datos."})}),o&&Object(j.jsx)("div",{className:"w-100 h-100 d-flex position-absolute",style:{zIndex:100,backgroundColor:"rgba(0,0,0,0.2)"},children:Object(j.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(j.jsx)(se.a,{animation:"border"})})}),Object(j.jsx)("div",{className:"w-100 h-100 position-absolute p-2",style:{zIndex:99,pointerEvents:"none"},children:Object(j.jsx)("div",{className:"position-absolute end-0",children:Object(j.jsx)(h.a,{trigger:"click",placement:"left",overlay:Object(j.jsxs)(re.a,{children:[Object(j.jsx)(re.a.Title,{as:"h3",children:"Leyenda"}),Object(j.jsxs)(re.a.Content,{children:[Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)("div",{style:{boxSizing:"border-box",borderRadius:"100%",width:"35px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores del estado se representan con un c\xedrculo"]}),Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)("div",{style:{boxSizing:"border-box",width:"35px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores de Purple Air se representan con un cuadrado"]})]})]}),children:Object(j.jsx)(f.a,{variant:"link",className:"pe-auto",children:"Leyenda"})})})}),Object(j.jsx)(V,Object(r.a)(Object(r.a)({whenCreated:x},ie),{},{children:!o&&C.map((function(e,t){return Object(j.jsx)(B,Object(r.a)(Object(r.a)({map:O},e),{},{label:e.current.label,indicator:e.current.indicator,status:e.current.status,shape:e.isPurpleAir?"square":"round"}),t)}))}))]}),Object(j.jsx)(u,{selected:Q[g]})]})},oe=a(136),de=a(137),je=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"AireNuevoLeon",label:"AireNuevoLeon/Sinaica",opt:"G"}];var ue=function(e){var t=e.createQueryGraph,a=e.createQueryCal,n=e.radioValue,s=e.setRadioValue,r=e.updateMainFiltros,l=Object(g.b)(),o=Object(g.c)((function(e){return e})),d=o.sensorDataLastUpdate,u=o.sensorData,O=Object(c.useState)(null),h=Object(i.a)(O,2),x=h[0],p=h[1],v=[];Object(c.useEffect)((function(){(d?_()().diff(d,"minutes"):999)>60?$().then((function(e){l(ae(e)),p(e)})).catch((function(e){return console.error(e)})):p(u)}),[]);var N=Object(c.useState)(""),S=Object(i.a)(N,2),M=S[0],P=S[1],k=Object(c.useState)(C),w=Object(i.a)(k,2),A=w[0],Y=w[1],R=Object(c.useState)(null),L=Object(i.a)(R,2),E=L[0],z=L[1],I=Object(c.useRef)(null),F=Object(c.useRef)(null),H=Object(c.useRef)(C[0]);return Object(c.useEffect)((function(){"PurpleAir"===M.value?Y([C[0]]):Y(C)}),[M]),x&&x.forEach((function(e){M.value!==e.Sistema||D.includes(e.Sensor_id)||v.push({value:e.Sensor_id,label:e.Zona})})),Object(j.jsxs)("div",{className:"mt-5",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h2",{children:"Registro Hist\xf3rico"}),Object(j.jsx)("p",{children:"Consulta los datos hist\xf3ricos de la calidad del aire"})]}),Object(j.jsxs)(b.a,{children:[Object(j.jsxs)(b.a.Row,{className:"mb-3",children:[Object(j.jsx)(m.a,{xs:6,children:Object(j.jsx)(y.a,{options:je,placeholder:"Sistema",onChange:function(e){z(null),F.current=null,I.current=e,P(e)}})}),Object(j.jsx)(m.a,{xs:6,children:Object(j.jsx)(y.a,{options:v,value:E,placeholder:"Ubicaci\xf3n",onChange:function(e){z(e),F.current=e}})})]}),Object(j.jsxs)(b.a.Row,{children:[Object(j.jsx)(m.a,{children:Object(j.jsx)(oe.a,{toggle:!0,children:[{name:"Grafica",value:"1"},{name:"Calendario",value:"2"}].map((function(e,t){return Object(j.jsx)(de.a,{className:"toggle-vista",type:"radio",variant:"light",name:"radio",value:e.value,checked:n===e.value,onChange:function(e){return s(e.currentTarget.value)},children:e.name},t)}))})}),Object(j.jsx)(m.a,{className:"mb-3",children:Object(j.jsx)(y.a,{options:A,placeholder:"Indicador",onChange:function(e){H.current=e},defaultValue:C[0]})}),Object(j.jsx)(m.a,{xs:12,sm:3,className:"mb-3",children:Object(j.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){return r(F.current,H.current,I.current),void("1"==n?t():a())},children:"Aplicar"})})]})]}),Object(j.jsx)("hr",{className:"mt-2 mb-4"})]})},be=a(63),me=a.n(be);var Oe=function(e){var t=e.setDesde,a=e.setHasta,n=e.setDesdeHora,s=e.setHastaHora,r=e.data,i=e.layout,l=e.summary;return Object(c.useEffect)((function(){t(null),a(null),n("00:00:00"),s("00:00:00")}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)(b.a,{className:"mt-4 mb-4",children:Object(j.jsxs)(b.a.Row,{className:"d-flex justify-content-evenly",children:[Object(j.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:2,children:Object(j.jsxs)(b.a.Label,{className:"col-form-label",children:["Desde:"," "]})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return t(_()(e.target.value))}})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{onChange:function(e){return n(e.target.value+":00")},type:"time"})})]})}),Object(j.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{xs:2,children:Object(j.jsxs)(b.a.Label,{className:"col-form-label",children:["Hasta:"," "]})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return a(_()(e.target.value))}})}),Object(j.jsx)(m.a,{xs:5,children:Object(j.jsx)(b.a.Control,{onChange:function(e){return s(e.target.value+":00")},type:"time"})})]})})]})}),Object(j.jsxs)(O.a,{className:"mb-5",children:[Object(j.jsxs)(m.a,{xs:12,lg:4,xl:2,children:[Object(j.jsx)(O.a,{xs:12,children:Object(j.jsx)(f.a,{className:"btn btn-light mb-4",block:!0,children:"Descargar datos"})}),Object(j.jsxs)(O.a,{className:"d-flex justify-content-center",children:[Object(j.jsx)(m.a,{xs:6,sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado d-flex justify-content-center",children:[Object(j.jsxs)(O.a,{sm:12,children:[Object(j.jsx)("p",{className:"tipo text-center",children:"M\xe1ximo"}),Object(j.jsx)("p",{className:"desc text-center",children:l&&(null===l||void 0===l?void 0:l.max.date)?"Registrado el ".concat(null===l||void 0===l?void 0:l.max.date):""})]}),Object(j.jsx)(O.a,{sm:12,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero muymala text-center",children:l&&"number"===typeof(null===l||void 0===l?void 0:l.max.value)?l.max.value.toFixed(2):"-"})})]})}),Object(j.jsx)(m.a,{xs:6,sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado d-flex justify-content-center",children:[Object(j.jsxs)(O.a,{sm:12,children:[Object(j.jsx)("p",{className:"tipo text-center",children:"M\xednimo"}),Object(j.jsx)("p",{className:"desc text-center",children:l&&(null===l||void 0===l?void 0:l.min.date)?"Registrado el ".concat(null===l||void 0===l?void 0:l.min.date):""})]}),Object(j.jsx)(O.a,{sm:12,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero acept text-center",children:l&&"number"===typeof(null===l||void 0===l?void 0:l.min.value)?l.min.value.toFixed(2):"-"})})]})}),Object(j.jsx)(m.a,{xs:6,sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado d-flex align-items-center justify-content-center",children:[Object(j.jsx)(O.a,{sm:12,children:Object(j.jsx)("p",{className:"tipo text-center",children:"Promedio"})}),Object(j.jsx)(O.a,{sm:12,className:"d-flex align-items-center justify-content-end",children:Object(j.jsx)("p",{className:"numero mala text-center",children:l&&"number"===typeof(null===l||void 0===l?void 0:l.avg.value)?l.avg.value.toFixed(2):"-"})})]})}),Object(j.jsx)(m.a,{xs:6,sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado d-flex align-items-center justify-content-center",children:[Object(j.jsx)(O.a,{sm:12,className:"d-flex align-items-center justify-content-center",children:Object(j.jsx)("p",{className:"tipo text-center",children:"Arriba de la norma"})}),Object(j.jsx)(O.a,{sm:12,className:"d-flex align-items-center justify-content-center",children:Object(j.jsx)("p",{className:"numero text-center ".concat(l?0==l.porcentajes.arribaLimite?"bueno":l.porcentajes.arribaLimite>25?"muymala":"mala":null),children:l?l.porcentajes.arribaLimite+"%":"-"})})]})}),Object(j.jsx)(m.a,{xs:12,sm:5,lg:12,children:Object(j.jsxs)(O.a,{className:"dato-calculado",children:[Object(j.jsxs)(m.a,{xs:6,sm:6,className:"d-flex flex-column align-items-center justify-content-center",children:[Object(j.jsx)("p",{className:"tipo text-center",children:"Datos V\xe1lidos"}),Object(j.jsx)("p",{className:"numero bueno text-center",children:l?l.porcentajes.buenos+"%":"-"})]}),Object(j.jsxs)(m.a,{xs:6,sm:6,className:"d-flex flex-column align-items-center justify-content-center",children:[Object(j.jsx)("p",{className:"tipo text-center",children:"Datos Nulos"}),Object(j.jsx)("p",{className:"numero muymala text-center",children:l?l.porcentajes.nulos+"%":"-"})]})]})})]})]}),Object(j.jsx)(m.a,{sm:12,lg:8,xl:10,children:Object(j.jsx)("div",{className:"grafico mb-4",children:Object(j.jsx)(me.a,{className:"grafico-resize",data:r,layout:i,config:{responsive:!0}})})}),Object(j.jsx)(O.a,{className:"d-block d-sm-none w-100",xs:11,children:Object(j.jsx)("p",{children:"*Para una mejor visualizaci\xf3n, utiliza el telefono horizontalmente."})})]})]})},he=(a(120),a(144)),xe=a(147);var fe=a(141),pe=function(e){var t=e.value,a=e.onChange,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],l=s[1];function o(e){return e.isAfter(new Date,"day")}function d(e){return function(e){return t.isSame(e,"day")}(e)?"selected":function(e){return e.isSame(new Date,"day")}(e)?"today":o(e)?"after":function(e){return e.isSame(t,"month")}(e)?"":"month"}function u(){return t.clone().subtract(1,"month")}function b(){return t.clone().endOf("month").add(1,"day")}function h(){return t.isSame(new Date,"month")}function x(){return t.isSame(new Date("01-01-2018"),"month")}return Object(c.useEffect)((function(){l(function(e){for(var t=e.clone().startOf("month").startOf("isoWeek"),a=e.clone().endOf("month").endOf("isoWeek").subtract(1,"day"),c=t.clone().subtract(2,"day"),n=[];c.isBefore(a,"day");)n.push(Array(7).fill(0).map((function(){return c.add(1,"day").clone()})));return n}(t))}),[t]),Object(j.jsxs)("div",{className:"calendar mt-5",children:[Object(j.jsx)("div",{className:"cal-header",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,className:"previous",onClick:function(){return!x()&&a(u)},children:x()?null:String.fromCharCode(171)}),Object(j.jsxs)(m.a,{sm:6,className:"current",children:[t.format("MMM"),", ",t.format("YYYY")]}),Object(j.jsx)(m.a,{sm:3,className:"next",onClick:function(){return!h()&&a(b)},children:h()?null:String.fromCharCode(187)})]})}),Object(j.jsxs)("div",{className:"body",children:[Object(j.jsx)("div",{className:"day-names",children:["D","L","M","M","J","V","S"].map((function(e,t){return Object(j.jsx)("div",{className:"weekday",children:e},t)}))}),r.map((function(e,t){return Object(j.jsx)("div",{children:e.map((function(e,t){return Object(j.jsx)("div",{className:"day",onClick:function(){return!o(e)&&a(e)},children:Object(j.jsx)("div",{className:d(e),children:e.format("D")},Object(fe.a)())})}))},t)}))]})]})},ve=a(50);a(69);_.a.locale("es");var ge={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},ye=[{value:"1",label:"enero"},{value:"2",label:"febrero"},{value:"3",label:"marzo"},{value:"4",label:"abril"},{value:"5",label:"mayo"},{value:"6",label:"junio"},{value:"7",label:"julio"},{value:"8",label:"agosto"},{value:"9",label:"septiembre"},{value:"10",label:"octubre"},{value:"11",label:"noviembre"},{value:"12",label:"diciembre"}],Ne=[{value:"2018",label:"2018"},{value:"2019",label:"2019"},{value:"2020",label:"2020"},{value:"2021",label:"2021"}];var Se=function(e){var t=e.q,a=e.create,n=e.data,s=e.indi,r=e.setDesde,l=e.setHasta,o=e.downloadFile;function d(e){switch(J(s,e)){case 0:return"bueno";case 1:return"acept";case 2:return"mala";case 3:return"muymala";case 4:return"extmala";default:return"no-data"}}var u=Object(c.useState)(_()()),b=Object(i.a)(u,2),h=b[0],x=b[1];Object(c.useEffect)((function(){r(h),l(h)}),[]);var p=Object(c.useState)((new Date).getMonth()+1),v=Object(i.a)(p,2),g=v[0],N=v[1],S=Object(c.useState)(Ne[Ne.length-1].value),C=Object(i.a)(S,2),M=C[0],P=C[1];Object(c.useEffect)((function(){r(h),l(h),(n||t)&&a(h,h)}),[h]),Object(c.useEffect)((function(){var e=new Date("".concat(g,"/").concat(h.clone().format("DD"),"/").concat(M));x(_()(e))}),[g,M]);var D=[],k=[],w=0,A=0;if(n&&0!==n.length){for(;A<12&&w<n.length;){for(var Y="T"+A.toString().padStart(2,0)+":",R=[],L=w;w<n.length&&n[w].dia.includes(Y);)R.push(Object(j.jsxs)("p",{children:[Object(j.jsx)(ve.b,{className:d(n[w][s])}),n[w].zona,": ",n[w][s]?" ".concat(n[w][s]," ").concat(ge[s]):" No hay registro"]})),w++;D.push(Object(j.jsx)(he.a,{id:n[L].registros_id,children:Object(j.jsxs)(xe.a,{children:[Object(j.jsx)(xe.a.Header,{children:Object(j.jsxs)(he.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[L].registros_id,children:[Object(j.jsx)(ve.a,{color:"lightgray"})," ",A.toString().padStart(2,0),":00"]})}),Object(j.jsx)(he.a.Collapse,{eventKey:n[L].registros_id,children:Object(j.jsx)(xe.a.Body,{children:R})})]})},n[L].registros_id)),A++}for(;A<24&&w<n.length;){for(var E="T"+A.toString().padStart(2,0),z=[],I=w;w<n.length&&n[w].dia.includes(E);)z.push(Object(j.jsxs)("p",{children:[Object(j.jsx)(ve.b,{className:d(n[w][s])})," ",n[w].zona,": ",n[w][s]?"".concat(n[w][s]," ").concat(ge[s]):"No hay registro"]})),w++;k.push(Object(j.jsx)(he.a,{id:n[I].registros_id,children:Object(j.jsxs)(xe.a,{children:[Object(j.jsx)(xe.a.Header,{children:Object(j.jsxs)(he.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[I].registros_id,children:[Object(j.jsx)(ve.a,{color:"lightgray"})," ",A.toString().padStart(2,0),":00"]})}),Object(j.jsx)(he.a.Collapse,{eventKey:n[I].registros_id,children:Object(j.jsx)(xe.a.Body,{children:z})})]})},n[I].registros_id)),A++}}else D.push(Object(j.jsx)("p",{children:"No hay datos para este d\xeda"}));return Object(j.jsx)("div",{className:"container mb-10",children:Object(j.jsxs)(O.a,{className:"mb-5",children:[Object(j.jsx)(m.a,{sm:12,lg:6,children:Object(j.jsxs)("div",{children:[Object(j.jsx)(f.a,{className:"btn btn-light mb-4 mt-4",block:!0,onClick:o,children:"Descargar datos del mes"}),Object(j.jsxs)(O.a,{className:"mb-4",children:[Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(y.a,{options:ye,placeholder:"Mes",onChange:function(e){return N(e.value)},defaultValue:ye[(new Date).getMonth()]})}),Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(y.a,{options:Ne,placeholder:"A\xf1o",onChange:function(e){return P(e.value)},defaultValue:Ne[Ne.length-1]})})]}),Object(j.jsxs)("div",{className:"detalles",children:[Object(j.jsxs)("h4",{children:[h&&h.format("DD/MM/YYYY")," Detalle por hora"]}),Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:6,children:D}),Object(j.jsx)(m.a,{sm:6,children:k})]})]})]})}),Object(j.jsx)(m.a,{sm:12,lg:6,className:"d-flex align-items-start justify-content-center",children:Object(j.jsx)(pe,{value:h,onChange:x})})]})})},Ce=a(84),Me=a.n(Ce);var Pe=function(e){var t=e.q,a=e.fecha,n=e.ubic,s=e.ind,l=Object(c.useState)(null),o=Object(i.a)(l,2),d=o[0],u=o[1],b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],h=m[1],x=Object(c.useRef)(null),f=Object(c.useRef)(d),p="";Object(c.useEffect)((function(){a&&(d&&d.isSame(a.clone().startOf("month"))||(f.current=d,u(a.clone().startOf("month"))))}),[a]),Object(c.useEffect)((function(){var e="";t&&(e=t.substring(0,t.indexOf("&inicio"))),x.current&&x.current===e&&f.current==d||(x.current!==t&&(x.current=e),f.current!=d&&(f.current=d),n&&d&&(p="ubic=",p+=n.value,p+="&ind="+s+"&inicio="+d.clone().format("YYYY-MM-DD")+"&fin="+d.clone().endOf("month").format("YYYY-MM-DD"),console.log("Query HM: "+p),fetch("".concat(w,"/prom-data?").concat(p)).then((function(e){return e.json()})).then((function(e){return h(e)})).catch((function(e){return console.log(e)}))))}),[t,d]);var v={},g=[];if(t&&O&&O.length>0){for(var y=0,N={},S=O[y].zona,C=new Date(O[y].fecha.replace(/-/g,"/").replace(/T.+/,"")),P=1,D={name:S,data:[]};C.getDate()!==P;)N.x=P,N.y=-1,D.data.push(Object(r.a)({},N)),P++;for(;y<O.length&&O[y].zona===S;)N.x=P,P==parseInt(O[y].fecha.substring(8))?(""!==O[y].prom?(N.y=O[y].prom,N.fecha=O[y].fecha):N.y=-1,y++):N.y=-1,D.data.push(Object(r.a)({},N)),P++;g.push(Object(r.a)({},D)),v={chart:{type:"heatmap",toolbar:{show:!1}},plotOptions:{heatmap:{enableShades:!1,radius:1,useFillColorAsStroke:!1,colorScale:{ranges:[{from:-2,to:0,name:"No data",color:"#D3D3D3"},{from:0,to:Z["Aire y Salud"][s][0],name:"Buena",color:"#00E400"},{from:Z["Aire y Salud"][s][0],to:Z["Aire y Salud"][s][1],name:"Aceptable",color:"#FFFF00"},{from:Z["Aire y Salud"][s][1],to:Z["Aire y Salud"][s][2],name:"Mala",color:"#FF7E00"},{from:Z["Aire y Salud"][s][2],to:Z["Aire y Salud"][s][3],name:"Muy mala",color:"#FF0000"},{from:Z["Aire y Salud"][s][3],to:1.5*Z["Aire y Salud"][s][3],name:"Extremadamente mala",color:"#8F3F97"}]}}},dataLabels:{enabled:!1},stroke:{width:1},xaxis:{position:"bottom"},legend:{position:"top",showForSingleSeries:!0},tooltip:{custom:function(e){var t=e.series,a=e.seriesIndex,c=e.dataPointIndex,n=e.w;return-1!==t[a][c]?'<div class="arrow_box hmTooltip"><p>'+n.globals.initialSeries[a].data[c].fecha+"</p><p><b>"+t[a][c].toFixed(4)+" "+M[s]+"</b></p></div>":'<div style="display:none;">'}}}}return Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{className:"mb-5",children:"Promedios diarios del mes"}),t&&Object(j.jsx)(Me.a,{options:v,series:g,type:"heatmap",height:100*g.length})]})};_.a.locale("es");var De=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)(null),l=Object(i.a)(s,2),o=l[0],d=l[1],u=Object(c.useState)("1"),b=Object(i.a)(u,2),m=b[0],O=b[1],h=Object(c.useState)(null),x=Object(i.a)(h,2),f=x[0],v=x[1],g=Object(c.useState)(!1),y=Object(i.a)(g,2),N=y[0],S=y[1],C=Object(c.useState)(!1),M=Object(i.a)(C,2),P=M[0],D=M[1],k=Object(c.useState)(null),A=Object(i.a)(k,2),Y=A[0],R=A[1],L=Object(c.useState)(null),E=Object(i.a)(L,2),z=E[0],I=E[1],F=Object(c.useState)("00:00:00"),H=Object(i.a)(F,2),q=H[0],T=H[1],B=Object(c.useState)("00:00:00"),U=Object(i.a)(B,2),K=U[0],G=U[1],V=Object(c.useRef)({value:"PM25"}),Z=Object(c.useRef)(null),Q=Object(c.useRef)(null);function J(e,t){if(Z.current){e&&t||(e=Y,t=z);var a="ubic=";a+=Z.current.value,a+="&ind="+V.current.value+"&inicio="+e.format("YYYY-MM-DD")+"&fin="+t.format("YYYY-MM-DD"),v(a)}else alert("Selecciona una ubicaci\xf3n.")}function W(){if(f){var e="ubic=";Z.current.forEach((function(t){e+=t.value+","})),e=e.slice(0,-1),e+="2"===m?"&ind="+V.current.value+"&inicio="+Y.startOf("month").format("YYYY-MM-DD")+"&fin="+z.endOf("month").format("YYYY-MM-DD"):"&ind="+V.current.value+"&inicio="+Y.format("YYYY-MM-DD")+"&fin="+z.format("YYYY-MM-DD"),fetch("".concat(w,"/download-data?").concat(e)).then((function(e){return e.blob()})).then((function(e){var t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="data.csv";a.addEventListener("click",(function e(){setTimeout((function(){URL.revokeObjectURL(t),a.removeEventListener("click",e)}),150)}),!1),a.click()}))}}return Object(c.useEffect)((function(){f&&("1"===m?fetch("".concat(w,"/get-graph-opt?").concat(f)).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&D(!0);var t=[];e.plot.data&&e.plot.data[0].x.forEach((function(e){var a=_.a.duration("05:00:00");e=_()(e).subtract(a).format(),t.push(e.split("-05:00")[0])})),e.plot.data[0].x=t,console.log(e.plot),console.log(e.summary),n(e.plot),d(e.summary),S(!1)})):fetch("".concat(w,"/datos-fecha?").concat(f)).then((function(e){return e.json()})).then((function(e){return n(e)})))}),[f]),Object(c.useEffect)((function(){n(null)}),[m]),Object(j.jsxs)("div",{className:"container mb-10",children:[Object(j.jsxs)(p.a,{show:P,onHide:function(){return D(!1)},"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(j.jsx)(p.a.Header,{closeButton:!0,children:Object(j.jsx)("h5",{children:"Datos no encontrados"})}),Object(j.jsx)(p.a.Body,{children:Object(j.jsx)("p",{children:"Revise los parametros e intente de nuevo."})})]}),Object(j.jsx)(ue,{createQueryGraph:function(){if(Z.current)if(Y&&z){S(!0);var e="location=".concat(Z.current.label,"&gas=").concat(V.current.value,"&system=").concat(Q.current.opt,"&start_date=").concat(_.a.utc(Y).format("MM/DD/YYYY"),"/").concat(q,"&end_date=").concat(_.a.utc(z).format("MM/DD/YYYY"),"/").concat(K);console.log(e),v(e)}else alert("Selecciona las fechas.");else alert("Selecciona una ubicaci\xf3n.")},createQueryCal:J,radioValue:m,setRadioValue:O,updateMainFiltros:function(e,t,a){Q.current=a,Z.current=e,V.current=t}}),Object(j.jsx)("div",{className:"text-center",children:Object(j.jsx)("img",{src:"loading.gif",alt:"Cargando...",className:"loading",style:N?{}:{display:"none"}})}),"1"===m&&Object(j.jsx)(Oe,Object(r.a)({setDesde:R,setHasta:I,setDesdeHora:T,setHastaHora:G,downloadFile:W,summary:o},a)),"2"===m&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(Se,{q:f,create:J,data:a,indi:V.current.value,setDesde:R,setHasta:I,downloadFile:W}),Object(j.jsx)(Pe,{q:f,fecha:Y,ubic:Z.current,ind:V.current.value})]})]})},ke=a(88),we=function(e){var t=Object(c.useRef)(e.id),a=e.sensores,n=Object(c.useState)("PurpleAir"),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(c.useState)(C),d=Object(i.a)(o,2),u=d[0],h=d[1],x=Object(c.useState)(null),f=Object(i.a)(x,2),p=f[0],v=f[1],g=Object(c.useRef)(a[0].zona?a[0].zona:null),N=Object(c.useRef)(C[0].value),M=Object(c.useRef)(null),P=Object(c.useRef)(null),k=Object(c.useRef)("00:00:00"),w=Object(c.useRef)("00:00:00");Object(c.useEffect)((function(){h("PurpleAir"===r?[C[0]]:C)}),[r]);var A=Object(c.useMemo)((function(){return a.filter((function(e){return e.sistema===r&&!D.includes(e.Sistema)})).map((function(e){return{value:e.sensor_id,label:e.zona}}))}),[a,r]);function Y(){var a={ubic:g.current,ind:N.current,desde:M.current,hasta:P.current,desdeHora:k.current,hastaHora:w.current};e.modifyData(a,t.current)}return Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)("div",{className:"compara-filtros mt-2 mb-4",id:"filtro-"+t.current,children:Object(j.jsxs)(b.a,{children:[Object(j.jsx)(b.a.Group,{as:O.a,children:Object(j.jsx)(m.a,{sm:12,children:Object(j.jsxs)(O.a,{children:[Object(j.jsxs)(m.a,{sm:6,children:[Object(j.jsx)(y.a,{options:S,placeholder:"Sistema",className:"mb-2",onChange:function(e){l(e.value),v(null),g.current=null,Y()}}),Object(j.jsx)(y.a,{options:A,value:p,placeholder:"Ubicaci\xf3n",className:"mb-2",onChange:function(e){v(e),g.current=e,Y()}})]}),Object(j.jsx)(m.a,{sm:6,children:Object(j.jsx)(y.a,{options:u,defaultValue:C[0],onChange:function(e){N.current=e.value,Y()}})})]})})}),Object(j.jsx)(b.a.Group,{as:O.a,children:Object(j.jsx)(m.a,{sm:12,children:Object(j.jsxs)(O.a,{children:[Object(j.jsxs)(m.a,{sm:6,children:[Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,children:Object(j.jsx)("p",{children:"Desde:"})}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){M.current=e.target.value,Y()}})})]}),Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{onChange:function(e){k.current=e.target.value+":00",Y()},type:"time"})})]})]}),Object(j.jsxs)(m.a,{sm:6,children:[Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3,children:Object(j.jsx)("p",{children:"Hasta:"})}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){P.current=e.target.value,Y()}})})]}),Object(j.jsxs)(O.a,{children:[Object(j.jsx)(m.a,{sm:3}),Object(j.jsx)(m.a,{sm:9,children:Object(j.jsx)(b.a.Control,{onChange:function(e){w.current=e.target.value+":00",Y()},type:"time"})})]})]})]})})})]})})})};var Ae=function(){var e=Object(g.b)(),t=Object(g.c)((function(e){return e})),a=t.sensorDataLastUpdate,n=t.sensorData,s=Object(c.useState)(null),l=Object(i.a)(s,2),o=l[0],d=l[1],u=[];Object(c.useEffect)((function(){(a?_()().diff(a,"minutes"):999)>60?$().then((function(t){e(ae(t)),d(t)})).catch((function(e){return console.error(e)})):d(n)}),[]),o&&o.forEach((function(e){u.push({sensor_id:e.Sensor_id,zona:e.Zona,sistema:e.Sistema})}));var b=Object(c.useRef)(-1),h=Object(c.useState)([]),x=Object(i.a)(h,2),p=x[0],v=x[1],y=Object(c.useRef)([]),N=Object(c.useState)(null),S=Object(i.a)(N,2),C=S[0],M=S[1],P=Object(c.useState)(!1),D=Object(i.a)(P,2),k=D[0],A=D[1];function Y(e,t){y.current[t]=e}Object(c.useEffect)((function(){!function(){var e=[];if(C){for(var t=function(t){var a=u.find((function(e){return e.sensor_id===y.current[t].ubic.value})).zona,c="PM25"==y.current[t].ind?"PM2.5":y.current[t].ind;switch(G(c),c){case"PM2.5":z(15);break;case"PM10":z(45);break;case"O3":z(.051);break;case"NO2":z(.013);break;case"SO2":z(.015);break;default:z(null)}if(C[t].name="".concat(a," (").concat(c,")"),C[t].type="scatter",C[t].mode="lines",C[t].marker={color:V[t]},C[t].text=C[t].dia.map((function(e){return _.a.utc(new Date(e)).format("DD-MM-YYYY HH:mm:ss")})),C[t].hovertemplate="<i>Medida</i>: %{y:.4f}<br><b>%{text}</b>",e.push(C[t]),"PM2.5"==c||"PM10"==c){var n=Object(r.a)({},C[t]);n.name="".concat(a," (").concat(c,") Promedio movil 24h"),n.marker={color:Z[t]},n.y=n.moving_average,e.push(n);var s=Object(r.a)({},C[t]);s.name="".concat(a," (").concat(c,") Indice Aire y Salud"),s.marker={color:Q[t]},s.y=s.ICAR,e.push(s)}else if("SO2"==c){var i=Object(r.a)({},C[t]);i.name="".concat(a," (").concat(c,") Promedio movil 24h"),i.marker={color:Z[t]},i.y=i.moving_average,e.push(i)}else if("CO"==c){var l=Object(r.a)({},C[t]);l.name="".concat(a," (").concat(c,") Promedio movil 8h"),l.marker={color:Z[t]},l.y=l.moving_average,e.push(l)}},a=0;a<C.length;a++)t(a);T(e)}}()}),[C]);var R=Object(c.useState)(null),L=Object(i.a)(R,2),E=L[0],z=L[1],I={title:{text:"Compara datos"},showlegend:!0,hovermode:"closest",width:1e3,height:700},F=Object(c.useState)([]),H=Object(i.a)(F,2),q=H[0],T=H[1],B=Object(c.useState)(null),U=Object(i.a)(B,2),K=U[0],G=U[1],V=["red","green","blue","orange"],Z=["purple","pink","black","cyan"],Q=["orange","brown","grey","maroon"];return Object(j.jsxs)("div",{className:"container mt-5",children:[Object(j.jsxs)("div",{className:"ta-center mb-5",children:[Object(j.jsx)("h2",{children:"Compara datos"}),Object(j.jsx)("p",{children:"Compara la calidad del aire en diferente lugar y tiempo"})]}),Object(j.jsx)("hr",{className:"mb-4"}),Object(j.jsx)(O.a,{className:"mt-2 mb-1 d-flex justify-content-center",id:"filtros",children:p}),Object(j.jsx)(O.a,{className:"d-flex justify-content-end",children:Object(j.jsxs)(m.a,{sm:6,className:"d-flex justify-content-between",children:[Object(j.jsx)(f.a,{onClick:function(){b.current<3&&(b.current=b.current+1,v([].concat(Object(ke.a)(p),[Object(j.jsx)(we,{id:b.current,modifyData:Y,sensores:u})])))},children:"Agregar un filtro"}),Object(j.jsx)(f.a,{onClick:function(){return function(){if(-1!=b.current){var e=document.getElementById("filtro-".concat(b.current)).parentNode;e.parentNode.removeChild(e),b.current=b.current-1}}()},children:"Eliminar un filtro"}),Object(j.jsx)(f.a,{onClick:function(){return function(){if(!(b.current<0)){for(var e="",t="",a="",c="",n=0;n<=b.current;n++){if(!(y.current[n]&&y.current[n].desde&&y.current[n].hasta))return void alert("Selecciona las fechas");e+=y.current[n].ubic.label+",",t+=y.current[n].ind+",",a+=y.current[n].desde+"/"+y.current[n].desdeHora+",",c+=y.current[n].hasta+"/"+y.current[n].hastaHora+","}e=e.slice(0,-1),t=t.slice(0,-1),a=a.slice(0,-1),c=c.slice(0,-1);var s="ubic=".concat(e,"&ind=").concat(t,"&inicio=").concat(a,"&fin=").concat(c);A(!0),fetch("".concat(w,"/compare?").concat(s)).then((function(e){return e.json()})).then((function(e){console.log(e),A(!1),M(e)}))}}()},children:"Generar gr\xe1fica"})]})}),Object(j.jsx)(O.a,{children:Object(j.jsxs)(m.a,{sm:12,children:[Object(j.jsx)("div",{className:"text-center",children:Object(j.jsx)("img",{src:"loading.gif",alt:"Cargando...",className:"loading",style:k?{}:{display:"none"}})}),Object(j.jsx)("div",{class:"grafico-compara mt-5",children:Object(j.jsx)(me.a,{data:q,layout:C?Object(r.a)(Object(r.a)({},I),{},{shapes:function(){var e,t,a,c,n,s,r,i,l,o;switch(K){case"PM2.5":e=0,t=25,a=25,c=45,n=45,s=79,r=79,i=147,l=147,o=172;break;case"PM10":e=0,t=50,a=50,c=75,n=75,s=155,r=155,i=235,l=235,o=255;break;case"O3":e=0,t=.051,a=.051,c=.07,n=.07,s=.092,r=.092,i=.114,l=.114,o=.139;break;case"CO":e=0,t=8.75,a=8.75,c=11,n=11,s=13.3,r=13.3,i=15.5,l=15.5,o=17.5;break;case"NO2":e=0,t=.107,a=.107,c=.21,n=.21,s=.23,r=.23,i=.25,l=.25,o=.275;break;case"SO2":e=0,t=.008,a=.008,c=.11,n=.11,s=.165,r=.165,i=.22,l=.22,o=.255;break;default:e=0,t=25,a=25,c=45,n=45,s=79,r=79,i=147,l=147,o=172}return[{type:"rect",xref:"paper",x0:0,y0:e,x1:1,y1:t,fillcolor:"rgb(0, 228, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:a,x1:1,y1:c,fillcolor:"rgb(255, 255, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:n,x1:1,y1:s,fillcolor:"rgb(255, 126, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:r,x1:1,y1:i,fillcolor:"rgb(255, 0, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:l,x1:1,y1:o,fillcolor:"rgb(143, 63, 151)",opacity:.3,line:{width:0}},{type:"line",xref:"paper",x0:0,y0:E,x1:1,y1:E,line:{color:"#4682b4",width:2,dash:"dash"}}]}(),annotations:[{xref:"paper",x:1.01,y:E,xanchor:"left",yanchor:"middle",text:"L\xedmite recomendado <br>por la OMS 24h",showarrow:!1,font:{family:"Arial",size:12,color:"white"},bgcolor:"#4682b4"}]}):Object(r.a)({},I)})})]})})]})},Ye=a(12),Re=a(145),Le=function(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),a=t[0],n=t[1];return Object(j.jsxs)(Re.a,{variant:"dark",expand:"lg",expanded:a,children:[Object(j.jsx)(Re.a.Brand,{children:Object(j.jsx)(z.c,{to:"/",children:Object(j.jsx)("img",{src:"/logo.jpg",width:"40",height:"40",className:"d-inline-block align-top",alt:"React Bootstrap logo"})})}),Object(j.jsx)(Re.a.Text,{children:Object(j.jsx)("h1",{className:"white h1-nav mb-0",children:"Comit\xe9 Ecol\xf3gico Integral (Beta)"})}),Object(j.jsx)(Re.a.Toggle,{"aria-controls":"basic-navbar-nav",onClick:function(){return n(!a&&"expanded")}}),Object(j.jsx)(Re.a.Collapse,{id:"basic-navbar-nav",children:Object(j.jsxs)(o.a,{className:"ml-auto",children:[Object(j.jsx)(z.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",exact:!0,to:"/",children:"Mapa"}),Object(j.jsx)(z.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/registro",children:"Registro hist\xf3rico"}),Object(j.jsx)(z.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/compara",children:"Compara datos"}),Object(j.jsx)(z.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/",children:"Acerca de"})]})})]})},Ee=function(){return Object(j.jsx)("footer",{children:Object(j.jsx)("div",{className:"container",children:Object(j.jsx)("div",{className:"row",children:Object(j.jsxs)("div",{className:"col-auto py-3",children:[Object(j.jsxs)("p",{className:"mb-1 mt-2",children:["Los datos oficiales provienen de"," ",Object(j.jsx)("a",{className:"text-white",href:"https://sinaica.inecc.gob.mx/",children:"Sinaica"})," ","y de ",Object(j.jsx)("a",{className:"text-white",href:"http://aire.nl.gob.mx/",children:"Sima"})]}),Object(j.jsx)("p",{className:"mb-1",children:"Patrocinado por Natuuramika\xae 2021"}),Object(j.jsx)("p",{children:"Proyecto Solidario TEC de Monterrey"})]})})})})};var ze=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(z.a,{children:[Object(j.jsx)(Le,{}),Object(j.jsxs)(Ye.c,{children:[Object(j.jsx)(Ye.a,{exact:!0,path:"/",component:le}),Object(j.jsx)(Ye.a,{exact:!0,path:"/registro",component:De}),Object(j.jsx)(Ye.a,{exact:!0,path:"/compara",component:Ae})]}),Object(j.jsx)(Ee,{})]})})},Ie=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,149)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),c(e),n(e),s(e),r(e)}))},Fe=a(17),He=a(75),_e=a(85),qe=a.n(_e),Te=Object(He.a)({key:"root",storage:qe.a},ce),Be=a(86),Ue=function(){var e=Object(Fe.e)(Te);return{store:e,persistor:Object(He.b)(e)}}(),Ke=Ue.store,Ge=Ue.persistor;s.a.render(Object(j.jsx)(g.a,{store:Ke,children:Object(j.jsx)(Be.a,{loading:null,persistor:Ge,children:Object(j.jsx)(z.a,{children:Object(j.jsx)(ze,{})})})}),document.getElementById("root")),Ie()},96:function(e,t,a){},97:function(e,t,a){}},[[124,1,2]]]);
//# sourceMappingURL=main.b1aac5fd.chunk.js.map