{"version":3,"sources":["components/Recomendaciones.js","components/MapaFiltros.js","components/Marcador.js","components/WrapperMapa.js","hooks/useSensorData.js","Mapa.js","constants.js","handlers/statusCriteria.js","handlers/data.js"],"names":["Recomendaciones","props","className","Tab","Container","fill","activeKey","selected","Nav","Item","NavLink","eventKey","Content","Pane","systemOptions","value","label","opt","intervalos","MapaFiltros","onApply","sensorData","useSelector","state","useState","systemChosen","setSystemChosen","locationOptions","useMemo","filter","sensor","Longitud","Latitud","Sistema","idBlacklist","includes","Sensor_id","idBlacklistpriv","map","record","Zona","indicadores","indOptions","setIndOptions","useEffect","show","setShow","location","setLocation","interval","setInterval_","gas","setGas","handleClose","Form","style","fontSize","Row","Col","xs","lg","placeholder","onChange","options","isDisabled","OverlayTrigger","placement","overlay","Tooltip","Button","variant","onClick","color","block","Modal","size","onHide","Header","closeButton","Title","Body","Footer","showLabel","fixed","toFixed","parseInt","Marcador","ICAR","status","position","current","provider","locationStr","labels","lastUpdate","shape","marker","document","createElement","popupRef","useRef","icon","setIcon","updateMarker","useCallback","label_","status_","ReactDOM","render","zIndex","backgroundColor","renderMarker","divIcon","html","popupAnchor","Marker","Popup","ref","type","class","aria-label","display","justifyContent","padding","indicator","units","moment","format","idx","to","pathname","search","target","href","name","defaultProps","Wrapper","center","children","MapContainer","scrollWheelZoom","height","widht","TileLayer","attribution","url","useSensorData","cacheTime","useCache","sensorDataLastUpdate","dispatch","useDispatch","loading","setLoading","data","setData","error","setError","diff","fetchSummaryData","then","setSensorData","catch","err","console","finally","mapDefaultProps","zoom","minZoom","Mapa","gases","currentGas","setCurrentGas","loadingSensorData","errorSensorData","setMap","setCenter","pos","setView","animate","airQualityIndex","log","highestAirQualityIndex","mapBlacklist","gasName","preValue","gasStatus","getStatus","markers","gasUnits","utc","Dia","local","length","isPurpleAir","colName","fSensor","find","nGas","gas_","alert","width","role","Spinner","animation","pointerEvents","trigger","Popover","as","boxSizing","borderRadius","marginRight","border","whenCreated","markerProps","airQualityTags","unidad","PM25","PM10","CO","O3","NO2","SO2","apiUrl","process","REACT_APP_API_URL","criteria","NOM","norm","breakpoints","i","retry","fn","ms","retries","Promise","resolve","reject","setTimeout","fetchSummaryDataFn","fetch","res","json"],"mappings":"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","file":"static/js/7.7dafff76.chunk.js","sourcesContent":["import { Nav, NavLink, Tab } from 'react-bootstrap'\r\n\r\nconst Recomendaciones = (props) => {\r\n    return (\r\n        <div className=\"container mt-5 mb-3\">\r\n            <div className=\"ta-center mb-5\">\r\n                <h3>Concentración horaria</h3>\r\n                <p>Conoce las recomendaciones según el índice de calidad del aire</p>\r\n            </div>\r\n            <Tab.Container fill activeKey={props.selected ?? \"buena\"} className=\"recomendaciones h-100\">\r\n                <Nav fill>\r\n                    <Nav.Item>\r\n                        <NavLink eventKey=\"buena\" className=\"nav-buena\">Buena</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <NavLink eventKey=\"acept\" className=\"nav-acept\">Aceptable</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <NavLink eventKey=\"mala\" className=\"nav-mala\">Mala</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <NavLink eventKey=\"muy\" className=\"nav-muy\">Muy Mala</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <NavLink eventKey=\"ext\" className=\"nav-ext\">Extremadamente Mala</NavLink>\r\n                    </Nav.Item>\r\n                </Nav>\r\n\r\n                <Tab.Content>\r\n                    <Tab.Pane eventKey=\"buena\">\r\n                        <ul>\r\n                            <li>Realizar actividades al aire libre</li>\r\n                            <li>Ejercitarse al aire libre</li>\r\n                            <li>Sin riesgo para personas vulnerables</li>\r\n                        </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"acept\">\r\n                        <ul>\r\n                            <li>Realizar actividades al aire libre</li>\r\n                            <li>Ejercitarse al aire libre</li>\r\n                            <li>Personas vulnerables limitar actividades físicas</li>\r\n                        </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"mala\">\r\n                        <ul>\r\n                            <li>Limitar actividades físicas al aire libre, incrementar frecuencia de descansos, vigilar que estudiantes no presenten síntomas de afecciones respiratorias.</li>\r\n                            <li>Limitar tiempo de exposición</li>\r\n                            <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                            <li>Considerar suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                            <li>Se recomienda el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                        </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"muy\">\r\n                        <ul>\r\n                            <li>Evitar actividades al aire libre</li>\r\n                            <li>Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificación de aire</li>\r\n                            <li>Cerrar puertas y ventanas</li>\r\n                            <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                            <li>Acudir al médico en caso de síntomas de afectaciones a la salud</li>\r\n                            <li>Evitar fogatas y uso de combustibles sólidos como carbón o leña</li>\r\n                            <li>Suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                            <li>Suspender el uso de cigarros de cualquier tipo</li>\r\n                            <li>Limitar el uso de vehículos que usen combustibles fósiles</li>\r\n                            <li>Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                        </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"ext\">\r\n                        <ul>\r\n                            <li>Evitar actividades al aire libre</li>\r\n                            <li>Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificación de aire</li>\r\n                            <li>Cerrar puertas y ventanas</li>\r\n                            <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                            <li>Acudir al médico o solicitar servicios de emergencias en caso de síntomas de afectaciones a la salud</li>\r\n                            <li>Evitar fogatas y uso de combustibles sólidos como carbón o leña</li>\r\n                            <li>Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                            <li>Suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                            <li>Suspender el uso de cigarros de cualquier tipo</li>\r\n                            <li>Limitar el uso de vehículos que usen combustibles fósiles</li>\r\n                        </ul>\r\n                    </Tab.Pane>\r\n                </Tab.Content>\r\n            </Tab.Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Recomendaciones\r\n","import { useMemo, useState, useEffect } from 'react';\r\nimport {\r\n    Form,\r\n    Modal,\r\n    Button,\r\n    Col,\r\n    Row,\r\n    Tooltip,\r\n    OverlayTrigger,\r\n} from 'react-bootstrap';\r\nimport { BsInfoCircle } from 'react-icons/bs';\r\nimport { useSelector } from 'react-redux';\r\nimport Select from 'react-select';\r\nimport { indicadores, idBlacklist, idBlacklistpriv } from '../constants'\r\n\r\nconst systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon', opt: 'G'}\r\n]\r\n\r\nconst intervalos =  [\r\n    {value: '1', label: 'Tiempo real'},\r\n    {value: '2', label: '12 horas'},\r\n    {value: '3', label: '24 horas'},\r\n    {value: '4', label: 'Última semana'},\r\n    {value: '5', label: 'Último mes'},\r\n    {value: '6', label: 'Último año'}\r\n]\r\n\r\nconst MapaFiltros = ({ onApply }) => {\r\n    const { sensorData } = useSelector((state) => state);\r\n    const [systemChosen, setSystemChosen] = useState(\"\");\r\n    const locationOptions = useMemo(() => {\r\n        return sensorData\r\n            .filter(\r\n                (sensor) =>\r\n                    typeof sensor.Longitud === 'number' &&\r\n                    typeof sensor.Latitud === 'number' && \r\n                    sensor.Sistema === systemChosen.label &&\r\n                    !idBlacklist.includes(sensor.Sensor_id) &&\r\n                    !idBlacklistpriv.includes(sensor.Sensor_id)\r\n            )\r\n            .map((record) => ({\r\n                value: record.Sensor_id,\r\n                label: record.Zona,\r\n            }));\r\n    }, [sensorData, systemChosen]);\r\n\r\n    const [indOptions, setIndOptions] = useState(indicadores);\r\n\r\n    useEffect(() => {\r\n        systemChosen.label === 'PurpleAir' ? setIndOptions([indicadores[0]]) : setIndOptions(indicadores)\r\n    }, [systemChosen]); // Updatea los gases disponibles cuando cambia la variable sistemas\r\n\r\n    const [show, setShow] = useState(false);\r\n    const [location, setLocation] = useState(null);\r\n    const [interval, setInterval_] = useState(intervalos[0]);\r\n    const [gas, setGas] = useState(indicadores[0]);\r\n\r\n    const handleClose = () => setShow(false);\r\n    const handleShow = () => setShow(true);\r\n   \r\n\r\n\r\n    return (\r\n        <div className=\"container mt-5\">\r\n            <Form>\r\n                <p style={{ fontSize: \"0.9em\" }}>*Recuerda que el sistema PurpleAir solo tiene disponible el contaminante PM2.5</p>\r\n                <Form.Row className=\"mapa-filtros\"> \r\n                    <Col className=\"mb-3\" xs={12} lg={4}>\r\n                        <Select\r\n                            placeholder=\"Sistema\"\r\n                            value={systemChosen}\r\n                            onChange={(value) => {\r\n                                setSystemChosen(value)\r\n                                setLocation(null)\r\n                            }}\r\n                            options={systemOptions}\r\n                        />\r\n                        <Select\r\n                            placeholder=\"Ubicación\"\r\n                            value={location}\r\n                            onChange={setLocation}\r\n                            options={locationOptions}\r\n                        />\r\n                    </Col>\r\n                    <Col className=\"mb-3\" xs={6} lg={3}>\r\n                        <Select\r\n                            isDisabled\r\n                            options={intervalos}\r\n                            onChange={setInterval_}\r\n                            value={interval}\r\n                        />\r\n                    </Col>\r\n                    <Col xs={6} lg={3}>\r\n                        <Row>\r\n                            <Col xs={10}>\r\n                                <Select\r\n                                    options={indOptions}\r\n                                    value={gas}\r\n                                    onChange={setGas}\r\n                                />\r\n                            </Col>\r\n                            <Col xs={2}>\r\n                            <OverlayTrigger\r\n                            key='top'\r\n                            placement='top'\r\n                            overlay={\r\n                                <Tooltip>\r\n                                Info. indicadores\r\n                                </Tooltip>\r\n                            }\r\n                            >\r\n                                <Button className=\"info-btn\" variant=\"link\" onClick={handleShow }>\r\n                                    <BsInfoCircle color=\"MediumVioletRed\" />\r\n                                </Button>\r\n                            </OverlayTrigger>\r\n                                \r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col>\r\n                        <Button\r\n                            className=\"btn-aplicar\"\r\n                            variant=\"primary\"\r\n                            block\r\n                            onClick={() => {\r\n                                onApply({ gas, location, interval });\r\n                                setLocation(null);\r\n                                setInterval_(intervalos[0]);\r\n                            }}\r\n                        >\r\n                            Aplicar\r\n                        </Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n  \r\n            <Modal size=\"lg\" show={show} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Indicadores</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">PM 10</span>&emsp; Material Particulado menor a 10 micrómetros</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Mezcla compleja de partículas líquidas o sólidas que provienen de fuentes naturales o de fuentes antropogénicas, poseen un tamaño aerodinámico menor a 10 micrómetros.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">PM 2.5</span>&emsp; Material Particulado menor a 2.5 micrómetros</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Mezcla Compleja de Partículas líquidas o sólidas que provienen principalmente de fuentes antropogénicas, poseen un tamaño aerodinámico menor a 2.5 micrómetros.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">O2</span>&emsp; Ozono</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Gas compuesto por 3 átomos de oxigeno que se encuentra principalmente en la estratosfera, puede formarse a nivel superficial debido a condiciones de alta radiación y temperatura.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">CO</span>&emsp; Monóxido de Carbono</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Gas incoloro que se forma principalmente por la combustión de gasolinas, leña o carbón, este compuesto, en altas concentraciones puede ser muy nocivo a la salud.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">SO2</span>&emsp; Dióxido de Azufre</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Es un gas formado por 2 átomos de oxígeno y uno de azufre, se forma principalmente por la combustión de combustibles fósiles con alto contenido de azufre.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">NO2</span>&emsp; Dióxido de Nitrógeno</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Molécula con 2 átomos de oxígeno y uno de Nitrógeno que se produce principalmente por la combustión de combustibles fósiles empleados en vehículos y plantas de energía.</p>\r\n                </Row>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={handleClose}>\r\n                Cerrar\r\n                </Button>\r\n            </Modal.Footer>\r\n            </Modal>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapaFiltros;\r\n","import React, {\r\n    useCallback,\r\n    useEffect,\r\n    useMemo,\r\n    useRef,\r\n    useState,\r\n} from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport PropTypes from 'prop-types';\r\nimport { divIcon } from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport { Marker, Popup } from 'react-leaflet';\r\nimport { Button, Form, Col } from 'react-bootstrap';\r\nimport moment from 'moment';\r\n\r\n\r\nconst showLabel = (label) => {\r\n    if (typeof label != 'number') return label;\r\n    const fixed = label.toFixed(2);\r\n    if (parseInt(fixed) === label) return label\r\n    return fixed;\r\n};\r\n\r\nconst renderMarker = (label, status, shape = 'round') => {\r\n    return (\r\n        <div\r\n            className=\"marker-wrapper\"\r\n            style={{ zIndex: shape === 'round' ? -1 : -10 }}\r\n        >\r\n            <div\r\n                className={`marker-${status} marker-base marker-shape-${shape}`}\r\n            ></div>\r\n            <span\r\n                className={`marker-${status}`}\r\n                style={{ backgroundColor: 'transparent' }}\r\n            >\r\n                {showLabel(label)}\r\n            </span>\r\n        </div>\r\n    );\r\n};\r\n\r\n/**\r\n * Marcador\r\n * @augments {Component<Props, State>}\r\n */\r\nfunction Marcador({\r\n    ICAR,\r\n    label,\r\n    status,\r\n    position,\r\n    current,\r\n    provider,\r\n    locationStr,\r\n    labels,\r\n    lastUpdate,\r\n    map,\r\n    shape = 'round',\r\n    ...props\r\n}) {\r\n    const marker = useMemo(() => document.createElement('div'), []);\r\n    const popupRef = useRef();\r\n    const [icon, setIcon] = useState(null);\r\n\r\n    const updateMarker = useCallback(\r\n        (label_, status_) => {\r\n            ReactDOM.render(renderMarker(label_, status_, shape), marker);\r\n\r\n            setIcon(\r\n                divIcon({\r\n                    html: marker,\r\n                    className: `sensor-icon ${shape === 'round' ? '' : 'behind'\r\n                        }`,\r\n                    popupAnchor: [7, 0],\r\n                })\r\n            );\r\n        },\r\n        [shape]\r\n    );\r\n\r\n    useEffect(() => {\r\n        updateMarker(label, status);\r\n    }, [label, status, updateMarker]);\r\n\r\n    if (!icon) return null;\r\n\r\n    return (\r\n\r\n        <Marker position={position} icon={icon} {...props}>\r\n            <Popup\r\n                ref={popupRef}\r\n                className=\"custom-popup\"\r\n                closeButton={(props) => (\r\n                    <button\r\n                        {...props}\r\n                        type=\"button\"\r\n                        class=\"btn-close\"\r\n                        aria-label=\"Close\"\r\n                    ></button>\r\n                )}\r\n            >\r\n\r\n                <div className=\"px-3 py-2\">\r\n                    <div\r\n                        className={`rounded marker-${current.status}`}\r\n                        style={{\r\n                            display: 'flex',\r\n                            justifyContent: 'center',\r\n                            padding: '0 0.1rem ',\r\n                        }}\r\n                    >\r\n                        {current.indicator}: {current.label} {current.units}\r\n                    </div>\r\n\r\n                    <div className=\"data-label\">\r\n                        <small className=\"text-muted\">Ubicación</small>\r\n                        <br />\r\n                        <data>{locationStr}</data>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"data-label\">\r\n                        <small className=\"text-muted\">\r\n                            Última actualización\r\n                        </small>\r\n                        <br />\r\n                        <time>\r\n                            {moment(lastUpdate).format(\r\n                                'ddd, MMMM D YYYY, h:mm:ss a'\r\n                            )}\r\n                        </time>\r\n                    </div>\r\n                    <div className=\"data-label2\">\r\n                        <small className=\"text-muted\">Tiempo Real</small>\r\n                        <small className=\"text-muted ml-5\">Indice Calidad Aire</small>\r\n                    </div>\r\n\r\n                    <Form >\r\n                        {labels.map(({ label, status, value, units }, idx) => (\r\n\r\n                            <Form.Row\r\n\r\n                                key={idx}\r\n                                className=\"d-flex justify-content-between  mb-1 \"\r\n                            >\r\n                                <Col xs={3}>\r\n                                    <Link\r\n                                        to={{\r\n                                            pathname: 'registro',\r\n                                            search: `?gas=${label}`,\r\n                                        }}\r\n\r\n                                    >\r\n                                        {label}\r\n                                    </Link>\r\n                                </Col>\r\n                                <Col className={`d-flex justify-content-between px-1 rounded marker-${status}`} xs={5}>\r\n\r\n\r\n                                    <span>{value}</span>\r\n                                    <span>{units}</span>\r\n\r\n\r\n                                </Col>\r\n                                <Col className={`d-flex justify-content-between px-1 rounded marker-${status}`} xs={3}>\r\n\r\n                                    {\r\n                                        label === 'PM2.5' ?\r\n                                            ICAR === '-1.00' ?\r\n                                                <span>{'ND'}</span>\r\n                                                :\r\n                                                ICAR === '0.00' ?\r\n                                                    <span>{'ND'}</span>\r\n                                                    :\r\n                                                    <span>{ICAR.toFixed(2)}</span>\r\n                                            :\r\n                                            <span>{'ND'}</span>\r\n                                    }\r\n\r\n                                </Col>\r\n                            </Form.Row>\r\n\r\n\r\n                        ))}\r\n                    </Form>\r\n                </div>\r\n\r\n                <div className=\"py-2 px-3 border-top text-center\">\r\n                    <Button size=\"sm\">Más información</Button>\r\n                    <p className=\"lh-sm mt-2 mb-0\">\r\n                        Fuente(s): <a target='blank' href={provider.ref}>{provider.name}</a>\r\n                    </p>\r\n                </div>\r\n            </Popup>\r\n        </Marker>\r\n    );\r\n}\r\n\r\nMarcador.defaultProps = {};\r\n\r\nMarcador.propTypes = {\r\n    /**\r\n     * Etiqueta del indicador que muestra el popup\r\n     */\r\n    indicator: PropTypes.string,\r\n\r\n    /**\r\n     * Informacion del indicador que muestra el popup\r\n     */\r\n    current: PropTypes.shape({\r\n        label: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n        status: PropTypes.number,\r\n        units: PropTypes.string,\r\n    }),\r\n\r\n    /**\r\n     * Fecha de la ultima actualización del sensor en milisegundos\r\n     */\r\n    lastUpdate: PropTypes.instanceOf(Date),\r\n\r\n    /**\r\n     * Etiqueta de la ubicación del sensor\r\n     */\r\n    locationStr: PropTypes.string,\r\n\r\n    /**\r\n     * LatLng del marcador\r\n     */\r\n    position: PropTypes.arrayOf(PropTypes.number),\r\n\r\n    /**\r\n     * Informacion de la fuente del sensor (e.g. Purple Air, Sinaica, etc.)\r\n     */\r\n    provider: PropTypes.shape({\r\n        name: PropTypes.string,\r\n        ref: PropTypes.string,\r\n    }),\r\n\r\n    /**\r\n     * Informacion de todos los indicadores del sensor\r\n     */\r\n    labels: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            indicator: PropTypes.string,\r\n            label: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n            status: PropTypes.number,\r\n            units: PropTypes.string,\r\n            ref: PropTypes.string,\r\n        })\r\n    ),\r\n};\r\n\r\nexport default Marcador;\r\n","import React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport '../styles/marker.css';\r\nimport { MapContainer, TileLayer } from 'react-leaflet';\r\n\r\n/**\r\n * Wrapper\r\n * @augments {Component<Props, State>}\r\n */\r\nfunction Wrapper({ center, children, ...props }) {\r\n    return (\r\n        <MapContainer\r\n            center={center}\r\n            scrollWheelZoom={false}\r\n            style={{\r\n                height: '100%',\r\n                widht: '100%',\r\n            }}\r\n            {...props}\r\n        >\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"https://stadiamaps.com/\">Stadia Maps</a>, &copy; <a href=\"https://openmaptiles.org/\">OpenMapTiles</a> &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors'\r\n                url=\"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png?api_key=e4368efd-701c-4da6-8372-03f4040a622a\"\r\n            />\r\n            {children}\r\n        </MapContainer>\r\n    );\r\n}\r\n\r\nWrapper.defaultProps = {};\r\n\r\nWrapper.propTypes = {\r\n    /**\r\n     * Nodos hijos del mapa (solo elementos de leaflet)\r\n     */\r\n    children: PropTypes.node,\r\n\r\n    /**\r\n     * Un arreglo [lat, lng] con la posición del centro del mapa\r\n     */\r\n    center: PropTypes.arrayOf(PropTypes.number),\r\n\r\n    setMap: PropTypes.func,\r\n};\r\n\r\nexport default Wrapper;\r\n","import moment from 'moment';\r\nimport { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { fetchSummaryData } from '../handlers/data';\r\nimport { setSensorData } from '../redux/reducers';\r\n\r\nconst useSensorData = ({ cacheTime = 60, useCache = true }) => {\r\n    const { sensorDataLastUpdate, sensorData } = useSelector((state) => state);\r\n    const dispatch = useDispatch();\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [data, setData] = useState(sensorData);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        // Llama a la api si los datos se guardaron hace menos de una hora\r\n        const diff = sensorDataLastUpdate && useCache\r\n            ? moment().diff(sensorDataLastUpdate, 'minutes')\r\n            : 999; // Caso sensorDataLastUpdate === null, se tienen que solicitar los datos\r\n\r\n        if (diff > cacheTime) {\r\n            fetchSummaryData()\r\n                .then((data) => {\r\n                    dispatch(setSensorData(data));\r\n                    setData(data);\r\n                })\r\n                .catch((err) => {\r\n                    console.error(err);\r\n                    setData([]);\r\n                    setError(err);\r\n                })\r\n                .finally(() => setLoading(false));\r\n        } else {\r\n            setLoading(false);\r\n        }\r\n    }, [sensorDataLastUpdate, dispatch, cacheTime, useCache]);\r\n\r\n    return { loading, data, error };\r\n};\r\n\r\nexport default useSensorData;\r\n","import React, { useCallback, useMemo, useState } from \"react\";\r\nimport Recomendaciones from \"./components/Recomendaciones.js\";\r\nimport MapaFiltros from \"./components/MapaFiltros.js\";\r\nimport Marcador from \"./components/Marcador.js\";\r\nimport Wrapper from \"./components/WrapperMapa.js\";\r\n\r\nimport { gases, mapBlacklist, idBlacklist } from \"./constants.js\";\r\nimport { getStatus, airQualityTags } from \"./handlers/statusCriteria.js\";\r\nimport useSensorData from \"./hooks/useSensorData.js\";\r\nimport { Spinner, OverlayTrigger, Popover, Button } from \"react-bootstrap\";\r\nimport moment from \"moment\";\r\n\r\nconst mapDefaultProps = {\r\n  center: [25.67, -100.25],\r\n  zoom: 11,\r\n  minZoom: 10,\r\n};\r\n\r\nfunction Mapa() {\r\n  const [currentGas, setCurrentGas] = useState(gases[0]);\r\n  const {\r\n    data: sensorData,\r\n    loading: loadingSensorData,\r\n    error: errorSensorData,\r\n  } = useSensorData({});\r\n\r\n  const [map, setMap] = useState(null);\r\n\r\n  const setCenter = useCallback(\r\n    (pos) => {\r\n      if (map) {\r\n        // setLastCenter(pos);\r\n        map.setView(pos, mapDefaultProps.zoom, {\r\n          animate: true,\r\n        });\r\n      }\r\n    },\r\n    [map]\r\n  );\r\n\r\n  const airQualityIndex = useMemo(\r\n    () => {\r\n      if (sensorData === null) {\r\n        console.log(\"No data yet\");\r\n        return 0;\r\n      }\r\n\r\n      let highestAirQualityIndex = 0;\r\n\r\n      const filteredSensors = sensorData.filter(\r\n        (sensor) =>\r\n          typeof sensor.Longitud === \"number\" &&\r\n          typeof sensor.Latitud === \"number\" &&\r\n          !mapBlacklist.includes(sensor.Sistema) &&\r\n          !idBlacklist.includes(sensor.Sensor_id)\r\n      );\r\n\r\n      filteredSensors.map((data) => {\r\n        const { name: gasName, units: gasUnits } = currentGas;\r\n\r\n        let preValue =\r\n          gasName === \"PM25\"\r\n            ? data.Sistema === \"PurpleAir\"\r\n              ? data[\"PM25_Promedio\"]\r\n              : data[gasName]\r\n            : data[gasName];\r\n\r\n        const value = typeof preValue === \"number\" ? preValue : \"ND\";\r\n\r\n        const gasStatus = getStatus(gasName, value);\r\n        if (gasStatus > highestAirQualityIndex) {\r\n          highestAirQualityIndex = gasStatus;\r\n        }\r\n      });\r\n\r\n      return highestAirQualityIndex;\r\n    },  \r\n    [sensorData]\r\n  );\r\n\r\n  const markers = useMemo(() => {\r\n    const filteredSensors = sensorData.filter(\r\n      (sensor) =>\r\n        typeof sensor.Longitud === \"number\" &&\r\n        typeof sensor.Latitud === \"number\" &&\r\n        !mapBlacklist.includes(sensor.Sistema) &&\r\n        !idBlacklist.includes(sensor.Sensor_id)\r\n    );\r\n    \r\n    const resultingData = filteredSensors.map((data) => {\r\n      const { name: gasName, units: gasUnits } = currentGas;\r\n\r\n      let preValue =\r\n        gasName === \"PM25\"\r\n          ? data.Sistema === \"PurpleAir\"\r\n            ? data[\"PM25_Promedio\"]\r\n            : data[gasName]\r\n          : data[gasName];\r\n\r\n      const value = typeof preValue === \"number\" ? preValue : \"ND\";\r\n\r\n      return {\r\n        ICAR: +data.ICAR,\r\n        position: [data.Latitud, data.Longitud],\r\n        current: {\r\n          indicator: currentGas.label ? currentGas.label : gasName,\r\n          label: value,\r\n          units: gasUnits,\r\n          status: value !== \"ND\" ? getStatus(gasName, value) : 99,\r\n          ref: \"#\",\r\n        },\r\n        lastUpdate: moment.utc(data.Dia).local(),\r\n        locationStr: data.Zona?.length > 0 ? data.Zona : \"ND\",\r\n        provider: {\r\n          name: data.Sistema,\r\n          ref: (() => {\r\n            if (data.Sistema === \"PurpleAir\")\r\n              return \"https://www.purpleair.com/map?mylocation\";\r\n            if (data.Sistema === \"AireNuevoLeon\")\r\n              return \"http://aire.nl.gob.mx/\";\r\n            if (data.Sistema === \"Sinaica\")\r\n              return \"https://sinaica.inecc.gob.mx/\";\r\n            return \"#\";\r\n          })(),\r\n        },\r\n        isPurpleAir: data.Sistema === \"PurpleAir\",\r\n        labels: gases.map(({ name, label, units }) => {\r\n          let colName = name;\r\n          if (name === \"PM25\" && data.Sistema === \"PurpleAir\")\r\n            colName = \"PM25_Promedio\";\r\n          return {\r\n            label: label ? label : name,\r\n            units,\r\n            value: typeof data[colName] === \"number\" ? data[colName] : \"ND\",\r\n            status: data[colName] ? getStatus(name, data[colName]) : 99,\r\n            ref: \"#\",\r\n          };\r\n        }),\r\n      };\r\n    });\r\n\r\n    return resultingData;\r\n  }, [sensorData, currentGas]);\r\n\r\n  return (\r\n    <div>\r\n      <MapaFiltros\r\n        onApply={({ gas, location }) => {\r\n          if (location) {\r\n            // Encuentra sensor al que le corresponde la ubicación de los filtros\r\n            const fSensor = sensorData.find(\r\n              (record) => record.Sensor_id === location.value\r\n            );\r\n\r\n            if (fSensor) {\r\n              setCenter([fSensor.Latitud, fSensor.Longitud]);\r\n            }\r\n          } else {\r\n            alert(\"Selecciona una ubicación\");\r\n            return;\r\n          }\r\n\r\n          if (gas) {\r\n            const nGas = gases.find((gas_) => gas_.name === gas.value);\r\n            setCurrentGas(nGas ?? currentGas);\r\n          }\r\n        }}\r\n      />\r\n      <div\r\n        className=\"my-4\"\r\n        style={{\r\n          zIndex: 0,\r\n          position: \"relative\",\r\n          width: \"100%\",\r\n          height: \"500px\",\r\n        }}\r\n      >\r\n        {errorSensorData && (\r\n          <div\r\n            className=\"position-absolute w-100 end-0 p-2\"\r\n            style={{ zIndex: 100 }}\r\n          >\r\n            <div class=\"alert alert-danger\" role=\"alert\">\r\n              Ocurrió un error al cargar los datos.\r\n            </div>\r\n          </div>\r\n        )}\r\n        {loadingSensorData && (\r\n          <div\r\n            className=\"w-100 h-100 d-flex position-absolute\"\r\n            style={{\r\n              zIndex: 100,\r\n              backgroundColor: \"rgba(0,0,0,0.2)\",\r\n            }}\r\n          >\r\n            <div className=\"position-absolute top-50 start-50 translate-middle\">\r\n              <Spinner animation=\"border\" />\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div\r\n          className=\"w-100 h-100 position-absolute p-2\"\r\n          style={{ zIndex: 99, pointerEvents: \"none\" }}\r\n        >\r\n          <div className=\"position-absolute end-0\">\r\n            <OverlayTrigger\r\n              trigger=\"click\"\r\n              placement={\"left\"}\r\n              overlay={\r\n                <Popover>\r\n                  <Popover.Title as=\"h3\">Leyenda</Popover.Title>\r\n                  <Popover.Content>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <div\r\n                        style={{\r\n                          boxSizing: \"border-box\",\r\n                          borderRadius: \"100%\",\r\n                          width: \"35px\",\r\n                          height: \"20px\",\r\n                          marginRight: \"0.75rem\",\r\n                          padding: 0,\r\n                          border: \"1px solid black\",\r\n                        }}\r\n                      ></div>\r\n                      Los sensores del estado se representan con un círculo\r\n                    </div>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <div\r\n                        style={{\r\n                          boxSizing: \"border-box\",\r\n                          width: \"35px\",\r\n                          height: \"20px\",\r\n                          marginRight: \"0.75rem\",\r\n                          padding: 0,\r\n                          border: \"1px solid black\",\r\n                        }}\r\n                      ></div>\r\n                      Los sensores de Purple Air se representan con un cuadrado\r\n                    </div>\r\n                  </Popover.Content>\r\n                </Popover>\r\n              }\r\n            >\r\n              <Button variant=\"link\" className=\"pe-auto\">\r\n                Leyenda\r\n              </Button>\r\n            </OverlayTrigger>\r\n          </div>\r\n        </div>\r\n        <Wrapper whenCreated={setMap} {...mapDefaultProps}>\r\n          {!loadingSensorData &&\r\n            markers.map((markerProps, idx) => { \r\n              return (\r\n                <Marcador\r\n                  map={map}\r\n                  key={idx}\r\n                  {...markerProps}\r\n                  label={markerProps.current.label}\r\n                  indicator={markerProps.current.indicator}\r\n                  status={markerProps.current.status}\r\n                  shape={markerProps.isPurpleAir ? \"square\" : \"round\"}\r\n                />\r\n              );\r\n            })}\r\n        </Wrapper>\r\n      </div>\r\n      <Recomendaciones selected={airQualityTags[airQualityIndex]} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Mapa;\r\n","export const gases = [\r\n    {\r\n        name: 'PM25',\r\n        label: 'PM2.5',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'PM10',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'O3',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'CO',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'NO2',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'SO2',\r\n        units: 'ppm',\r\n    },\r\n];\r\n\r\n// Opciones del dropdown de sistemas:\r\nexport const systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"Sinaica\", label: 'Sinaica', opt: 'G'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon', opt: 'G'}\r\n]\r\n\r\n// Opciones del dropdown de gases:\r\nexport const indicadores = [\r\n    { value: 'PM25', label: 'PM2.5' },\r\n    { value: 'PM10', label: 'PM10' },\r\n    { value: 'O3', label: 'O3' },\r\n    { value: 'CO', label: 'CO' },\r\n    { value: 'NO2', label: 'NO2' },\r\n    { value: 'SO2', label: 'SO2' },\r\n];\r\n\r\nexport const unidad = {\r\n    PM25: 'µg/m3',\r\n    PM10: 'µg/m3',\r\n    CO: 'ppm',\r\n    O3: 'ppm',\r\n    NO2: 'ppm',\r\n    SO2: 'ppm',\r\n};\r\nexport const idBlacklist = [\r\n    'P36757',\r\n    'P47305',\r\n    'P39499',\r\n    'P46239',\r\n    'P50855',\r\n    'P35099',\r\n    'P39709',\r\n    'P39497',\r\n    'P39285',\r\n    'P39355',\r\n\r\n\r\n\r\n];\r\nexport const idBlacklistpriv = [\r\n    'P39497',\r\n    'P39285',\r\n    'P39355'\r\n\r\n];\r\nexport const mapBlacklist = [\r\n    'Sinaica', \r\n\r\n];\r\n\r\nexport const apiUrl =\r\n    process.env.NODE_ENV === 'production'\r\n        ? process.env.REACT_APP_API_URL\r\n        : 'http://127.0.0.1:8000';\r\n","export const criteria = {\r\n    'Aire y Salud': {\r\n        PM10: [50, 75, 155, 235],\r\n        PM25: [25, 45, 78, 147],\r\n        O3: [0.051, 0.095, 0.135, 0.175],\r\n        CO: [8.75, 11.00, 13.30, 15.50],\r\n        SO2: [0.008, 0.110, 0.165, 0.220],\r\n        NO2: [0.107, 0.210, 0.230, 0.250],\r\n    },\r\n    NOM: {\r\n        PM10: [100, 135, 214, 300],\r\n        PM25: [55, 75, 97.4, 128.8],\r\n        O3: [0.07, 0.093, 0.115, 0.137],\r\n        CO: [12, 13.9, 15.9, 18.9],\r\n        SO2: [0.253, 0.345, 0.435, 0.566],\r\n        NO2: [0.132, 0.176, 0.221, 0.289],\r\n    },\r\n};\r\n\r\nexport const airQualityTags = [\"buena\", \"acept\", \"mala\", \"muy\", \"ext\"];\r\n\r\nexport const getStatus = (gas, value, norm = 'Aire y Salud') => {\r\n    const breakpoints = criteria[norm][gas];\r\n\r\n    for (let i = breakpoints.length - 1; i >= 0; i--) {\r\n        if (value > breakpoints[i]) {\r\n            return parseInt(i) + 1;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n};\r\n","import { apiUrl } from '../constants';\r\n\r\nconst retry = (fn, ms = 1000, retries = 5) =>\r\n    new Promise((resolve, reject) => {\r\n        fn()\r\n            .then(resolve)\r\n            .catch(() => {\r\n                setTimeout(() => {\r\n                    if (!retries) {\r\n                        return reject(\r\n                            'Se excedió el número máximo de intentos'\r\n                        );\r\n                    }\r\n                    retry(fn, ms, retries - 1).then(resolve, reject);\r\n                }, ms);\r\n            });\r\n    });\r\n\r\nconst fetchSummaryDataFn = () =>\r\n    new Promise((resolve, reject) => {\r\n        fetch(`${apiUrl}/sensor-summary`)\r\n            .then((res) => {\r\n                if (res.status === 200) {\r\n                    return res.json();\r\n                } else {\r\n                    reject();\r\n                }\r\n            })\r\n            .then((json) => {\r\n                resolve(json);\r\n            })\r\n            .catch((err) => reject(err));\r\n    });\r\n\r\nexport const fetchSummaryData = () => {\r\n    return retry(fetchSummaryDataFn);\r\n};\r\n"],"sourceRoot":""}