(this.webpackJsonpcei=this.webpackJsonpcei||[]).push([[0],{116:function(e,a,t){},120:function(e,a,t){},124:function(e,a,t){"use strict";t.r(a);var c=t(1),n=t(13),s=t.n(n),r=(t(96),t(97),t(9)),i=t(8),l=t(142),o=t(143),d=t(89),u=t(2),j=function(e){var a;return Object(u.jsxs)("div",{className:"container mt-5 mb-3",children:[Object(u.jsxs)("div",{className:"ta-center mb-5",children:[Object(u.jsx)("h3",{children:"Concentraci\xf3n horaria"}),Object(u.jsx)("p",{children:"Conoce las recomendaciones seg\xfan el \xedndice de calidad del aire"})]}),Object(u.jsxs)(l.a.Container,{fill:!0,defaultActiveKey:null!==(a=e.selected)&&void 0!==a?a:"buena",className:"recomendaciones h-100",children:[Object(u.jsxs)(o.a,{fill:!0,children:[Object(u.jsx)(o.a.Item,{children:Object(u.jsx)(d.a,{eventKey:"buena",className:"nav-buena",children:"Buena"})}),Object(u.jsx)(o.a.Item,{children:Object(u.jsx)(d.a,{eventKey:"acept",className:"nav-acept",children:"Aceptable"})}),Object(u.jsx)(o.a.Item,{children:Object(u.jsx)(d.a,{eventKey:"mala",className:"nav-mala",children:"Mala"})}),Object(u.jsx)(o.a.Item,{children:Object(u.jsx)(d.a,{eventKey:"muy",className:"nav-muy",children:"Muy Mala"})}),Object(u.jsx)(o.a.Item,{children:Object(u.jsx)(d.a,{eventKey:"ext",className:"nav-ext",children:"Extremadamente Mala"})})]}),Object(u.jsxs)(l.a.Content,{children:[Object(u.jsx)(l.a.Pane,{eventKey:"buena",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(u.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(u.jsx)("li",{children:"Sin riesgo para personas vulnerables"})]})}),Object(u.jsx)(l.a.Pane,{eventKey:"acept",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Realizar actividades al aire libre"}),Object(u.jsx)("li",{children:"Ejercitarse al aire libre"}),Object(u.jsx)("li",{children:"Personas vulnerables limitar actividades f\xedsicas"})]})}),Object(u.jsx)(l.a.Pane,{eventKey:"mala",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Limitar actividades f\xedsicas al aire libre, incrementar frecuencia de descansos, vigilar que estudiantes no presenten s\xedntomas de afecciones respiratorias."}),Object(u.jsx)("li",{children:"Limitar tiempo de exposici\xf3n"}),Object(u.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(u.jsx)("li",{children:"Considerar suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(u.jsx)("li",{children:"Se recomienda el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(u.jsx)(l.a.Pane,{eventKey:"muy",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(u.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(u.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(u.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(u.jsx)("li",{children:"Acudir al m\xe9dico en caso de s\xedntomas de afectaciones a la salud"}),Object(u.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(u.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(u.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(u.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"}),Object(u.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"})]})}),Object(u.jsx)(l.a.Pane,{eventKey:"ext",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Evitar actividades al aire libre"}),Object(u.jsx)("li",{children:"Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificaci\xf3n de aire"}),Object(u.jsx)("li",{children:"Cerrar puertas y ventanas"}),Object(u.jsx)("li",{children:"Personas vulnerables permanecer en interiores sin actividad f\xedsica"}),Object(u.jsx)("li",{children:"Acudir al m\xe9dico o solicitar servicios de emergencias en caso de s\xedntomas de afectaciones a la salud"}),Object(u.jsx)("li",{children:"Evitar fogatas y uso de combustibles s\xf3lidos como carb\xf3n o le\xf1a"}),Object(u.jsx)("li",{children:"Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificaci\xf3n NIOSH*"}),Object(u.jsx)("li",{children:"Suspender entrenamientos y partidos de ligas deportivas y actividades f\xedsicas extracurriculares"}),Object(u.jsx)("li",{children:"Suspender el uso de cigarros de cualquier tipo"}),Object(u.jsx)("li",{children:"Limitar el uso de veh\xedculos que usen combustibles f\xf3siles"})]})})]})]})]})},b=t(140),m=t(81),O=t(130),h=t(138),x=t(131),f=t(82),p=t(139),v=t(83),g=t(20),y=t(18),N=[{name:"PM25",label:"PM2.5",units:"\u03bcg/m3"},{name:"PM10",units:"\u03bcg/m3"},{name:"O3",units:"ppm"},{name:"CO",units:"ppm"},{name:"NO2",units:"ppm"},{name:"SO2",units:"ppm"}],S=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"Sinaica",label:"Sinaica",opt:"G"},{value:"AireNuevoLeon",label:"AireNuevoLeon",opt:"G"}],C=[{value:"PM25",label:"PM2.5"},{value:"PM10",label:"PM10"},{value:"O3",label:"O3"},{value:"CO",label:"CO"},{value:"NO2",label:"NO2"},{value:"SO2",label:"SO2"}],M={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},D=["Sinaica"],P="/api",k=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"AireNuevoLeon",label:"AireNuevoLeon",opt:"G"}],w=[{value:"1",label:"Tiempo real"},{value:"2",label:"12 horas"},{value:"3",label:"24 horas"},{value:"4",label:"\xdaltima semana"},{value:"5",label:"\xdaltimo mes"},{value:"6",label:"\xdaltimo a\xf1o"}],A=function(e){var a=e.onApply,t=Object(g.c)((function(e){return e})).sensorData,n=Object(c.useState)(""),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(c.useMemo)((function(){return t.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud&&e.Sistema===r.label})).map((function(e){return{value:e.Sensor_id,label:e.Zona}}))}),[t,r]),d=Object(c.useState)(C),j=Object(i.a)(d,2),N=j[0],S=j[1];Object(c.useEffect)((function(){"PurpleAir"===r.label?S([C[0]]):S(C)}),[r]);var M=Object(c.useState)(!1),D=Object(i.a)(M,2),P=D[0],A=D[1],Y=Object(c.useState)(null),E=Object(i.a)(Y,2),L=E[0],R=E[1],z=Object(c.useState)(w[0]),F=Object(i.a)(z,2),I=F[0],q=F[1],_=Object(c.useState)(C[0]),T=Object(i.a)(_,2),H=T[0],B=T[1],U=function(){return A(!1)};return Object(u.jsxs)("div",{className:"container mt-5",children:[Object(u.jsxs)(b.a,{children:[Object(u.jsx)("p",{style:{fontSize:"0.9em"},children:"*Recuerda que el sistema PurpleAir solo tiene disponible el contaminante PM2.5"}),Object(u.jsxs)(b.a.Row,{className:"mapa-filtros",children:[Object(u.jsxs)(m.a,{className:"mb-3",xs:12,lg:4,children:[Object(u.jsx)(y.a,{placeholder:"Sistema",value:r,onChange:function(e){l(e),R(null)},options:k}),Object(u.jsx)(y.a,{placeholder:"Ubicaci\xf3n",value:L,onChange:R,options:o})]}),Object(u.jsx)(m.a,{className:"mb-3",xs:6,lg:3,children:Object(u.jsx)(y.a,{isDisabled:!0,options:w,onChange:q,value:I})}),Object(u.jsx)(m.a,{xs:6,lg:3,children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{xs:10,children:Object(u.jsx)(y.a,{options:N,value:H,onChange:B})}),Object(u.jsx)(m.a,{xs:2,children:Object(u.jsx)(h.a,{placement:"top",overlay:Object(u.jsx)(x.a,{children:"Info. indicadores"}),children:Object(u.jsx)(f.a,{className:"info-btn",variant:"link",onClick:function(){return A(!0)},children:Object(u.jsx)(v.a,{color:"MediumVioletRed"})})},"top")})]})}),Object(u.jsx)(m.a,{children:Object(u.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){a({gas:H,location:L,interval:I}),R(null),q(w[0])},children:"Aplicar"})})]})]}),Object(u.jsxs)(p.a,{size:"lg",show:P,onHide:U,children:[Object(u.jsx)(p.a.Header,{closeButton:!0,children:Object(u.jsx)(p.a.Title,{children:"Indicadores"})}),Object(u.jsxs)(p.a.Body,{children:[Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"PM 10"}),"\u2003 Material Particulado menor a 10 micr\xf3metros"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Mezcla compleja de part\xedculas l\xedquidas o s\xf3lidas que provienen de fuentes naturales o de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 10 micr\xf3metros."})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"PM 2.5"}),"\u2003 Material Particulado menor a 2.5 micr\xf3metros"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Mezcla Compleja de Part\xedculas l\xedquidas o s\xf3lidas que provienen principalmente de fuentes antropog\xe9nicas, poseen un tama\xf1o aerodin\xe1mico menor a 2.5 micr\xf3metros."})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"O2"}),"\u2003 Ozono"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Gas compuesto por 3 \xe1tomos de oxigeno que se encuentra principalmente en la estratosfera, puede formarse a nivel superficial debido a condiciones de alta radiaci\xf3n y temperatura."})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"CO"}),"\u2003 Mon\xf3xido de Carbono"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Gas incoloro que se forma principalmente por la combusti\xf3n de gasolinas, le\xf1a o carb\xf3n, este compuesto, en altas concentraciones puede ser muy nocivo a la salud."})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"SO2"}),"\u2003 Di\xf3xido de Azufre"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Es un gas formado por 2 \xe1tomos de ox\xedgeno y uno de azufre, se forma principalmente por la combusti\xf3n de combustibles f\xf3siles con alto contenido de azufre."})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)("h3",{className:"mod-sub",children:[Object(u.jsx)("span",{className:"mod-ind morado",children:"NO2"}),"\u2003 Di\xf3xido de Nitr\xf3geno"]})}),Object(u.jsx)(O.a,{children:Object(u.jsx)("p",{className:"mod-desc",children:"Mol\xe9cula con 2 \xe1tomos de ox\xedgeno y uno de Nitr\xf3geno que se produce principalmente por la combusti\xf3n de combustibles f\xf3siles empleados en veh\xedculos y plantas de energ\xeda."})})]}),Object(u.jsx)(p.a.Footer,{children:Object(u.jsx)(f.a,{variant:"secondary",onClick:U,children:"Cerrar"})})]})]})},Y=t(30),E=t(28),L=(t(79),t(23)),R=t(132),z=t(133),F=t(10),I=t.n(F),q=function(e){if("number"!=typeof e)return e;var a=e.toFixed(2);return parseInt(a)===e?e:a};function _(e){var a=e.label,t=e.status,n=e.position,l=e.current,o=e.provider,d=e.locationStr,j=e.labels,b=e.lastUpdate,m=(e.map,e.shape),O=void 0===m?"round":m,h=Object(Y.a)(e,["label","status","position","current","provider","locationStr","labels","lastUpdate","map","shape"]),x=Object(c.useMemo)((function(){return document.createElement("div")}),[]),p=Object(c.useRef)(),v=Object(c.useState)(null),g=Object(i.a)(v,2),y=g[0],N=g[1],S=Object(c.useCallback)((function(e,a){s.a.render(function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"round";return Object(u.jsxs)("div",{className:"marker-wrapper",style:{zIndex:"round"===t?-1:-10},children:[Object(u.jsx)("div",{className:"marker-".concat(a," marker-base marker-shape-").concat(t)}),Object(u.jsx)("span",{className:"marker-".concat(a),style:{backgroundColor:"transparent"},children:q(e)})]})}(e,a,O),x),N(Object(E.divIcon)({html:x,className:"sensor-icon ".concat("round"===O?"":"behind"),popupAnchor:[7,0]}))}),[O]);return Object(c.useEffect)((function(){S(a,t)}),[a,t,S]),y?Object(u.jsx)(R.a,Object(r.a)(Object(r.a)({position:n,icon:y},h),{},{children:Object(u.jsxs)(z.a,{ref:p,className:"custom-popup",closeButton:function(e){return Object(u.jsx)("button",Object(r.a)(Object(r.a)({},e),{},{type:"button",class:"btn-close","aria-label":"Close"}))},children:[Object(u.jsxs)("div",{className:"px-3 py-2",children:[Object(u.jsxs)("div",{className:"rounded marker-".concat(l.status),style:{display:"flex",justifyContent:"center",padding:"0 0.1rem "},children:[l.indicator,": ",l.label," ",l.units]}),Object(u.jsxs)("div",{className:"data-label",children:[Object(u.jsx)("small",{className:"text-muted",children:"Ubicaci\xf3n"}),Object(u.jsx)("br",{}),Object(u.jsx)("data",{children:d})]}),Object(u.jsxs)("div",{className:"data-label",children:[Object(u.jsx)("small",{className:"text-muted",children:"\xdaltima actualizaci\xf3n"}),Object(u.jsx)("br",{}),Object(u.jsx)("time",{children:I()(b).format("ddd, MMMM D YYYY, h:mm:ss a")})]}),Object(u.jsx)("div",{className:"data-label",children:Object(u.jsx)("small",{className:"text-muted",children:"Tiempo Real"})}),Object(u.jsx)("div",{children:j.map((function(e,a){var t=e.label,c=e.status,n=e.value,s=e.units;return Object(u.jsxs)("div",{className:"d-flex justify-content-between rt-data-row mb-1",children:[Object(u.jsx)(L.b,{to:{pathname:"registro",search:"?gas=".concat(t)},children:t}),Object(u.jsxs)("div",{className:"d-inline-flex justify-content-between px-1 rounded marker-".concat(c),children:[Object(u.jsx)("span",{children:n}),Object(u.jsx)("span",{children:s})]})]},a)}))})]}),Object(u.jsxs)("div",{className:"py-2 px-3 border-top text-center",children:[Object(u.jsx)(f.a,{size:"sm",children:"M\xe1s informaci\xf3n"}),Object(u.jsxs)("p",{className:"lh-sm mt-2 mb-0",children:["Fuente(s): ",Object(u.jsx)("a",{target:"blank",href:o.ref,children:o.name})]})]})]})})):null}_.defaultProps={};var T=_,H=(t(116),t(134)),B=t(148);function U(e){var a=e.center,t=e.children,c=Object(Y.a)(e,["center","children"]);return Object(u.jsxs)(H.a,Object(r.a)(Object(r.a)({center:a,scrollWheelZoom:!1,style:{height:"100%",widht:"100%"}},c),{},{children:[Object(u.jsx)(B.a,{attribution:'\xa9 <a href="https://stadiamaps.com/">Stadia Maps</a>, \xa9 <a href="https://openmaptiles.org/">OpenMapTiles</a> \xa9 <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png?api_key=e4368efd-701c-4da6-8372-03f4040a622a"}),t]}))}U.defaultProps={};var K=U,G={"Aire y Salud":{PM10:[50,75,155,235],PM25:[25,45,78,147],O3:[.051,.095,.135,.175],CO:[8.75,11,13.3,15.5],SO2:[.008,.11,.165,.22],NO2:[.107,.21,.23,.25]},NOM:{PM10:[100,135,214,300],PM25:[55,75,97.4,128.8],O3:[.07,.093,.115,.137],CO:[12,13.9,15.9,18.9],SO2:[.253,.345,.435,.566],NO2:[.132,.176,.221,.289]}},V=["buena","acept","mala","muy","ext"],Z=function(e,a){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Aire y Salud",c=G[t][e],n=c.length-1;n>=0;n--)if(a>c[n])return parseInt(n)+1;return 0},Q=function e(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return new Promise((function(n,s){a().then(n).catch((function(){setTimeout((function(){if(!c)return s("Se excedi\xf3 el n\xfamero m\xe1ximo de intentos");e(a,t,c-1).then(n,s)}),t)}))}))},J=function(){return new Promise((function(e,a){fetch("".concat(P,"/sensor-summary")).then((function(e){if(200===e.status)return e.json();a()})).then((function(a){e(a)})).catch((function(e){return a(e)}))}))},W=function(){return Q(J)},X=t(87),$=Object(X.a)({name:"data",initialState:{sensorData:[],sensorDataLastUpdate:null},reducers:{setSensorData:function(e,a){Array.isArray(a.payload)&&(e.sensorData=a.payload,e.sensorDataLastUpdate=I()())}}}),ee=$.actions.setSensorData,ae=$.reducer,te=function(e){var a=e.cacheTime,t=void 0===a?60:a,n=e.useCache,s=void 0===n||n,r=Object(g.c)((function(e){return e})),l=r.sensorDataLastUpdate,o=r.sensorData,d=Object(g.b)(),u=Object(c.useState)(!0),j=Object(i.a)(u,2),b=j[0],m=j[1],O=Object(c.useState)(o),h=Object(i.a)(O,2),x=h[0],f=h[1],p=Object(c.useState)(null),v=Object(i.a)(p,2),y=v[0],N=v[1];return Object(c.useEffect)((function(){(l&&s?I()().diff(l,"minutes"):999)>t?W().then((function(e){d(ee(e)),f(e)})).catch((function(e){console.error(e),f([]),N(e)})).finally((function(){return m(!1)})):m(!1)}),[l,d,t,s]),{loading:b,data:x,error:y}},ce=t(135),ne=t(146),se={center:[25.67,-100.25],zoom:11,minZoom:10};var re=function(){var e=Object(c.useState)(N[0]),a=Object(i.a)(e,2),t=a[0],n=a[1],s=te({}),l=s.data,o=s.loading,d=s.error,b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],x=m[1],p=Object(c.useState)(0),v=Object(i.a)(p,2),g=v[0],y=v[1],S=Object(c.useCallback)((function(e){O&&O.setView(e,se.zoom,{animate:!0})}),[O]),C=Object(c.useMemo)((function(){return l.filter((function(e){return"number"===typeof e.Longitud&&"number"===typeof e.Latitud&&!D.includes(e.Sistema)})).map((function(e){var a,c=t.name,n=t.units,s="PM25"===c&&"PurpleAir"===e.Sistema?e.PM25_Promedio:e[c],r="number"===typeof s?s:"ND";return Z(c,r)>g&&y(Z(c,r)),{position:[e.Latitud,e.Longitud],current:{indicator:t.label?t.label:c,label:r,units:n,status:"ND"!==r?Z(c,r):99,ref:"#"},lastUpdate:I.a.utc(e.Dia).local(),locationStr:(null===(a=e.Zona)||void 0===a?void 0:a.length)>0?e.Zona:"ND",provider:{name:e.Sistema,ref:"PurpleAir"===e.Sistema?"https://www.purpleair.com/map?mylocation":"AireNuevoLeon"===e.Sistema?"http://aire.nl.gob.mx/":"Sinaica"===e.Sistema?"https://sinaica.inecc.gob.mx/":"#"},isPurpleAir:"PurpleAir"===e.Sistema,labels:N.map((function(a){var t=a.name,c=a.label,n=a.units,s=t;return"PM25"===t&&"PurpleAir"===e.Sistema&&(s="PM25_Promedio"),{label:c||t,units:n,value:"number"===typeof e[s]?e[s]:"ND",status:e[s]?Z(t,e[s]):99,ref:"#"}}))}}))}),[l,t]);return Object(u.jsxs)("div",{children:[Object(u.jsx)(A,{onApply:function(e){var a=e.gas,c=e.location;if(c){var s=l.find((function(e){return e.Sensor_id===c.value}));if(s&&S([s.Latitud,s.Longitud]),a){var r=N.find((function(e){return e.name===a.value}));n(null!==r&&void 0!==r?r:t)}}else alert("Selecciona una ubicaci\xf3n")}}),Object(u.jsxs)("div",{className:"my-4",style:{zIndex:0,position:"relative",width:"100%",height:"500px"},children:[d&&Object(u.jsx)("div",{className:"position-absolute w-100 end-0 p-2",style:{zIndex:100},children:Object(u.jsx)("div",{class:"alert alert-danger",role:"alert",children:"Ocurri\xf3 un error al cargar los datos."})}),o&&Object(u.jsx)("div",{className:"w-100 h-100 d-flex position-absolute",style:{zIndex:100,backgroundColor:"rgba(0,0,0,0.2)"},children:Object(u.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(u.jsx)(ce.a,{animation:"border"})})}),Object(u.jsx)("div",{className:"w-100 h-100 position-absolute p-2",style:{zIndex:99,pointerEvents:"none"},children:Object(u.jsx)("div",{className:"position-absolute end-0",children:Object(u.jsx)(h.a,{trigger:"click",placement:"left",overlay:Object(u.jsxs)(ne.a,{children:[Object(u.jsx)(ne.a.Title,{as:"h3",children:"Leyenda"}),Object(u.jsxs)(ne.a.Content,{children:[Object(u.jsxs)("div",{className:"d-flex align-items-center",children:[Object(u.jsx)("div",{style:{boxSizing:"border-box",borderRadius:"100%",width:"35px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores del estado se representan con un c\xedrculo"]}),Object(u.jsxs)("div",{className:"d-flex align-items-center",children:[Object(u.jsx)("div",{style:{boxSizing:"border-box",width:"35px",height:"20px",marginRight:"0.75rem",padding:0,border:"1px solid black"}}),"Los sensores de Purple Air se representan con un cuadrado"]})]})]}),children:Object(u.jsx)(f.a,{variant:"link",className:"pe-auto",children:"Leyenda"})})})}),Object(u.jsx)(K,Object(r.a)(Object(r.a)({whenCreated:x},se),{},{children:!o&&C.map((function(e,a){return Object(u.jsx)(T,Object(r.a)(Object(r.a)({map:O},e),{},{label:e.current.label,indicator:e.current.indicator,status:e.current.status,shape:e.isPurpleAir?"square":"round"}),a)}))}))]}),Object(u.jsx)(j,{selected:V[g]})]})},ie=t(136),le=t(137),oe=[{value:"PurpleAir",label:"PurpleAir",opt:"P"},{value:"AireNuevoLeon",label:"AireNuevoLeon/Sinaica",opt:"G"}];var de=function(e){var a=e.createQueryGraph,t=e.createQueryCal,n=e.radioValue,s=e.setRadioValue,r=e.updateMainFiltros,l=Object(g.b)(),o=Object(g.c)((function(e){return e})),d=o.sensorDataLastUpdate,j=o.sensorData,O=Object(c.useState)(null),h=Object(i.a)(O,2),x=h[0],p=h[1],v=[];Object(c.useEffect)((function(){(d?I()().diff(d,"minutes"):999)>60?W().then((function(e){l(ee(e)),p(e)})).catch((function(e){return console.error(e)})):p(j)}),[]);var N=Object(c.useState)(""),S=Object(i.a)(N,2),M=S[0],D=S[1],P=Object(c.useState)(C),k=Object(i.a)(P,2),w=k[0],A=k[1],Y=Object(c.useState)(null),E=Object(i.a)(Y,2),L=E[0],R=E[1],z=Object(c.useRef)(null),F=Object(c.useRef)(null),q=Object(c.useRef)(C[0]);return Object(c.useEffect)((function(){"PurpleAir"===M.value?A([C[0]]):A(C)}),[M]),x&&x.forEach((function(e){M.value===e.Sistema&&v.push({value:e.Sensor_id,label:e.Zona})})),Object(u.jsxs)("div",{className:"mt-5",children:[Object(u.jsxs)("div",{className:"ta-center mb-5",children:[Object(u.jsx)("h2",{children:"Registro Hist\xf3rico"}),Object(u.jsx)("p",{children:"Consulta los datos hist\xf3ricos de la calidad del aire"})]}),Object(u.jsxs)(b.a,{children:[Object(u.jsxs)(b.a.Row,{className:"mb-3",children:[Object(u.jsx)(m.a,{xs:6,children:Object(u.jsx)(y.a,{options:oe,placeholder:"Sistema",onChange:function(e){R(null),F.current=null,z.current=e,D(e)}})}),Object(u.jsx)(m.a,{xs:6,children:Object(u.jsx)(y.a,{options:v,value:L,placeholder:"Ubicaci\xf3n",onChange:function(e){R(e),F.current=e}})})]}),Object(u.jsxs)(b.a.Row,{children:[Object(u.jsx)(m.a,{children:Object(u.jsx)(ie.a,{toggle:!0,children:[{name:"Grafica",value:"1"},{name:"Calendario",value:"2"}].map((function(e,a){return Object(u.jsx)(le.a,{className:"toggle-vista",type:"radio",variant:"light",name:"radio",value:e.value,checked:n===e.value,onChange:function(e){return s(e.currentTarget.value)},children:e.name},a)}))})}),Object(u.jsx)(m.a,{className:"mb-3",children:Object(u.jsx)(y.a,{options:w,placeholder:"Indicador",onChange:function(e){q.current=e},defaultValue:C[0]})}),Object(u.jsx)(m.a,{xs:12,sm:3,className:"mb-3",children:Object(u.jsx)(f.a,{className:"btn-aplicar",variant:"primary",block:!0,onClick:function(){return r(F.current,q.current,z.current),void("1"==n?a():t())},children:"Aplicar"})})]})]}),Object(u.jsx)("hr",{className:"mt-2 mb-4"})]})},ue=t(63),je=t.n(ue);var be=function(e){var a=e.setDesde,t=e.setHasta,n=e.data,s=e.layout,r=e.summary;return Object(c.useEffect)((function(){a(null),t(null)}),[]),Object(u.jsxs)("div",{children:[Object(u.jsx)(b.a,{className:"mt-4 mb-4",children:Object(u.jsxs)(b.a.Row,{className:"d-flex justify-content-evenly",children:[Object(u.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{xs:2,children:Object(u.jsxs)(b.a.Label,{className:"col-form-label",children:["Desde:"," "]})}),Object(u.jsx)(m.a,{xs:5,children:Object(u.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return a(I()(e.target.value))}})}),Object(u.jsx)(m.a,{xs:5,children:Object(u.jsx)(b.a.Control,{type:"time"})})]})}),Object(u.jsx)(m.a,{xs:12,lg:5,className:"mb-3",children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{xs:2,children:Object(u.jsxs)(b.a.Label,{className:"col-form-label",children:["Hasta:"," "]})}),Object(u.jsx)(m.a,{xs:5,children:Object(u.jsx)(b.a.Control,{type:"date",required:!0,onChange:function(e){return t(I()(e.target.value))}})}),Object(u.jsx)(m.a,{xs:5,children:Object(u.jsx)(b.a.Control,{type:"time"})})]})})]})}),Object(u.jsxs)(O.a,{className:"mb-5",children:[Object(u.jsxs)(m.a,{sm:12,lg:4,xl:3,children:[Object(u.jsx)(O.a,{children:Object(u.jsx)(f.a,{className:"btn btn-light mb-4",block:!0,children:"Descargar datos"})}),Object(u.jsxs)(O.a,{className:"d-flex justify-content-around",children:[Object(u.jsx)(m.a,{sm:5,lg:12,children:Object(u.jsxs)(O.a,{className:"dato-calculado",children:[Object(u.jsxs)(m.a,{sm:5,children:[Object(u.jsx)("p",{className:"tipo",children:"M\xe1ximo"}),Object(u.jsx)("p",{className:"desc",children:r&&(null===r||void 0===r?void 0:r.max.date)?"Registrado el ".concat(null===r||void 0===r?void 0:r.max.date):""})]}),Object(u.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(u.jsx)("p",{className:"numero muymala",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.max.value)?r.max.value.toFixed(2):"-"})})]})}),Object(u.jsx)(m.a,{sm:5,lg:12,children:Object(u.jsxs)(O.a,{className:"dato-calculado",children:[Object(u.jsxs)(m.a,{sm:5,children:[Object(u.jsx)("p",{className:"tipo",children:"M\xednimo"}),Object(u.jsx)("p",{className:"desc",children:r&&(null===r||void 0===r?void 0:r.min.date)?"Registrado el ".concat(null===r||void 0===r?void 0:r.min.date):""})]}),Object(u.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(u.jsx)("p",{className:"numero acept",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.min.value)?r.min.value.toFixed(2):"-"})})]})}),Object(u.jsx)(m.a,{sm:5,lg:12,children:Object(u.jsxs)(O.a,{className:"dato-calculado",children:[Object(u.jsx)(m.a,{sm:5,children:Object(u.jsx)("p",{className:"tipo",children:"Promedio"})}),Object(u.jsx)(m.a,{sm:7,className:"d-flex align-items-center justify-content-end",children:Object(u.jsx)("p",{className:"numero mala",children:r&&"number"===typeof(null===r||void 0===r?void 0:r.avg.value)?r.avg.value.toFixed(2):"-"})})]})})]})]}),Object(u.jsx)(m.a,{sm:12,lg:8,xl:9,children:Object(u.jsx)("div",{className:"grafico mb-4",children:Object(u.jsx)(je.a,{data:n,layout:s})})})]})]})},me=(t(120),t(144)),Oe=t(147);var he=t(141),xe=function(e){var a=e.value,t=e.onChange,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],l=s[1];function o(e){return e.isAfter(new Date,"day")}function d(e){return function(e){return a.isSame(e,"day")}(e)?"selected":function(e){return e.isSame(new Date,"day")}(e)?"today":o(e)?"after":function(e){return e.isSame(a,"month")}(e)?"":"month"}function j(){return a.clone().subtract(1,"month")}function b(){return a.clone().endOf("month").add(1,"day")}function h(){return a.isSame(new Date,"month")}function x(){return a.isSame(new Date("01-01-2018"),"month")}return Object(c.useEffect)((function(){l(function(e){for(var a=e.clone().startOf("month").startOf("isoWeek"),t=e.clone().endOf("month").endOf("isoWeek").subtract(1,"day"),c=a.clone().subtract(2,"day"),n=[];c.isBefore(t,"day");)n.push(Array(7).fill(0).map((function(){return c.add(1,"day").clone()})));return n}(a))}),[a]),Object(u.jsxs)("div",{className:"calendar mt-5",children:[Object(u.jsx)("div",{className:"cal-header",children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{sm:3,className:"previous",onClick:function(){return!x()&&t(j)},children:x()?null:String.fromCharCode(171)}),Object(u.jsxs)(m.a,{sm:6,className:"current",children:[a.format("MMM"),", ",a.format("YYYY")]}),Object(u.jsx)(m.a,{sm:3,className:"next",onClick:function(){return!h()&&t(b)},children:h()?null:String.fromCharCode(187)})]})}),Object(u.jsxs)("div",{className:"body",children:[Object(u.jsx)("div",{className:"day-names",children:["D","L","M","M","J","V","S"].map((function(e,a){return Object(u.jsx)("div",{className:"weekday",children:e},a)}))}),r.map((function(e,a){return Object(u.jsx)("div",{children:e.map((function(e,a){return Object(u.jsx)("div",{className:"day",onClick:function(){return!o(e)&&t(e)},children:Object(u.jsx)("div",{className:d(e),children:e.format("D")},Object(he.a)())})}))},a)}))]})]})},fe=t(50);t(69);I.a.locale("es");var pe={PM25:"\xb5g/m3",PM10:"\xb5g/m3",CO:"ppm",O3:"ppm",NO2:"ppm",SO2:"ppm"},ve=[{value:"1",label:"enero"},{value:"2",label:"febrero"},{value:"3",label:"marzo"},{value:"4",label:"abril"},{value:"5",label:"mayo"},{value:"6",label:"junio"},{value:"7",label:"julio"},{value:"8",label:"agosto"},{value:"9",label:"septiembre"},{value:"10",label:"octubre"},{value:"11",label:"noviembre"},{value:"12",label:"diciembre"}],ge=[{value:"2018",label:"2018"},{value:"2019",label:"2019"},{value:"2020",label:"2020"},{value:"2021",label:"2021"}];var ye=function(e){var a=e.q,t=e.create,n=e.data,s=e.indi,r=e.setDesde,l=e.setHasta,o=e.downloadFile;function d(e){switch(Z(s,e)){case 0:return"bueno";case 1:return"acept";case 2:return"mala";case 3:return"muymala";case 4:return"extmala";default:return"no-data"}}var j=Object(c.useState)(I()()),b=Object(i.a)(j,2),h=b[0],x=b[1];Object(c.useEffect)((function(){r(h),l(h)}),[]);var p=Object(c.useState)((new Date).getMonth()+1),v=Object(i.a)(p,2),g=v[0],N=v[1],S=Object(c.useState)(ge[ge.length-1].value),C=Object(i.a)(S,2),M=C[0],D=C[1];Object(c.useEffect)((function(){r(h),l(h),(n||a)&&t(h,h)}),[h]),Object(c.useEffect)((function(){var e=new Date("".concat(g,"/").concat(h.clone().format("DD"),"/").concat(M));x(I()(e))}),[g,M]);var P=[],k=[],w=0,A=0;if(n&&0!==n.length){for(;A<12&&w<n.length;){for(var Y="T"+A.toString().padStart(2,0)+":",E=[],L=w;w<n.length&&n[w].dia.includes(Y);)E.push(Object(u.jsxs)("p",{children:[Object(u.jsx)(fe.b,{className:d(n[w][s])}),n[w].zona,": ",n[w][s]?" ".concat(n[w][s]," ").concat(pe[s]):" No hay registro"]})),w++;P.push(Object(u.jsx)(me.a,{id:n[L].registros_id,children:Object(u.jsxs)(Oe.a,{children:[Object(u.jsx)(Oe.a.Header,{children:Object(u.jsxs)(me.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[L].registros_id,children:[Object(u.jsx)(fe.a,{color:"lightgray"})," ",A.toString().padStart(2,0),":00"]})}),Object(u.jsx)(me.a.Collapse,{eventKey:n[L].registros_id,children:Object(u.jsx)(Oe.a.Body,{children:E})})]})},n[L].registros_id)),A++}for(;A<24&&w<n.length;){for(var R="T"+A.toString().padStart(2,0),z=[],F=w;w<n.length&&n[w].dia.includes(R);)z.push(Object(u.jsxs)("p",{children:[Object(u.jsx)(fe.b,{className:d(n[w][s])})," ",n[w].zona,": ",n[w][s]?"".concat(n[w][s]," ").concat(pe[s]):"No hay registro"]})),w++;k.push(Object(u.jsx)(me.a,{id:n[F].registros_id,children:Object(u.jsxs)(Oe.a,{children:[Object(u.jsx)(Oe.a.Header,{children:Object(u.jsxs)(me.a.Toggle,{as:f.a,className:"hora",variant:"link",eventKey:n[F].registros_id,children:[Object(u.jsx)(fe.a,{color:"lightgray"})," ",A.toString().padStart(2,0),":00"]})}),Object(u.jsx)(me.a.Collapse,{eventKey:n[F].registros_id,children:Object(u.jsx)(Oe.a.Body,{children:z})})]})},n[F].registros_id)),A++}}else P.push(Object(u.jsx)("p",{children:"No hay datos para este d\xeda"}));return Object(u.jsx)("div",{className:"container mb-10",children:Object(u.jsxs)(O.a,{className:"mb-5",children:[Object(u.jsx)(m.a,{sm:12,lg:6,children:Object(u.jsxs)("div",{children:[Object(u.jsx)(f.a,{className:"btn btn-light mb-4 mt-4",block:!0,onClick:o,children:"Descargar datos del mes"}),Object(u.jsxs)(O.a,{className:"mb-4",children:[Object(u.jsx)(m.a,{sm:6,children:Object(u.jsx)(y.a,{options:ve,placeholder:"Mes",onChange:function(e){return N(e.value)},defaultValue:ve[(new Date).getMonth()]})}),Object(u.jsx)(m.a,{sm:6,children:Object(u.jsx)(y.a,{options:ge,placeholder:"A\xf1o",onChange:function(e){return D(e.value)},defaultValue:ge[ge.length-1]})})]}),Object(u.jsxs)("div",{className:"detalles",children:[Object(u.jsxs)("h4",{children:[h&&h.format("DD/MM/YYYY")," Detalle por hora"]}),Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{sm:6,children:P}),Object(u.jsx)(m.a,{sm:6,children:k})]})]})]})}),Object(u.jsx)(m.a,{sm:12,lg:6,className:"d-flex align-items-start justify-content-center",children:Object(u.jsx)(xe,{value:h,onChange:x})})]})})},Ne=t(84),Se=t.n(Ne);var Ce=function(e){var a=e.q,t=e.fecha,n=e.ubic,s=e.ind,l=Object(c.useState)(null),o=Object(i.a)(l,2),d=o[0],j=o[1],b=Object(c.useState)(null),m=Object(i.a)(b,2),O=m[0],h=m[1],x=Object(c.useRef)(null),f=Object(c.useRef)(d),p="";Object(c.useEffect)((function(){t&&(d&&d.isSame(t.clone().startOf("month"))||(f.current=d,j(t.clone().startOf("month"))))}),[t]),Object(c.useEffect)((function(){var e="";a&&(e=a.substring(0,a.indexOf("&inicio"))),x.current&&x.current===e&&f.current==d||(x.current!==a&&(x.current=e),f.current!=d&&(f.current=d),n&&d&&(p="ubic=",p+=n.value,p+="&ind="+s+"&inicio="+d.clone().format("YYYY-MM-DD")+"&fin="+d.clone().endOf("month").format("YYYY-MM-DD"),console.log("Query HM: "+p),fetch("".concat(P,"/prom-data?").concat(p)).then((function(e){return e.json()})).then((function(e){return h(e)})).catch((function(e){return console.log(e)}))))}),[a,d]);var v={},g=[];if(a&&O&&O.length>0){for(var y=0,N={},S=O[y].zona,C=new Date(O[y].fecha.replace(/-/g,"/").replace(/T.+/,"")),D=1,k={name:S,data:[]};C.getDate()!==D;)N.x=D,N.y=-1,k.data.push(Object(r.a)({},N)),D++;for(;y<O.length&&O[y].zona===S;)N.x=D,D==parseInt(O[y].fecha.substring(8))?(""!==O[y].prom?(N.y=O[y].prom,N.fecha=O[y].fecha):N.y=-1,y++):N.y=-1,k.data.push(Object(r.a)({},N)),D++;g.push(Object(r.a)({},k)),v={chart:{type:"heatmap",toolbar:{show:!1}},plotOptions:{heatmap:{enableShades:!1,radius:1,useFillColorAsStroke:!1,colorScale:{ranges:[{from:-2,to:0,name:"No data",color:"#D3D3D3"},{from:0,to:G["Aire y Salud"][s][0],name:"Buena",color:"#00E400"},{from:G["Aire y Salud"][s][0],to:G["Aire y Salud"][s][1],name:"Aceptable",color:"#FFFF00"},{from:G["Aire y Salud"][s][1],to:G["Aire y Salud"][s][2],name:"Mala",color:"#FF7E00"},{from:G["Aire y Salud"][s][2],to:G["Aire y Salud"][s][3],name:"Muy mala",color:"#FF0000"},{from:G["Aire y Salud"][s][3],to:1.5*G["Aire y Salud"][s][3],name:"Extremadamente mala",color:"#8F3F97"}]}}},dataLabels:{enabled:!1},stroke:{width:1},xaxis:{position:"bottom"},legend:{position:"top",showForSingleSeries:!0},tooltip:{custom:function(e){var a=e.series,t=e.seriesIndex,c=e.dataPointIndex,n=e.w;return-1!==a[t][c]?'<div class="arrow_box hmTooltip"><p>'+n.globals.initialSeries[t].data[c].fecha+"</p><p><b>"+a[t][c].toFixed(4)+" "+M[s]+"</b></p></div>":'<div style="display:none;">'}}}}return Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{className:"mb-5",children:"Promedios diarios del mes"}),a&&Object(u.jsx)(Se.a,{options:v,series:g,type:"heatmap",height:100*g.length})]})};I.a.locale("es");var Me=function(){var e=Object(c.useState)(null),a=Object(i.a)(e,2),t=a[0],n=a[1],s=Object(c.useState)(null),l=Object(i.a)(s,2),o=l[0],d=l[1],j=Object(c.useState)("1"),b=Object(i.a)(j,2),m=b[0],O=b[1],h=Object(c.useState)(null),x=Object(i.a)(h,2),f=x[0],v=x[1],g=Object(c.useState)(!1),y=Object(i.a)(g,2),N=y[0],S=y[1],C=Object(c.useState)(!1),M=Object(i.a)(C,2),D=M[0],k=M[1],w=Object(c.useState)(null),A=Object(i.a)(w,2),Y=A[0],E=A[1],L=Object(c.useState)(null),R=Object(i.a)(L,2),z=R[0],F=R[1],q=Object(c.useRef)({value:"PM25"}),_=Object(c.useRef)(null),T=Object(c.useRef)(null);function H(e,a){if(_.current){e&&a||(e=Y,a=z);var t="ubic=";t+=_.current.value,t+="&ind="+q.current.value+"&inicio="+e.format("YYYY-MM-DD")+"&fin="+a.format("YYYY-MM-DD"),v(t)}else alert("Selecciona una ubicaci\xf3n.")}function B(){if(f){var e="ubic=";_.current.forEach((function(a){e+=a.value+","})),e=e.slice(0,-1),e+="2"===m?"&ind="+q.current.value+"&inicio="+Y.startOf("month").format("YYYY-MM-DD")+"&fin="+z.endOf("month").format("YYYY-MM-DD"):"&ind="+q.current.value+"&inicio="+Y.format("YYYY-MM-DD")+"&fin="+z.format("YYYY-MM-DD"),fetch("".concat(P,"/download-data?").concat(e)).then((function(e){return e.blob()})).then((function(e){var a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download="data.csv";t.addEventListener("click",(function e(){setTimeout((function(){URL.revokeObjectURL(a),t.removeEventListener("click",e)}),150)}),!1),t.click()}))}}return Object(c.useEffect)((function(){f&&("1"===m?fetch("".concat(P,"/get-graph-opt?").concat(f)).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&k(!0);var a=[];e.plot.data&&e.plot.data[0].x.forEach((function(e){var t=I.a.duration("05:00:00");e=I()(e).subtract(t).format(),a.push(e.split("-05:00")[0])})),e.plot.data[0].x=a,n(e.plot),d(e.summary),S(!1)})):fetch("".concat(P,"/datos-fecha?").concat(f)).then((function(e){return e.json()})).then((function(e){return n(e)})))}),[f]),Object(c.useEffect)((function(){n(null)}),[m]),Object(u.jsxs)("div",{className:"container mb-10",children:[Object(u.jsxs)(p.a,{show:D,onHide:function(){return k(!1)},"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(u.jsx)(p.a.Header,{closeButton:!0,children:Object(u.jsx)("h5",{children:"Datos no encontrados"})}),Object(u.jsx)(p.a.Body,{children:Object(u.jsx)("p",{children:"Revise los parametros e intente de nuevo."})})]}),Object(u.jsx)(de,{createQueryGraph:function(){if(_.current)if(Y&&z){S(!0);var e="location=".concat(_.current.label,"&gas=").concat(q.current.value,"&system=").concat(T.current.opt,"&start_date=").concat(I.a.utc(Y).format("MM/DD/YYYY"),"&end_date=").concat(I.a.utc(z).format("MM/DD/YYYY"));v(e)}else alert("Selecciona las fechas.");else alert("Selecciona una ubicaci\xf3n.")},createQueryCal:H,radioValue:m,setRadioValue:O,updateMainFiltros:function(e,a,t){T.current=t,_.current=e,q.current=a}}),Object(u.jsx)("div",{className:"text-center",children:Object(u.jsx)("img",{src:"loading.gif",alt:"Cargando...",className:"loading",style:N?{}:{display:"none"}})}),"1"===m&&Object(u.jsx)(be,Object(r.a)({setDesde:E,setHasta:F,downloadFile:B,summary:o},t)),"2"===m&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(ye,{q:f,create:H,data:t,indi:q.current.value,setDesde:E,setHasta:F,downloadFile:B}),Object(u.jsx)(Ce,{q:f,fecha:Y,ubic:_.current,ind:q.current.value})]})]})},De=t(88),Pe=function(e){var a=Object(c.useRef)(e.id),t=e.sensores,n=Object(c.useState)("PurpleAir"),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(c.useState)(C),d=Object(i.a)(o,2),j=d[0],h=d[1],x=Object(c.useState)(null),f=Object(i.a)(x,2),p=f[0],v=f[1],g=Object(c.useRef)(t[0].zona?t[0].zona:null),N=Object(c.useRef)(C[0].value),M=Object(c.useRef)(null),D=Object(c.useRef)(null);Object(c.useEffect)((function(){h("PurpleAir"===r?[C[0]]:C)}),[r]);var P=Object(c.useMemo)((function(){return t.filter((function(e){return e.sistema===r})).map((function(e){return{value:e.sensor_id,label:e.zona}}))}),[t,r]);function k(){var t={ubic:g.current,ind:N.current,desde:M.current,hasta:D.current};e.modifyData(t,a.current)}return Object(u.jsx)(m.a,{sm:6,children:Object(u.jsx)("div",{className:"compara-filtros mt-2 mb-4",id:"filtro-"+a.current,children:Object(u.jsxs)(b.a,{children:[Object(u.jsx)(b.a.Group,{as:O.a,children:Object(u.jsx)(m.a,{sm:12,children:Object(u.jsxs)(O.a,{children:[Object(u.jsxs)(m.a,{sm:6,children:[Object(u.jsx)(y.a,{options:S,placeholder:"Sistema",className:"mb-2",onChange:function(e){l(e.value),v(null),g.current=null,k()}}),Object(u.jsx)(y.a,{options:P,value:p,placeholder:"Ubicaci\xf3n",className:"mb-2",onChange:function(e){v(e),g.current=e,k()}})]}),Object(u.jsx)(m.a,{sm:6,children:Object(u.jsx)(y.a,{options:j,defaultValue:C[0],onChange:function(e){N.current=e.value,k()}})})]})})}),Object(u.jsx)(b.a.Group,{as:O.a,children:Object(u.jsx)(m.a,{sm:12,children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{sm:6,children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{sm:3,children:Object(u.jsx)("p",{children:"Desde:"})}),Object(u.jsx)(m.a,{sm:9,children:Object(u.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){M.current=e.target.value,k()}})})]})}),Object(u.jsx)(m.a,{sm:6,children:Object(u.jsxs)(O.a,{children:[Object(u.jsx)(m.a,{sm:3,children:Object(u.jsx)("p",{children:"Hasta:"})}),Object(u.jsx)(m.a,{sm:9,children:Object(u.jsx)(b.a.Control,{className:"cf-input",type:"date",onChange:function(e){D.current=e.target.value,k()}})})]})})]})})})]})})})};var ke=function(){var e=Object(g.b)(),a=Object(g.c)((function(e){return e})),t=a.sensorDataLastUpdate,n=a.sensorData,s=Object(c.useState)(null),l=Object(i.a)(s,2),o=l[0],d=l[1],j=[];Object(c.useEffect)((function(){(t?I()().diff(t,"minutes"):999)>60?W().then((function(a){e(ee(a)),d(a)})).catch((function(e){return console.error(e)})):d(n)}),[]),o&&o.forEach((function(e){j.push({sensor_id:e.Sensor_id,zona:e.Zona,sistema:e.Sistema})}));var b=Object(c.useRef)(-1),h=Object(c.useState)([]),x=Object(i.a)(h,2),p=x[0],v=x[1],y=Object(c.useRef)([]),N=Object(c.useState)(null),S=Object(i.a)(N,2),C=S[0],M=S[1],D=Object(c.useState)(!1),k=Object(i.a)(D,2),w=k[0],A=k[1];function Y(e,a){y.current[a]=e}Object(c.useEffect)((function(){!function(){var e=[];if(C){for(var a=function(a){console.log(y.current[a].ubic.value),console.log(j);var t=j.find((function(e){return e.sensor_id===y.current[a].ubic.value})).zona,c="PM25"==y.current[a].ind?"PM2.5":y.current[a].ind;console.log(t),C[a].name="".concat(t," (").concat(c,")"),C[a].type="scatter",C[a].mode="lines",C[a].marker={color:q[a]},C[a].text=C[a].dia.map((function(e){return I.a.utc(new Date(e)).local()})),C[a].hovertemplate="<i>Medida</i>: %{y:.4f}<br><b>%{text}</b>",e.push(C[a])},t=0;t<C.length;t++)a(t);F(e)}}()}),[C]);var E={title:{text:"Compara datos"},showlegend:!0,hovermode:"closest",width:1e3,height:700},L=Object(c.useState)([]),R=Object(i.a)(L,2),z=R[0],F=R[1],q=["red","green","blue","orange"];return Object(u.jsxs)("div",{className:"container mt-5",children:[Object(u.jsxs)("div",{className:"ta-center mb-5",children:[Object(u.jsx)("h2",{children:"Compara datos"}),Object(u.jsx)("p",{children:"Compara la calidad del aire en diferente lugar y tiempo"})]}),Object(u.jsx)("hr",{className:"mb-4"}),Object(u.jsx)(O.a,{className:"mt-2 mb-1 d-flex justify-content-center",id:"filtros",children:p}),Object(u.jsx)(O.a,{className:"d-flex justify-content-end",children:Object(u.jsxs)(m.a,{sm:6,className:"d-flex justify-content-between",children:[Object(u.jsx)(f.a,{onClick:function(){b.current<3&&(b.current=b.current+1,v([].concat(Object(De.a)(p),[Object(u.jsx)(Pe,{id:b.current,modifyData:Y,sensores:j})])))},children:"Agregar un filtro"}),Object(u.jsx)(f.a,{onClick:function(){return function(){if(-1!=b.current){var e=document.getElementById("filtro-".concat(b.current)).parentNode;e.parentNode.removeChild(e),b.current=b.current-1}}()},children:"Eliminar un filtro"}),Object(u.jsx)(f.a,{onClick:function(){return function(){if(!(b.current<0)){for(var e="",a="",t="",c="",n=0;n<=b.current;n++){if(!(y.current[n]&&y.current[n].desde&&y.current[n].hasta))return void alert("Selecciona las fechas");e+=y.current[n].ubic.value+",",a+=y.current[n].ind+",",t+=y.current[n].desde+",",c+=y.current[n].hasta+","}e=e.slice(0,-1),a=a.slice(0,-1),t=t.slice(0,-1),c=c.slice(0,-1);var s="ubic=".concat(e,"&ind=").concat(a,"&inicio=").concat(t,"&fin=").concat(c);A(!0),fetch("".concat(P,"/compare?").concat(s)).then((function(e){return e.json()})).then((function(e){A(!1),M(e)}))}}()},children:"Generar gr\xe1fica"})]})}),Object(u.jsx)(O.a,{children:Object(u.jsxs)(m.a,{sm:12,children:[Object(u.jsx)("div",{className:"text-center",children:Object(u.jsx)("img",{src:"loading.gif",alt:"Cargando...",className:"loading",style:w?{}:{display:"none"}})}),Object(u.jsx)("div",{class:"grafico-compara mt-5",children:Object(u.jsx)(je.a,{data:z,layout:C?Object(r.a)(Object(r.a)({},E),{},{shapes:[{type:"rect",xref:"paper",x0:0,y0:0,x1:1,y1:50,fillcolor:"rgb(0, 228, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:50,x1:1,y1:75,fillcolor:"rgb(255, 255, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:75,x1:1,y1:155,fillcolor:"rgb(255, 126, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:155,x1:1,y1:235,fillcolor:"rgb(255, 0, 0)",opacity:.3,line:{width:0}},{type:"rect",xref:"paper",x0:0,y0:235,x1:1,y1:255,fillcolor:"rgb(143, 63, 151)",opacity:.3,line:{width:0}}]}):Object(r.a)({},E)})})]})})]})},we=t(12),Ae=t(145),Ye=function(){var e=Object(c.useState)(!1),a=Object(i.a)(e,2),t=a[0],n=a[1];return Object(u.jsxs)(Ae.a,{variant:"dark",expand:"lg",expanded:t,children:[Object(u.jsx)(Ae.a.Brand,{children:Object(u.jsx)(L.c,{to:"/",children:Object(u.jsx)("img",{src:"/logo.jpg",width:"40",height:"40",className:"d-inline-block align-top",alt:"React Bootstrap logo"})})}),Object(u.jsx)(Ae.a.Text,{children:Object(u.jsx)("h1",{className:"white h1-nav mb-0",children:"Comit\xe9 Ecol\xf3gico Integral (Beta)"})}),Object(u.jsx)(Ae.a.Toggle,{"aria-controls":"basic-navbar-nav",onClick:function(){return n(!t&&"expanded")}}),Object(u.jsx)(Ae.a.Collapse,{id:"basic-navbar-nav",children:Object(u.jsxs)(o.a,{className:"ml-auto",children:[Object(u.jsx)(L.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",exact:!0,to:"/",children:"Mapa"}),Object(u.jsx)(L.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/registro",children:"Registro hist\xf3rico"}),Object(u.jsx)(L.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/compara",children:"Compara datos"}),Object(u.jsx)(L.c,{onClick:function(){return n(!1)},activeClassName:"nav-active",className:"menu-link",to:"/",children:"Acerca de"})]})})]})},Ee=function(){return Object(u.jsx)("footer",{children:Object(u.jsx)("div",{className:"container",children:Object(u.jsx)("div",{className:"row",children:Object(u.jsxs)("div",{className:"col-auto py-3",children:[Object(u.jsxs)("p",{className:"mb-1 mt-2",children:["Los datos oficiales provienen de"," ",Object(u.jsx)("a",{className:"text-white",href:"https://sinaica.inecc.gob.mx/",children:"Sinaica"})," ","y de ",Object(u.jsx)("a",{className:"text-white",href:"http://aire.nl.gob.mx/",children:"Sima"})]}),Object(u.jsx)("p",{className:"mb-1",children:"Patrocinado por Natuuramika\xae 2021"}),Object(u.jsx)("p",{children:"Proyecto Solidario TEC de Monterrey"})]})})})})};var Le=function(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(L.a,{children:[Object(u.jsx)(Ye,{}),Object(u.jsxs)(we.c,{children:[Object(u.jsx)(we.a,{exact:!0,path:"/",component:re}),Object(u.jsx)(we.a,{exact:!0,path:"/registro",component:Me}),Object(u.jsx)(we.a,{exact:!0,path:"/compara",component:ke})]}),Object(u.jsx)(Ee,{})]})})},Re=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,149)).then((function(a){var t=a.getCLS,c=a.getFID,n=a.getFCP,s=a.getLCP,r=a.getTTFB;t(e),c(e),n(e),s(e),r(e)}))},ze=t(17),Fe=t(75),Ie=t(85),qe=t.n(Ie),_e=Object(Fe.a)({key:"root",storage:qe.a},ae),Te=t(86),He=function(){var e=Object(ze.e)(_e);return{store:e,persistor:Object(Fe.b)(e)}}(),Be=He.store,Ue=He.persistor;s.a.render(Object(u.jsx)(g.a,{store:Be,children:Object(u.jsx)(Te.a,{loading:null,persistor:Ue,children:Object(u.jsx)(L.a,{children:Object(u.jsx)(Le,{})})})}),document.getElementById("root")),Re()},96:function(e,a,t){},97:function(e,a,t){}},[[124,1,2]]]);
//# sourceMappingURL=main.3e77e4dc.chunk.js.map