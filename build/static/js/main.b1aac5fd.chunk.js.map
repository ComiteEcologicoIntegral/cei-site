{"version":3,"sources":["components/Recomendaciones.js","constants.js","components/MapaFiltros.js","components/Marcador.js","components/WrapperMapa.js","handlers/statusCriteria.js","handlers/data.js","redux/reducers.js","hooks/useSensorData.js","Mapa.js","components/RHFiltros.js","components/Grafica.js","components/DatePicker.js","components/buildCalendar.js","components/Calendario.js","components/HeatMap.js","Registro.js","components/ComparaFiltros.js","Compara.js","components/Header.js","components/Footer.js","App.js","reportWebVitals.js","redux/config.js","index.js"],"names":["Recomendaciones","props","className","Tab","Container","fill","defaultActiveKey","selected","Nav","Item","NavLink","eventKey","Content","Pane","gases","name","label","units","systemOptions","value","opt","indicadores","unidad","PM25","PM10","CO","O3","NO2","SO2","idBlacklist","idBlacklistpriv","mapBlacklist","apiUrl","process","intervalos","MapaFiltros","onApply","sensorData","useSelector","state","useState","systemChosen","setSystemChosen","locationOptions","useMemo","filter","sensor","Longitud","Latitud","Sistema","includes","Sensor_id","map","record","Zona","indOptions","setIndOptions","useEffect","show","setShow","location","setLocation","interval","setInterval_","gas","setGas","handleClose","Form","style","fontSize","Row","Col","xs","lg","placeholder","onChange","options","isDisabled","OverlayTrigger","placement","overlay","Tooltip","Button","variant","onClick","color","block","Modal","size","onHide","Header","closeButton","Title","Body","Footer","showLabel","fixed","toFixed","parseInt","Marcador","ICAR","status","position","current","provider","locationStr","labels","lastUpdate","shape","marker","document","createElement","popupRef","useRef","icon","setIcon","updateMarker","useCallback","label_","status_","ReactDOM","render","zIndex","backgroundColor","renderMarker","divIcon","html","popupAnchor","Marker","Popup","ref","type","class","aria-label","display","justifyContent","padding","indicator","moment","format","idx","to","pathname","search","target","href","defaultProps","Wrapper","center","children","MapContainer","scrollWheelZoom","height","widht","TileLayer","attribution","url","criteria","NOM","airQualityTags","getStatus","norm","breakpoints","i","length","retry","fn","ms","retries","Promise","resolve","reject","then","catch","setTimeout","fetchSummaryDataFn","fetch","res","json","err","fetchSummaryData","dataSlice","createSlice","initialState","sensorDataLastUpdate","reducers","setSensorData","action","Array","isArray","payload","actions","useSensorData","cacheTime","useCache","dispatch","useDispatch","loading","setLoading","data","setData","error","setError","diff","console","finally","mapDefaultProps","zoom","minZoom","Mapa","currentGas","setCurrentGas","loadingSensorData","errorSensorData","setMap","airQualityIndex","setAirQualityIndex","setCenter","pos","setView","animate","markers","highestAirQualityIndex","filteredSensors","log","resultingData","gasName","gasUnits","preValue","gasStatus","utc","Dia","local","isPurpleAir","colName","fSensor","find","nGas","gas_","alert","width","role","Spinner","animation","pointerEvents","trigger","Popover","as","boxSizing","borderRadius","marginRight","border","whenCreated","markerProps","RHFiltros","createQueryGraph","createQueryCal","radioValue","setRadioValue","updateMainFiltros","sensRaw","setSensRaw","sensores","system","setSystem","sistema","ubicacion","indicador","forEach","element","push","ButtonGroup","toggle","radio","ToggleButton","checked","e","currentTarget","defaultValue","sm","Grafica","setDesde","setHasta","setDesdeHora","setHastaHora","layout","summary","Label","Control","required","event","xl","max","date","min","avg","porcentajes","arribaLimite","buenos","nulos","config","responsive","DatePicker","calendar","setCalendar","afterToday","day","isAfter","Date","dayStyles","isSame","isSelected","isToday","sameMonth","prevMonth","clone","subtract","nextMonth","endOf","add","currMonth","isFirstMonthRegistered","startDay","startOf","endDay","isBefore","buildCalendar","String","fromCharCode","d","week","w","v4","locale","meses","anios","Calendario","q","create","indi","downloadFile","colorIndice","medida","setValue","getMonth","inMes","setInMes","inAnio","setInAnio","f","dataCol1","dataCol2","index","currHour","ch","toString","padStart","info","firstIndex","Accordion","id","registros_id","Card","Toggle","Collapse","HeatMap","fecha","ubic","ind","mes","setMes","dataHM","setDataHM","queryAnt","mesAnt","queryStr","newq","substring","indexOf","response","series","dataItem","currUbic","primerDia","replace","currDia","seriesItem","getDate","x","y","chart","toolbar","plotOptions","heatmap","enableShades","radius","useFillColorAsStroke","colorScale","ranges","from","dataLabels","enabled","stroke","xaxis","legend","showForSingleSeries","tooltip","custom","seriesIndex","dataPointIndex","globals","initialSeries","Registro","summaryData","setSummaryData","setQ","noData","setNoData","desde","hasta","desdeHora","hastaHora","syst","h","slice","blob","URL","createObjectURL","a","download","addEventListener","clickHandler","revokeObjectURL","removeEventListener","click","hasOwnProperty","fechasArray","plot","time","duration","split","aria-labelledby","centered","u","s","src","alt","ComparaFiltros","zona","sensorOptions","sensor_id","updateData","formData","modifyData","Group","Compara","numFiltros","filters","setFilters","filterData","graph","setLimiteOMS","mode","colors","text","dia","hovertemplate","dataPromMovil","colors2","moving_average","dataICAR","colors3","setGraphData","createGraph","limiteOMS","graphLayout","title","showlegend","hovermode","graphData","filtroDiv","getElementById","parentNode","removeChild","deleteFiltro","ubicaciones","fechas_inicio","fechas_fin","query","queryData","shapes","min1","max1","min2","max2","min3","max3","min4","max4","min5","max5","xref","x0","y0","x1","y1","fillcolor","opacity","line","dash","getShapes","annotations","xanchor","yanchor","showarrow","font","family","bgcolor","expanded","setExpanded","Navbar","expand","Brand","Text","aria-controls","activeClassName","exact","App","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","persistedReducer","persistReducer","key","storage","rootReducer","store","createStore","persistor","persistStore","reduxConfig"],"mappings":"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","file":"static/js/main.b1aac5fd.chunk.js","sourcesContent":["import { Nav, NavLink, Tab } from 'react-bootstrap'\r\n\r\nconst Recomendaciones = (props) => {\r\n    return (\r\n        <div className=\"container mt-5 mb-3\">\r\n            <div className=\"ta-center mb-5\">\r\n                <h3>Concentración horaria</h3>\r\n                <p>Conoce las recomendaciones según el índice de calidad del aire</p>\r\n            </div>\r\n            <Tab.Container fill defaultActiveKey={props.selected ?? \"buena\"} className=\"recomendaciones h-100\">\r\n                <Nav fill>\r\n                    <Nav.Item>\r\n                    <NavLink eventKey=\"buena\" className=\"nav-buena\">Buena</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                    <NavLink eventKey=\"acept\" className=\"nav-acept\">Aceptable</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                    <NavLink eventKey=\"mala\" className=\"nav-mala\">Mala</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                    <NavLink eventKey=\"muy\" className=\"nav-muy\">Muy Mala</NavLink>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                    <NavLink eventKey=\"ext\" className=\"nav-ext\">Extremadamente Mala</NavLink>\r\n                    </Nav.Item>\r\n                </Nav>\r\n\r\n                <Tab.Content>\r\n                    <Tab.Pane eventKey=\"buena\">\r\n                    <ul>\r\n                        <li>Realizar actividades al aire libre</li>\r\n                        <li>Ejercitarse al aire libre</li>\r\n                        <li>Sin riesgo para personas vulnerables</li>\r\n                    </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"acept\">\r\n                    <ul>\r\n                        <li>Realizar actividades al aire libre</li>\r\n                        <li>Ejercitarse al aire libre</li>\r\n                        <li>Personas vulnerables limitar actividades físicas</li>\r\n                    </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"mala\">\r\n                    <ul>\r\n                        <li>Limitar actividades físicas al aire libre, incrementar frecuencia de descansos, vigilar que estudiantes no presenten síntomas de afecciones respiratorias.</li>\r\n                        <li>Limitar tiempo de exposición</li>\r\n                        <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                        <li>Considerar suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                        <li>Se recomienda el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                    </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"muy\">\r\n                    <ul>\r\n                        <li>Evitar actividades al aire libre</li>\r\n                        <li>Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificación de aire</li>\r\n                        <li>Cerrar puertas y ventanas</li>\r\n                        <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                        <li>Acudir al médico en caso de síntomas de afectaciones a la salud</li>\r\n                        <li>Evitar fogatas y uso de combustibles sólidos como carbón o leña</li>\r\n                        <li>Suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                        <li>Suspender el uso de cigarros de cualquier tipo</li>\r\n                        <li>Limitar el uso de vehículos que usen combustibles fósiles</li>\r\n                        <li>Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                    </ul>\r\n                    </Tab.Pane>\r\n                    <Tab.Pane eventKey=\"ext\">\r\n                    <ul>\r\n                        <li>Evitar actividades al aire libre</li>\r\n                        <li>Evitar ejercitarse al aire libre o en interiores que no cuenten con sistemas de purificación de aire</li>\r\n                        <li>Cerrar puertas y ventanas</li>\r\n                        <li>Personas vulnerables permanecer en interiores sin actividad física</li>\r\n                        <li>Acudir al médico o solicitar servicios de emergencias en caso de síntomas de afectaciones a la salud</li>\r\n                        <li>Evitar fogatas y uso de combustibles sólidos como carbón o leña</li>\r\n                        <li>Se recomienda fuertemente el uso de mascarillas reutilizables N95 con certificación NIOSH*</li>\r\n                        <li>Suspender entrenamientos y partidos de ligas deportivas y actividades físicas extracurriculares</li>\r\n                        <li>Suspender el uso de cigarros de cualquier tipo</li>\r\n                        <li>Limitar el uso de vehículos que usen combustibles fósiles</li>\r\n                    </ul>  \r\n                    </Tab.Pane>\r\n                </Tab.Content>\r\n            </Tab.Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Recomendaciones\r\n","export const gases = [\r\n    {\r\n        name: 'PM25',\r\n        label: 'PM2.5',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'PM10',\r\n        units: 'μg/m3',\r\n    },\r\n    {\r\n        name: 'O3',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'CO',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'NO2',\r\n        units: 'ppm',\r\n    },\r\n    {\r\n        name: 'SO2',\r\n        units: 'ppm',\r\n    },\r\n];\r\n\r\n// Opciones del dropdown de sistemas:\r\nexport const systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"Sinaica\", label: 'Sinaica', opt: 'G'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon', opt: 'G'}\r\n]\r\n\r\n// Opciones del dropdown de gases:\r\nexport const indicadores = [\r\n    { value: 'PM25', label: 'PM2.5' },\r\n    { value: 'PM10', label: 'PM10' },\r\n    { value: 'O3', label: 'O3' },\r\n    { value: 'CO', label: 'CO' },\r\n    { value: 'NO2', label: 'NO2' },\r\n    { value: 'SO2', label: 'SO2' },\r\n];\r\n\r\nexport const unidad = {\r\n    PM25: 'µg/m3',\r\n    PM10: 'µg/m3',\r\n    CO: 'ppm',\r\n    O3: 'ppm',\r\n    NO2: 'ppm',\r\n    SO2: 'ppm',\r\n};\r\nexport const idBlacklist = [\r\n    'P36757',\r\n    'P47305',\r\n    'P39499',\r\n    'P46239',\r\n    'P50855',\r\n    'P35099',\r\n    'P39709',\r\n    'P39497',\r\n    'P39285',\r\n    'P39355',\r\n\r\n\r\n\r\n];\r\nexport const idBlacklistpriv = [\r\n    'P39497',\r\n    'P39285',\r\n    'P39355'\r\n\r\n];\r\nexport const mapBlacklist = [\r\n    'Sinaica', \r\n\r\n];\r\n\r\nexport const apiUrl =\r\n    process.env.NODE_ENV === 'production'\r\n        ? process.env.REACT_APP_API_URL\r\n        : 'http://127.0.0.1:8000';\r\n","import { useMemo, useState, useEffect } from 'react';\r\nimport {\r\n    Form,\r\n    Modal,\r\n    Button,\r\n    Col,\r\n    Row,\r\n    Tooltip,\r\n    OverlayTrigger,\r\n} from 'react-bootstrap';\r\nimport { BsInfoCircle } from 'react-icons/bs';\r\nimport { useSelector } from 'react-redux';\r\nimport Select from 'react-select';\r\nimport { indicadores, mapBlacklist, idBlacklist, idBlacklistpriv } from '../constants'\r\n\r\nconst systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon', opt: 'G'}\r\n]\r\n\r\nconst intervalos =  [\r\n    {value: '1', label: 'Tiempo real'},\r\n    {value: '2', label: '12 horas'},\r\n    {value: '3', label: '24 horas'},\r\n    {value: '4', label: 'Última semana'},\r\n    {value: '5', label: 'Último mes'},\r\n    {value: '6', label: 'Último año'}\r\n]\r\n\r\nconst MapaFiltros = ({ onApply }) => {\r\n    const { sensorData } = useSelector((state) => state);\r\n    const [systemChosen, setSystemChosen] = useState(\"\");\r\n    const locationOptions = useMemo(() => {\r\n        return sensorData\r\n            .filter(\r\n                (sensor) =>\r\n                    typeof sensor.Longitud === 'number' &&\r\n                    typeof sensor.Latitud === 'number' && \r\n                    sensor.Sistema === systemChosen.label &&\r\n                    !idBlacklist.includes(sensor.Sensor_id) &&\r\n                    !idBlacklistpriv.includes(sensor.Sensor_id)\r\n            )\r\n            .map((record) => ({\r\n                value: record.Sensor_id,\r\n                label: record.Zona,\r\n            }));\r\n    }, [sensorData, systemChosen]);\r\n\r\n    const [indOptions, setIndOptions] = useState(indicadores);\r\n\r\n    useEffect(() => {\r\n        systemChosen.label === 'PurpleAir' ? setIndOptions([indicadores[0]]) : setIndOptions(indicadores)\r\n    }, [systemChosen]); // Updatea los gases disponibles cuando cambia la variable sistemas\r\n\r\n    const [show, setShow] = useState(false);\r\n    const [location, setLocation] = useState(null);\r\n    const [interval, setInterval_] = useState(intervalos[0]);\r\n    const [gas, setGas] = useState(indicadores[0]);\r\n\r\n    const handleClose = () => setShow(false);\r\n    const handleShow = () => setShow(true);\r\n   \r\n\r\n\r\n    return (\r\n        <div className=\"container mt-5\">\r\n            <Form>\r\n                <p style={{ fontSize: \"0.9em\" }}>*Recuerda que el sistema PurpleAir solo tiene disponible el contaminante PM2.5</p>\r\n                <Form.Row className=\"mapa-filtros\"> \r\n                    <Col className=\"mb-3\" xs={12} lg={4}>\r\n                        <Select\r\n                            placeholder=\"Sistema\"\r\n                            value={systemChosen}\r\n                            onChange={(value) => {\r\n                                setSystemChosen(value)\r\n                                setLocation(null)\r\n                            }}\r\n                            options={systemOptions}\r\n                        />\r\n                        <Select\r\n                            placeholder=\"Ubicación\"\r\n                            value={location}\r\n                            onChange={setLocation}\r\n                            options={locationOptions}\r\n                        />\r\n                    </Col>\r\n                    <Col className=\"mb-3\" xs={6} lg={3}>\r\n                        <Select\r\n                            isDisabled\r\n                            options={intervalos}\r\n                            onChange={setInterval_}\r\n                            value={interval}\r\n                        />\r\n                    </Col>\r\n                    <Col xs={6} lg={3}>\r\n                        <Row>\r\n                            <Col xs={10}>\r\n                                <Select\r\n                                    options={indOptions}\r\n                                    value={gas}\r\n                                    onChange={setGas}\r\n                                />\r\n                            </Col>\r\n                            <Col xs={2}>\r\n                            <OverlayTrigger\r\n                            key='top'\r\n                            placement='top'\r\n                            overlay={\r\n                                <Tooltip>\r\n                                Info. indicadores\r\n                                </Tooltip>\r\n                            }\r\n                            >\r\n                                <Button className=\"info-btn\" variant=\"link\" onClick={handleShow }>\r\n                                    <BsInfoCircle color=\"MediumVioletRed\" />\r\n                                </Button>\r\n                            </OverlayTrigger>\r\n                                \r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col>\r\n                        <Button\r\n                            className=\"btn-aplicar\"\r\n                            variant=\"primary\"\r\n                            block\r\n                            onClick={() => {\r\n                                onApply({ gas, location, interval });\r\n                                setLocation(null);\r\n                                setInterval_(intervalos[0]);\r\n                            }}\r\n                        >\r\n                            Aplicar\r\n                        </Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n  \r\n            <Modal size=\"lg\" show={show} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Indicadores</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">PM 10</span>&emsp; Material Particulado menor a 10 micrómetros</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Mezcla compleja de partículas líquidas o sólidas que provienen de fuentes naturales o de fuentes antropogénicas, poseen un tamaño aerodinámico menor a 10 micrómetros.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">PM 2.5</span>&emsp; Material Particulado menor a 2.5 micrómetros</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Mezcla Compleja de Partículas líquidas o sólidas que provienen principalmente de fuentes antropogénicas, poseen un tamaño aerodinámico menor a 2.5 micrómetros.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">O2</span>&emsp; Ozono</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Gas compuesto por 3 átomos de oxigeno que se encuentra principalmente en la estratosfera, puede formarse a nivel superficial debido a condiciones de alta radiación y temperatura.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">CO</span>&emsp; Monóxido de Carbono</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Gas incoloro que se forma principalmente por la combustión de gasolinas, leña o carbón, este compuesto, en altas concentraciones puede ser muy nocivo a la salud.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">SO2</span>&emsp; Dióxido de Azufre</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Es un gas formado por 2 átomos de oxígeno y uno de azufre, se forma principalmente por la combustión de combustibles fósiles con alto contenido de azufre.</p>\r\n                </Row>\r\n                <Row>\r\n                    <h3 className=\"mod-sub\"><span className=\"mod-ind morado\">NO2</span>&emsp; Dióxido de Nitrógeno</h3>\r\n                </Row>\r\n                <Row>\r\n                    <p className=\"mod-desc\">Molécula con 2 átomos de oxígeno y uno de Nitrógeno que se produce principalmente por la combustión de combustibles fósiles empleados en vehículos y plantas de energía.</p>\r\n                </Row>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={handleClose}>\r\n                Cerrar\r\n                </Button>\r\n            </Modal.Footer>\r\n            </Modal>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapaFiltros;\r\n","import React, {\r\n    useCallback,\r\n    useEffect,\r\n    useMemo,\r\n    useRef,\r\n    useState,\r\n} from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport PropTypes from 'prop-types';\r\nimport { divIcon } from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport { Marker, Popup } from 'react-leaflet';\r\nimport { Button,Form,Row,Col, Container } from 'react-bootstrap';\r\nimport moment from 'moment';\r\n\r\n\r\nconst showLabel = (label) => {\r\n    if (typeof label != 'number') return label; \r\n    const fixed = label.toFixed(2);\r\n    if (parseInt(fixed) === label) return label\r\n    return fixed;\r\n};\r\n\r\nconst renderMarker = (label, status, shape = 'round') => {\r\n    return (\r\n        <div\r\n            className=\"marker-wrapper\"\r\n            style={{ zIndex: shape === 'round' ? -1 : -10 }}\r\n        >\r\n            <div\r\n                className={`marker-${status} marker-base marker-shape-${shape}`}\r\n            ></div>\r\n            <span\r\n                className={`marker-${status}`}\r\n                style={{ backgroundColor: 'transparent' }}\r\n            >\r\n                {showLabel(label)}\r\n            </span>\r\n        </div>\r\n    );\r\n};\r\n\r\n/**\r\n * Marcador\r\n * @augments {Component<Props, State>}\r\n */\r\nfunction Marcador({\r\n    ICAR,\r\n    label,\r\n    status,\r\n    position,\r\n    current,\r\n    provider,\r\n    locationStr,\r\n    labels,\r\n    lastUpdate,\r\n    map,\r\n    shape = 'round',\r\n    ...props\r\n}) {\r\n    const marker = useMemo(() => document.createElement('div'), []);\r\n    const popupRef = useRef();\r\n    const [icon, setIcon] = useState(null);\r\n\r\n    const updateMarker = useCallback(\r\n        (label_, status_) => {\r\n            ReactDOM.render(renderMarker(label_, status_, shape), marker);\r\n\r\n            setIcon(\r\n                divIcon({\r\n                    html: marker,\r\n                    className: `sensor-icon ${\r\n                        shape === 'round' ? '' : 'behind'\r\n                    }`,\r\n                    popupAnchor: [7, 0],\r\n                })\r\n            );\r\n        },\r\n        [shape]\r\n    );\r\n\r\n    useEffect(() => {\r\n        updateMarker(label, status);\r\n    }, [label, status, updateMarker]);\r\n\r\n    if (!icon) return null;\r\n\r\n    return (\r\n        \r\n        <Marker position={position} icon={icon} {...props}>\r\n            <Popup\r\n                ref={popupRef}\r\n                className=\"custom-popup\"\r\n                closeButton={(props) => (\r\n                    <button\r\n                        {...props}\r\n                        type=\"button\"\r\n                        class=\"btn-close\"\r\n                        aria-label=\"Close\"\r\n                    ></button>\r\n                )}\r\n            >\r\n                \r\n                <div className=\"px-3 py-2\">\r\n                    <div\r\n                        className={`rounded marker-${current.status}`}\r\n                        style={{\r\n                            display: 'flex',\r\n                            justifyContent: 'center',\r\n                            padding: '0 0.1rem ',\r\n                        }}\r\n                    >\r\n                        {current.indicator}: {current.label} {current.units}\r\n                    </div>\r\n                 \r\n                    <div className=\"data-label\">\r\n                        <small className=\"text-muted\">Ubicación</small>\r\n                        <br />\r\n                        <data>{locationStr}</data>     \r\n                    </div>\r\n                   \r\n                   \r\n                    <div className=\"data-label\">\r\n                        <small className=\"text-muted\">\r\n                            Última actualización\r\n                        </small>\r\n                        <br />\r\n                        <time>\r\n                            {moment(lastUpdate).format(\r\n                                'ddd, MMMM D YYYY, h:mm:ss a'\r\n                            )}\r\n                        </time>\r\n                    </div>\r\n                    <div className=\"data-label2\">\r\n                        <small className=\"text-muted\">Tiempo Real</small>\r\n                        <small className=\"text-muted ml-5\">Indice Calidad Aire</small>\r\n                    </div>\r\n                    \r\n                    <Form >\r\n                        {labels.map(({ label, status, value, units }, idx) => (\r\n                           \r\n                            <Form.Row \r\n    \r\n                                key={idx}\r\n                                className=\"d-flex justify-content-between  mb-1 \"\r\n                            >\r\n                                <Col xs = {3}>\r\n                                <Link\r\n                                    to={{\r\n                                        pathname: 'registro',\r\n                                        search: `?gas=${label}`,\r\n                                    }}\r\n                                    \r\n                                >\r\n                                    {label}\r\n                                </Link>\r\n                                </Col>\r\n                                <Col className={`d-flex justify-content-between px-1 rounded marker-${status}`} xs={5}>\r\n                               \r\n                                \r\n                                    <span>{value}</span>\r\n                                    <span>{units}</span>\r\n                                \r\n                               \r\n                                </Col>\r\n                                <Col className={`d-flex justify-content-between px-1 rounded marker-${status}`} xs={3}>\r\n                               \r\n                               {\r\n                                    label === 'PM2.5' ?\r\n                                    ICAR == '-1.00' ?\r\n                                    <span>{'ND'}</span>\r\n                                    :\r\n                                    ICAR == '0.00' ?\r\n                                    <span>{'ND'}</span>\r\n                                    :\r\n                                    <span>{ICAR.toFixed(2)}</span>\r\n                                    :\r\n                                    <span>{'ND'}</span>\r\n                               } \r\n                          \r\n                           </Col>\r\n                                </Form.Row>\r\n                               \r\n                           \r\n                        ))}\r\n                    </Form>\r\n                </div>\r\n\r\n                <div className=\"py-2 px-3 border-top text-center\">\r\n                    <Button size=\"sm\">Más información</Button>\r\n                    <p className=\"lh-sm mt-2 mb-0\">\r\n                        Fuente(s): <a target='blank' href={provider.ref}>{provider.name}</a>\r\n                    </p>\r\n                </div>\r\n            </Popup>\r\n        </Marker>\r\n    );\r\n}\r\n\r\nMarcador.defaultProps = {};\r\n\r\nMarcador.propTypes = {\r\n    /**\r\n     * Etiqueta del indicador que muestra el popup\r\n     */\r\n    indicator: PropTypes.string,\r\n\r\n    /**\r\n     * Informacion del indicador que muestra el popup\r\n     */\r\n    current: PropTypes.shape({\r\n        label: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n        status: PropTypes.number,\r\n        units: PropTypes.string,\r\n    }),\r\n\r\n    /**\r\n     * Fecha de la ultima actualización del sensor en milisegundos\r\n     */\r\n    lastUpdate: PropTypes.instanceOf(Date),\r\n\r\n    /**\r\n     * Etiqueta de la ubicación del sensor\r\n     */\r\n    locationStr: PropTypes.string,\r\n\r\n    /**\r\n     * LatLng del marcador\r\n     */\r\n    position: PropTypes.arrayOf(PropTypes.number),\r\n\r\n    /**\r\n     * Informacion de la fuente del sensor (e.g. Purple Air, Sinaica, etc.)\r\n     */\r\n    provider: PropTypes.shape({\r\n        name: PropTypes.string,\r\n        ref: PropTypes.string,\r\n    }),\r\n\r\n    /**\r\n     * Informacion de todos los indicadores del sensor\r\n     */\r\n    labels: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            indicator: PropTypes.string,\r\n            label: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n            status: PropTypes.number,\r\n            units: PropTypes.string,\r\n            ref: PropTypes.string,\r\n        })\r\n    ),\r\n};\r\n\r\nexport default Marcador;\r\n","import React, { Component } from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport '../styles/marker.css';\r\nimport { MapContainer, TileLayer } from 'react-leaflet';\r\n\r\n/**\r\n * Wrapper\r\n * @augments {Component<Props, State>}\r\n */\r\nfunction Wrapper({ center, children, ...props }) {\r\n    return (\r\n        <MapContainer\r\n            center={center}\r\n            scrollWheelZoom={false}\r\n            style={{\r\n                height: '100%',\r\n                widht: '100%',\r\n            }}\r\n            {...props}\r\n        >\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"https://stadiamaps.com/\">Stadia Maps</a>, &copy; <a href=\"https://openmaptiles.org/\">OpenMapTiles</a> &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors'\r\n                url=\"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png?api_key=e4368efd-701c-4da6-8372-03f4040a622a\"\r\n            />\r\n            {children}\r\n        </MapContainer>\r\n    );\r\n}\r\n\r\nWrapper.defaultProps = {};\r\n\r\nWrapper.propTypes = {\r\n    /**\r\n     * Nodos hijos del mapa (solo elementos de leaflet)\r\n     */\r\n    children: PropTypes.node,\r\n\r\n    /**\r\n     * Un arreglo [lat, lng] con la posición del centro del mapa\r\n     */\r\n    center: PropTypes.arrayOf(PropTypes.number),\r\n\r\n    setMap: PropTypes.func,\r\n};\r\n\r\nexport default Wrapper;\r\n","export const criteria = {\r\n    'Aire y Salud': {\r\n        PM10: [50, 75, 155, 235],\r\n        PM25: [25, 45, 78, 147],\r\n        O3: [0.051, 0.095, 0.135, 0.175],\r\n        CO: [8.75, 11.00, 13.30, 15.50],\r\n        SO2: [0.008, 0.110, 0.165, 0.220],\r\n        NO2: [0.107, 0.210, 0.230, 0.250],\r\n    },\r\n    NOM: {\r\n        PM10: [100, 135, 214, 300],\r\n        PM25: [55, 75, 97.4, 128.8],\r\n        O3: [0.07, 0.093, 0.115, 0.137],\r\n        CO: [12, 13.9, 15.9, 18.9],\r\n        SO2: [0.253, 0.345, 0.435, 0.566],\r\n        NO2: [0.132, 0.176, 0.221, 0.289],\r\n    },\r\n};\r\n\r\nexport const airQualityTags = [\"buena\", \"acept\", \"mala\", \"muy\", \"ext\"];\r\n\r\nexport const getStatus = (gas, value, norm = 'Aire y Salud') => {\r\n    const breakpoints = criteria[norm][gas];\r\n\r\n    for (let i = breakpoints.length - 1; i >= 0; i--) {\r\n        if (value > breakpoints[i]) {\r\n            return parseInt(i) + 1;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n};\r\n","import { apiUrl } from '../constants';\r\n\r\nconst retry = (fn, ms = 1000, retries = 5) =>\r\n    new Promise((resolve, reject) => {\r\n        fn()\r\n            .then(resolve)\r\n            .catch(() => {\r\n                setTimeout(() => {\r\n                    if (!retries) {\r\n                        return reject(\r\n                            'Se excedió el número máximo de intentos'\r\n                        );\r\n                    }\r\n                    retry(fn, ms, retries - 1).then(resolve, reject);\r\n                }, ms);\r\n            });\r\n    });\r\n\r\nconst fetchSummaryDataFn = () =>\r\n    new Promise((resolve, reject) => {\r\n        fetch(`${apiUrl}/sensor-summary`)\r\n            .then((res) => {\r\n                if (res.status === 200) {\r\n                    return res.json();\r\n                } else {\r\n                    reject();\r\n                }\r\n            })\r\n            .then((json) => {\r\n                resolve(json);\r\n            })\r\n            .catch((err) => reject(err));\r\n    });\r\n\r\nexport const fetchSummaryData = () => {\r\n    return retry(fetchSummaryDataFn);\r\n};\r\n","import { createSlice } from '@reduxjs/toolkit';\r\nimport moment from 'moment';\r\n\r\nconst initialState = { sensorData: [], sensorDataLastUpdate: null };\r\n\r\nconst dataSlice = createSlice({\r\n    name: 'data',\r\n    initialState,\r\n    reducers: {\r\n        setSensorData(state, action) {\r\n            if (Array.isArray(action.payload)) {\r\n                state.sensorData = action.payload;\r\n                state.sensorDataLastUpdate = moment();\r\n            }\r\n        },\r\n    },\r\n});\r\n\r\nexport const { setSensorData } = dataSlice.actions;\r\nexport default dataSlice.reducer;\r\n","import moment from 'moment';\r\nimport { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { fetchSummaryData } from '../handlers/data';\r\nimport { setSensorData } from '../redux/reducers';\r\n\r\nconst useSensorData = ({ cacheTime = 60, useCache = true }) => {\r\n    const { sensorDataLastUpdate, sensorData } = useSelector((state) => state);\r\n    const dispatch = useDispatch();\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [data, setData] = useState(sensorData);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        // Llama a la api si los datos se guardaron hace menos de una hora\r\n        const diff = sensorDataLastUpdate && useCache\r\n            ? moment().diff(sensorDataLastUpdate, 'minutes')\r\n            : 999; // Caso sensorDataLastUpdate == null, se tienen que solicitar los datos\r\n\r\n        if (diff > cacheTime) {\r\n            fetchSummaryData()\r\n                .then((data) => {\r\n                    dispatch(setSensorData(data));\r\n                    setData(data);\r\n                })\r\n                .catch((err) => {\r\n                    console.error(err);\r\n                    setData([]);\r\n                    setError(err);\r\n                })\r\n                .finally(() => setLoading(false));\r\n        } else {\r\n            setLoading(false);\r\n        }\r\n    }, [sensorDataLastUpdate, dispatch, cacheTime, useCache]);\r\n\r\n    return { loading, data, error };\r\n};\r\n\r\nexport default useSensorData;\r\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport Recomendaciones from \"./components/Recomendaciones.js\";\r\nimport MapaFiltros from \"./components/MapaFiltros.js\";\r\nimport Marcador from \"./components/Marcador.js\";\r\nimport Wrapper from \"./components/WrapperMapa.js\";\r\n\r\nimport { gases, mapBlacklist, idBlacklist } from \"./constants.js\";\r\nimport { getStatus, airQualityTags } from \"./handlers/statusCriteria.js\";\r\nimport useSensorData from \"./hooks/useSensorData.js\";\r\nimport { apiUrl } from './constants';\r\nimport { Spinner, OverlayTrigger, Popover, Button } from \"react-bootstrap\";\r\nimport moment from \"moment\";\r\n\r\nconst mapDefaultProps = {\r\n  center: [25.67, -100.25],\r\n  zoom: 11,\r\n  minZoom: 10,\r\n};\r\n\r\nfunction Mapa() {\r\n  const [currentGas, setCurrentGas] = useState(gases[0]);\r\n  const {\r\n    data: sensorData,\r\n    loading: loadingSensorData,\r\n    error: errorSensorData,\r\n  } = useSensorData({});\r\n\r\n  const [map, setMap] = useState(null);\r\n  const [airQualityIndex, setAirQualityIndex] = useState(0);\r\n\r\n  const setCenter = useCallback(\r\n    (pos) => {\r\n      if (map) {\r\n        // setLastCenter(pos);\r\n        map.setView(pos, mapDefaultProps.zoom, {\r\n          animate: true,\r\n        });\r\n      }\r\n    },\r\n    [map]\r\n  );\r\n\r\n  const markers = useMemo(() => {\r\n    let highestAirQualityIndex = 0;\r\n\r\n    const filteredSensors = sensorData.filter(\r\n      (sensor) =>\r\n        typeof sensor.Longitud === \"number\" &&\r\n        typeof sensor.Latitud === \"number\" &&\r\n        !mapBlacklist.includes(sensor.Sistema)&&\r\n        !idBlacklist.includes(sensor.Sensor_id)\r\n    );\r\n\r\n    console.log(filteredSensors)\r\n\r\n    // let sensores = ''\r\n    // console.log(filteredSensors);\r\n    // filteredSensors.forEach(sensor => {\r\n    //   sensores += sensor.Sensor_id + ',';\r\n    // });\r\n    // sensores = sensores.slice(0, -1);\r\n\r\n    // fetch(`${apiUrl}/get_air_indeces?locations=` + sensores)\r\n    // .then(res => res.json())\r\n    // .then(data => {\r\n    //   console.log(data)\r\n    //   console.log(sensores);\r\n\r\n    // })\r\n\r\n    const resultingData = filteredSensors.map((data) => {\r\n      const { name: gasName, units: gasUnits } = currentGas;\r\n\r\n      let preValue =\r\n        gasName === \"PM25\"\r\n          ? data.Sistema === \"PurpleAir\"\r\n            ? data[\"PM25_Promedio\"]\r\n            : data[gasName]\r\n          : data[gasName];\r\n\r\n      const value = typeof preValue === \"number\" ? preValue : \"ND\";\r\n\r\n      const gasStatus = getStatus(gasName, value);\r\n      if (gasStatus > highestAirQualityIndex) {\r\n        highestAirQualityIndex = gasStatus;\r\n      }\r\n\r\n      return {\r\n        ICAR: +data.ICAR,\r\n        position: [data.Latitud, data.Longitud],\r\n        current: {\r\n          indicator: currentGas.label ? currentGas.label : gasName,\r\n          label: value,\r\n          units: gasUnits,\r\n          status: value !== \"ND\" ? getStatus(gasName, value) : 99,\r\n          ref: \"#\",\r\n        },\r\n        lastUpdate: moment.utc(data.Dia).local(),\r\n        locationStr: data.Zona?.length > 0 ? data.Zona : \"ND\",\r\n        provider: {\r\n          name: data.Sistema,\r\n          ref: (() => {\r\n            if (data.Sistema === \"PurpleAir\")\r\n              return \"https://www.purpleair.com/map?mylocation\";\r\n            if (data.Sistema === \"AireNuevoLeon\")\r\n              return \"http://aire.nl.gob.mx/\";\r\n            if (data.Sistema === \"Sinaica\")\r\n              return \"https://sinaica.inecc.gob.mx/\";\r\n            return \"#\";\r\n          })(),\r\n        },\r\n        isPurpleAir: data.Sistema === \"PurpleAir\",\r\n        labels: gases.map(({ name, label, units }) => {\r\n          let colName = name;\r\n          if (name === \"PM25\" && data.Sistema === \"PurpleAir\")\r\n            colName = \"PM25_Promedio\";\r\n          return {\r\n            label: label ? label : name,\r\n            units,\r\n            value: typeof data[colName] === \"number\" ? data[colName] : \"ND\",\r\n            status: data[colName] ? getStatus(name, data[colName]) : 99,\r\n            ref: \"#\",\r\n          };\r\n        }),\r\n      };\r\n    });\r\n\r\n    setAirQualityIndex(highestAirQualityIndex);\r\n    return resultingData;\r\n  }, [sensorData, currentGas, setAirQualityIndex]);\r\n\r\n  return (\r\n    <div>\r\n      <MapaFiltros\r\n        onApply={({ gas, location }) => {\r\n          if (location) {\r\n            // Encuentra sensor al que le corresponde la ubicación de los filtros\r\n            const fSensor = sensorData.find(\r\n              (record) => record.Sensor_id === location.value\r\n            );\r\n\r\n            if (fSensor) {\r\n              setCenter([fSensor.Latitud, fSensor.Longitud]);\r\n            }\r\n          } else {\r\n            alert(\"Selecciona una ubicación\");\r\n            return;\r\n          }\r\n\r\n          if (gas) {\r\n            const nGas = gases.find((gas_) => gas_.name === gas.value);\r\n            setCurrentGas(nGas ?? currentGas);\r\n          }\r\n        }}\r\n      />\r\n      <div\r\n        className=\"my-4\"\r\n        style={{\r\n          zIndex: 0,\r\n          position: \"relative\",\r\n          width: \"100%\",\r\n          height: \"500px\",\r\n        }}\r\n      >\r\n        {errorSensorData && (\r\n          <div\r\n            className=\"position-absolute w-100 end-0 p-2\"\r\n            style={{ zIndex: 100 }}\r\n          >\r\n            <div class=\"alert alert-danger\" role=\"alert\">\r\n              Ocurrió un error al cargar los datos.\r\n            </div>\r\n          </div>\r\n        )}\r\n        {loadingSensorData && (\r\n          <div\r\n            className=\"w-100 h-100 d-flex position-absolute\"\r\n            style={{\r\n              zIndex: 100,\r\n              backgroundColor: \"rgba(0,0,0,0.2)\",\r\n            }}\r\n          >\r\n            <div className=\"position-absolute top-50 start-50 translate-middle\">\r\n              <Spinner animation=\"border\" />\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div\r\n          className=\"w-100 h-100 position-absolute p-2\"\r\n          style={{ zIndex: 99, pointerEvents: \"none\" }}\r\n        >\r\n          <div className=\"position-absolute end-0\">\r\n            <OverlayTrigger\r\n              trigger=\"click\"\r\n              placement={\"left\"}\r\n              overlay={\r\n                <Popover>\r\n                  <Popover.Title as=\"h3\">Leyenda</Popover.Title>\r\n                  <Popover.Content>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <div\r\n                        style={{\r\n                          boxSizing: \"border-box\",\r\n                          borderRadius: \"100%\",\r\n                          width: \"35px\",\r\n                          height: \"20px\",\r\n                          marginRight: \"0.75rem\",\r\n                          padding: 0,\r\n                          border: \"1px solid black\",\r\n                        }}\r\n                      ></div>\r\n                      Los sensores del estado se representan con un círculo\r\n                    </div>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <div\r\n                        style={{\r\n                          boxSizing: \"border-box\",\r\n                          width: \"35px\",\r\n                          height: \"20px\",\r\n                          marginRight: \"0.75rem\",\r\n                          padding: 0,\r\n                          border: \"1px solid black\",\r\n                        }}\r\n                      ></div>\r\n                      Los sensores de Purple Air se representan con un cuadrado\r\n                    </div>\r\n                  </Popover.Content>\r\n                </Popover>\r\n              }\r\n            >\r\n              <Button variant=\"link\" className=\"pe-auto\">\r\n                Leyenda\r\n              </Button>\r\n            </OverlayTrigger>\r\n          </div>\r\n        </div>\r\n        <Wrapper whenCreated={setMap} {...mapDefaultProps}>\r\n          {!loadingSensorData &&\r\n            markers.map((markerProps, idx) => {\r\n              return (\r\n                <Marcador\r\n                  map={map}\r\n                  key={idx}\r\n                  {...markerProps}\r\n                  label={markerProps.current.label}\r\n                  indicator={markerProps.current.indicator}\r\n                  status={markerProps.current.status}\r\n                  shape={markerProps.isPurpleAir ? \"square\" : \"round\"}\r\n                />\r\n              );\r\n            })}\r\n        </Wrapper>\r\n      </div>\r\n      <Recomendaciones selected={airQualityTags[airQualityIndex]} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Mapa;\r\n","import moment from 'moment';\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Form, ButtonGroup, Button, Col, ToggleButton } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport Select from 'react-select';\r\nimport { fetchSummaryData } from '../handlers/data';\r\nimport { setSensorData } from '../redux/reducers';\r\nimport { indicadores, mapBlacklist, idBlacklistpriv  } from '../constants'\r\n\r\n// Diferente a la que esta definida en constants porque este debe de decir AireNL/Sinaica junto\r\nconst systemOptions = [\r\n    {value: \"PurpleAir\", label: 'PurpleAir', opt: 'P'},\r\n    {value: \"AireNuevoLeon\", label: 'AireNuevoLeon/Sinaica', opt: 'G'}\r\n]\r\n\r\n// Componente para la página de Registro Histórico\r\nfunction RHFiltros({\r\n    createQueryGraph,\r\n    createQueryCal,\r\n    radioValue,\r\n    setRadioValue,\r\n    updateMainFiltros,\r\n}) {\r\n    /* \r\n        Parámetros:\r\n            - createQueryGraph: función para crear query de la gráfica\r\n            - createQueryCal: función para crear query del calendario\r\n            - radioValue: sección seleccionada\r\n            - setRadioValue: función para cambiar el radioValue\r\n            - updateMainFiltros: función para updatear en el componente padre los inputs seleccionados\r\n    */\r\n\r\n\r\n    const radios = [\r\n        { name: 'Grafica', value: '1' },\r\n        { name: 'Calendario', value: '2' },\r\n    ];\r\n\r\n    const dispatch = useDispatch();\r\n    const { sensorDataLastUpdate, sensorData } = useSelector((state) => state);\r\n\r\n    const [sensRaw, setSensRaw] = useState(null);\r\n    let sensores = [];\r\n\r\n    useEffect(() => {\r\n        // TODO: convertir a hook\r\n        const diff = sensorDataLastUpdate\r\n            ? moment().diff(sensorDataLastUpdate, 'minutes')\r\n            : 999;\r\n\r\n        if (diff > 60) {\r\n            fetchSummaryData()\r\n                .then((data) => {\r\n                    dispatch(setSensorData(data));\r\n                    setSensRaw(data);\r\n                })\r\n                .catch((err) => console.error(err));\r\n        } else {\r\n            setSensRaw(sensorData);\r\n        }\r\n    }, []);\r\n\r\n    const [system, setSystem] = useState(\"\")\r\n    const [indOptions, setIndOptions] = useState(indicadores);\r\n    const [location, setLocation] = useState(null)\r\n    \r\n    const sistema = useRef(null);\r\n    const ubicacion = useRef(null);\r\n    const indicador = useRef(indicadores[0]);\r\n\r\n    useEffect(() => {\r\n        system.value === \"PurpleAir\" ? setIndOptions([indicadores[0]]) : setIndOptions(indicadores)\r\n    }, [system]); // Updatea los gases disponibles cuando cambia la variable sistemas\r\n\r\n    // Crear valores para el dropdown:\r\n    if (sensRaw) {\r\n        sensRaw.forEach((element) => {\r\n            if(system.value === element.Sistema &&\r\n               !idBlacklistpriv.includes(element.Sensor_id)) {\r\n                sensores.push({ value: element.Sensor_id, label: element.Zona });\r\n            }\r\n        });\r\n    }\r\n\r\n    // Función general para crear el query\r\n    function createQuery() {\r\n        updateMainFiltros(ubicacion.current, indicador.current, sistema.current); // Actualiza los valores de los filtros en el componente padre\r\n        if (radioValue == '1') {\r\n            createQueryGraph();\r\n        } else {\r\n            createQueryCal();\r\n        }\r\n    }\r\n    return (\r\n        <div className=\"mt-5\">\r\n            <div className=\"ta-center mb-5\">\r\n                <h2>Registro Histórico</h2>\r\n                <p>Consulta los datos históricos de la calidad del aire</p>\r\n            </div>\r\n            <Form>\r\n                <Form.Row className=\"mb-3\">\r\n                    <Col xs={6}>\r\n                        <Select\r\n                            options={systemOptions}\r\n                            placeholder={'Sistema'}\r\n                            onChange={(value) => {\r\n                                setLocation(null)\r\n                                ubicacion.current = null\r\n                                sistema.current = value\r\n                                setSystem(value)\r\n                            }}\r\n                        />\r\n                    </Col>\r\n                    <Col xs={6}>\r\n                        <Select\r\n                            options={sensores}\r\n                            value={location}\r\n                            placeholder={'Ubicación'}\r\n                            onChange={(value) => {\r\n                                setLocation(value)\r\n                                ubicacion.current = value;\r\n                            }}\r\n                        />\r\n                    </Col>\r\n                </Form.Row>\r\n                <Form.Row>\r\n                    <Col>\r\n                        <ButtonGroup toggle>\r\n                            {radios.map((radio, idx) => (\r\n                                <ToggleButton\r\n                                    className=\"toggle-vista\"\r\n                                    key={idx}\r\n                                    type=\"radio\"\r\n                                    variant=\"light\"\r\n                                    name=\"radio\"\r\n                                    value={radio.value}\r\n                                    checked={radioValue === radio.value}\r\n                                    onChange={(e) =>\r\n                                        setRadioValue(e.currentTarget.value)\r\n                                    }\r\n                                >\r\n                                    {radio.name}\r\n                                </ToggleButton>\r\n                            ))}\r\n                        </ButtonGroup>\r\n                    </Col>\r\n                    <Col className=\"mb-3\">\r\n                        <Select\r\n                            options={indOptions}\r\n                            placeholder={'Indicador'}\r\n                            onChange={(value) => {\r\n                                indicador.current = value;\r\n                            }}\r\n                            defaultValue={indicadores[0]}\r\n                        />  \r\n                    </Col>\r\n                    <Col xs={12} sm={3} className=\"mb-3\">\r\n                        <Button\r\n                            className=\"btn-aplicar\"\r\n                            variant=\"primary\"\r\n                            block\r\n                            onClick={() => createQuery()}\r\n                        >\r\n                            Aplicar\r\n                        </Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n            <hr className=\"mt-2 mb-4\" />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default RHFiltros;\r\n","import moment from 'moment';\r\nimport React, { useEffect } from 'react';\r\nimport { Form, Button, Row, Col } from 'react-bootstrap';\r\nimport Plot from 'react-plotly.js';\r\n\r\nfunction Grafica({ setDesde, setHasta, setDesdeHora, setHastaHora, data, layout, summary }) {\r\n    useEffect(() => {\r\n        setDesde(null);\r\n        setHasta(null);\r\n        setDesdeHora('00:00:00')\r\n        setHastaHora('00:00:00')\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            <Form className=\"mt-4 mb-4\">\r\n                <Form.Row className=\"d-flex justify-content-evenly\">\r\n                    <Col xs={12} lg={5} className=\"mb-3\">\r\n                        <Row>\r\n                            <Col xs={2}>\r\n                                <Form.Label className=\"col-form-label\">\r\n                                    Desde:{' '}\r\n                                </Form.Label>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    type=\"date\"\r\n                                    required\r\n                                    onChange={(event) => setDesde(moment(event.target.value))}\r\n                                ></Form.Control>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                onChange={(event) => setDesdeHora(event.target.value + ':00')}                                \r\n                                type=\"time\"></Form.Control>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                    <Col xs={12} lg={5} className=\"mb-3\">\r\n                        <Row>\r\n                            <Col xs={2}>\r\n                                <Form.Label className=\"col-form-label\">\r\n                                    Hasta:{' '}\r\n                                </Form.Label>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                    type=\"date\"\r\n                                    required\r\n                                    onChange={(event) =>\r\n                                        setHasta(moment(event.target.value))\r\n                                    }\r\n                                ></Form.Control>\r\n                            </Col>\r\n\r\n                            <Col xs={5}>\r\n                                <Form.Control\r\n                                onChange={(event) => setHastaHora(event.target.value + ':00')}        \r\n                                type=\"time\"></Form.Control>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                </Form.Row>\r\n            </Form>\r\n\r\n            <Row className=\"mb-5\">\r\n                <Col xs={12} lg={4} xl={2}>\r\n                    <Row xs={12}>\r\n                        <Button className=\"btn btn-light mb-4\" block>\r\n                            Descargar datos\r\n                        </Button>\r\n                    </Row>\r\n                    <Row className=\"d-flex justify-content-center\">\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Máximo</p>\r\n                                    <p className=\"desc text-center\">{summary && summary?.max.date ? `Registrado el ${summary?.max.date}` : ''}</p>\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero muymala text-center\">\r\n                                        {summary && typeof summary?.max.value === 'number'\r\n                                            ? summary.max.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Mínimo</p>\r\n                                    <p className=\"desc text-center\">{summary && summary?.min.date ? `Registrado el ${summary?.min.date}` : ''}</p>\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero acept text-center\">\r\n                                        {summary && typeof summary?.min.value === 'number'\r\n                                            ? summary.min.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex align-items-center justify-content-center\">\r\n                                <Row sm={12}>\r\n                                    <p className=\"tipo text-center\">Promedio</p>\r\n                                    {/* <p className=\"desc\">{summary && summary?.avg.da`Registrado el 00-00-000`}</p> */}\r\n                                </Row>\r\n                                <Row\r\n                                    sm={12}\r\n                                    className=\"d-flex align-items-center justify-content-end\"\r\n                                >\r\n                                    <p className=\"numero mala text-center\">\r\n                                        {summary && typeof summary?.avg.value === 'number'\r\n                                            ? summary.avg.value.toFixed(2)\r\n                                            : '-'}\r\n                                    </p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={6} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado d-flex align-items-center justify-content-center\">\r\n                                <Row sm={12}\r\n                                className=\"d-flex align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Arriba de la norma</p>\r\n                                </Row>\r\n                                <Row sm={12}\r\n                                className=\"d-flex align-items-center justify-content-center\">\r\n                                    {/* <p className=\"numero mala text-center\">{summary ? summary.porcentajes.arribaLimite + '%' : '-'}</p> */}\r\n                                    <p className={`numero text-center ${summary ? (summary.porcentajes.arribaLimite == 0 ? \"bueno\" : summary.porcentajes.arribaLimite > 25 ? \"muymala\" : \"mala\") : null}`}>{summary ? summary.porcentajes.arribaLimite + '%' : '-'}</p>\r\n                                </Row>\r\n                            </Row>\r\n                        </Col>\r\n                        <Col xs={12} sm={5} lg={12}>\r\n                            <Row className=\"dato-calculado\">\r\n                                <Col xs={6} sm={6}\r\n                                className=\"d-flex flex-column align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Datos Válidos</p>\r\n                                    <p className=\"numero bueno text-center\">{summary ? summary.porcentajes.buenos + '%' : '-'}</p>\r\n                                </Col>\r\n                                <Col xs={6} sm={6}\r\n                                className=\"d-flex flex-column align-items-center justify-content-center\">\r\n                                    <p className=\"tipo text-center\">Datos Nulos</p>\r\n                                    <p className=\"numero muymala text-center\">{summary ? summary.porcentajes.nulos + '%' : '-'}</p>\r\n                                </Col>\r\n                            </Row>\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n\r\n                <Col sm={12} lg={8} xl={10}>\r\n                    <div className=\"grafico mb-4\">\r\n                        <Plot className=\"grafico-resize\" data={data} layout={layout} config={{responsive: true}} />\r\n                    </div>\r\n                </Col>\r\n                <Row className=\"d-block d-sm-none w-100\" xs={11}>\r\n                    <p>*Para una mejor visualización, utiliza el telefono horizontalmente.</p>\r\n                </Row>\r\n            </Row>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Grafica;\r\n","import React, { useState, useEffect } from 'react'\r\nimport buildCalendar from './buildCalendar';\r\nimport { Col, Row } from 'react-bootstrap';\r\nimport { v4 } from 'uuid';\r\n\r\n// Componente para el calendario en la página de Registro Histórico\r\nconst DatePicker = ({value, onChange}) => {\r\n    /* \r\n        Se siguió este tutorial : https://youtu.be/5jRrVqRWqsM\r\n\r\n        Parámetros:\r\n            - value: día seleccionado\r\n            - onChange: función para cambiar el State de value\r\n    */\r\n   \r\n    const [calendar, setCalendar] = useState([]);\r\n\r\n    // build calendar\r\n\r\n    useEffect(() => {\r\n         setCalendar(buildCalendar(value));\r\n    }, [value]);\r\n    \r\n    function isSelected(day) {\r\n        return value.isSame(day, \"day\");\r\n    }\r\n\r\n    function afterToday(day) {\r\n        return day.isAfter(new Date(), \"day\");\r\n    }\r\n\r\n    function isToday(day) {\r\n        return day.isSame(new Date(), \"day\");\r\n    }\r\n\r\n    function sameMonth(day) {\r\n        return day.isSame(value, \"month\");\r\n    }\r\n\r\n    function dayStyles(day) {\r\n        if (isSelected(day)) return \"selected\"\r\n        if (isToday(day)) return \"today\"\r\n        if (afterToday(day)) return \"after\"\r\n        if (!sameMonth(day)) return \"month\"\r\n        return \"\"\r\n    }\r\n\r\n    function currMonthName() {\r\n        return value.format(\"MMM\")\r\n    }\r\n\r\n    function currYear() {\r\n        return value.format(\"YYYY\")\r\n    }\r\n\r\n    function prevMonth() {\r\n        return value.clone().subtract(1, \"month\")\r\n    }\r\n\r\n    function nextMonth() {\r\n        return value.clone().endOf(\"month\").add(1, \"day\")\r\n    }\r\n\r\n    function currMonth() {\r\n        return value.isSame(new Date(), \"month\")\r\n    }\r\n\r\n    function isFirstMonthRegistered() {\r\n        return value.isSame(new Date(\"01-01-2018\"), \"month\") \r\n    }\r\n\r\n    return (\r\n        <div className=\"calendar mt-5\">\r\n            <div className=\"cal-header\">\r\n            <Row>\r\n                <Col sm={3} className=\"previous\" onClick={() => !isFirstMonthRegistered() && onChange(prevMonth)}>\r\n                    {!isFirstMonthRegistered() ? String.fromCharCode(171) : null}\r\n                </Col>\r\n                <Col sm={6} className=\"current\">\r\n                    {currMonthName()}, {currYear()}\r\n                </Col>\r\n                <Col  sm={3} className=\"next\" onClick={() => !currMonth() && onChange(nextMonth)}>\r\n                    {!currMonth() ? String.fromCharCode(187) : null}\r\n                </Col>\r\n            </Row>\r\n            </div>\r\n            <div className=\"body\">\r\n                <div className=\"day-names\">\r\n                    {\r\n                        [\"D\", \"L\", \"M\" , \"M\" , \"J\", \"V\" , \"S\"].map((d,i) => \r\n                                <div className=\"weekday\" key={i}>{d}</div>\r\n                            )\r\n                    }\r\n                </div>\r\n                { \r\n                calendar.map((week, w) => \r\n                <div key={w}>\r\n                    {\r\n                        week.map((day, i) => <div className=\"day\"\r\n                            onClick={() => !afterToday(day) && onChange(day)}>\r\n                            <div className={dayStyles(day)} key={v4()}>\r\n                                { day.format(\"D\") }\r\n                            </div>\r\n                            </div>\r\n                        )\r\n                    }\r\n                    \r\n                </div>) \r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default DatePicker\r\n","export default function buildCalendar(value) {\r\n    // Función para ayudar a construir el DatePicker\r\n    const startDay = value.clone().startOf(\"month\").startOf(\"isoWeek\"); // primer domingo antes del primero del mes\r\n    const endDay = value.clone().endOf(\"month\").endOf(\"isoWeek\").subtract(1, \"day\"); // último sábado después del fin de mes\r\n\r\n    const day = startDay.clone().subtract(2, \"day\");\r\n    const calendar = [];\r\n\r\n    // Crea las semanas del calendario\r\n    while (day.isBefore(endDay, \"day\")) {\r\n        calendar.push(\r\n            Array(7).fill(0).map(() => day.add(1, \"day\").clone())\r\n        )\r\n    }\r\n\r\n    return calendar;\r\n}","import React, { useState, useEffect } from 'react'\r\nimport '../styles/calendario.css';\r\nimport { Button, Col, Row, Accordion, Card } from 'react-bootstrap'\r\nimport DatePicker from './DatePicker'\r\nimport { AiFillCaretDown, AiFillRightSquare } from \"react-icons/ai\";\r\nimport { getStatus } from '../handlers/statusCriteria';\r\nimport Select from 'react-select';\r\nimport moment from 'moment'\r\nimport 'moment/locale/es';\r\n\r\nmoment.locale('es');\r\n\r\nconst unidad = {\r\n    PM25: \"µg/m3\",\r\n    PM10: \"µg/m3\",\r\n    CO: \"ppm\",\r\n    O3: \"ppm\",\r\n    NO2:\"ppm\", \r\n    SO2: \"ppm\"\r\n}\r\n\r\n// Valores para los dropdowns:\r\nconst meses = [\r\n    {value: '1', label: 'enero'},\r\n    {value: '2', label: 'febrero'},\r\n    {value: '3', label: 'marzo'},\r\n    {value: '4', label: 'abril'},\r\n    {value: '5', label: 'mayo'},\r\n    {value: '6', label: 'junio'},\r\n    {value: '7', label: 'julio'},\r\n    {value: '8', label: 'agosto'},\r\n    {value: '9', label: 'septiembre'},\r\n    {value: '10', label: 'octubre'},\r\n    {value: '11', label: 'noviembre'},\r\n    {value: '12', label: 'diciembre'}\r\n]\r\n\r\nconst anios = [\r\n    {value: '2018', label: '2018'},\r\n    {value: '2019', label: '2019'},\r\n    {value: '2020', label: '2020'},\r\n    {value: '2021', label: '2021'},\r\n]\r\n\r\n// Componente para la página de Registro Histórico\r\nfunction Calendario({q, create, data, indi, setDesde, setHasta, downloadFile}) {\r\n    /* \r\n        Parámetros:\r\n            - q : query creado en los filtros\r\n            - create: función para crear query\r\n            - data: datos para mostrar en el desglose de horas\r\n            - indi: gas seleccionado en los filtros\r\n            - setDesde: función para cambiar el State de la fecha de inicio para pedir los datos\r\n            - setHasta: función para cambiar el State de la fecha fin\r\n            - downloadFile: función para descargar los datos mostrados\r\n    */\r\n\r\n    // Función para obtener la clase a la que pertenece según la medida\r\n    // Dicha clase es para darle el color según el nivel de riesgo \r\n    function colorIndice(medida) {\r\n        let val = getStatus(indi, medida);\r\n\r\n        switch (val) {\r\n            case 0:\r\n                return \"bueno\";\r\n            case 1:\r\n                return \"acept\";\r\n            case 2:\r\n                return \"mala\";\r\n            case 3:\r\n                return \"muymala\";\r\n            case 4:\r\n                return \"extmala\";\r\n            default:\r\n                return \"no-data\";\r\n        }\r\n    }\r\n    \r\n    const [value, setValue] = useState(moment()); // Valor del día que está seleccionado en el calendario, se inicializa con el dia actual\r\n    \r\n    // Para resetear los valores si es que fueron utilizados en la sección de la gráfica:\r\n    useEffect(()=> {\r\n        setDesde(value);\r\n        setHasta(value);\r\n    }, []);\r\n\r\n    // Valores de los dropdowns para navegar más rápido a otra fecha, inicializados con la fecha actual\r\n    const [inMes, setInMes] = useState(new Date().getMonth() + 1);\r\n    const [inAnio, setInAnio] = useState(anios[anios.length - 1].value); \r\n\r\n    useEffect(() => {\r\n        setDesde(value);\r\n        setHasta(value);\r\n        if (data || q) { // Solo se crea y ejecuta el query si ya se ha dado click en el botón Aplicar\r\n            create(value, value);\r\n        }\r\n    }, [value]); // Cada que cambia el dia seleccionado, se actualizan los datos para crear el query\r\n\r\n     useEffect(() => {\r\n        let f = new Date(`${inMes}/${value.clone().format('DD')}/${inAnio}`); // Nos colocamos en el primer dia del mes para evitar que al moverte al siguiente mes, se coloque en un día futuro o inexistente\r\n        setValue(moment(f));\r\n    }, [inMes, inAnio]); // Cada que cambia un valor de los dropdowns, cambiamos el valor del día seleccionado\r\n\r\n    // Cuando ya se hizo el fetch para traer datos:\r\n    let dataCol1 = [];\r\n    let dataCol2 = [];\r\n    let index = 0;\r\n    let currHour = 0;\r\n\r\n    if (data && data.length !== 0) {\r\n        // Primera columna (horas de 00:00 a 11:00)\r\n        while (currHour < 12 && index < data.length) {\r\n            let ch = \"T\" + currHour.toString().padStart(2, 0) + \":\";\r\n            let info = [];\r\n\r\n            let firstIndex = index;\r\n            \r\n            // Junta los datos de la misma hora aunque sean de diferente sensor para ponerlos en un mismo acordión\r\n            while ( index < data.length && data[index][\"dia\"].includes(ch) ) {\r\n                // Se crea un p tag con un bullet de color, ubicación, medida registrada y unidad\r\n                info.push(<p><AiFillRightSquare className={colorIndice(data[index][indi])}/>{data[index][\"zona\"]}: {data[index][indi] ? ` ${data[index][indi]} ${unidad[indi]}` : \" No hay registro\"}</p>);\r\n                index++;\r\n            }\r\n\r\n            dataCol1.push(\r\n            <Accordion key={data[firstIndex].registros_id} id={data[firstIndex].registros_id}>\r\n                <Card>\r\n                    <Card.Header>\r\n                        <Accordion.Toggle as={Button} className=\"hora\"\r\n                            variant=\"link\"\r\n                            eventKey={data[firstIndex].registros_id}>\r\n                            <AiFillCaretDown color=\"lightgray\"/> {currHour.toString().padStart(2, 0)}:00\r\n                        </Accordion.Toggle>\r\n                    </Card.Header>\r\n                    <Accordion.Collapse eventKey={data[firstIndex].registros_id}>\r\n                        <Card.Body>\r\n                            {info}\r\n                        </Card.Body>\r\n                    </Accordion.Collapse>\r\n                </Card>\r\n            </Accordion>\r\n            )\r\n\r\n            currHour++;\r\n        }\r\n        \r\n        // Segunda columna (horas de 12:00 a 23:00)\r\n        while (currHour < 24 && index < data.length) {\r\n            let ch = \"T\" + currHour.toString().padStart(2, 0);\r\n            let info = [];\r\n\r\n            let firstIndex = index; // Esta variable sirve para darle un key a cada acordión, sin pasarnos del último índice\r\n            \r\n            while ( index < data.length && data[index][\"dia\"].includes(ch) ) {\r\n                info.push(<p><AiFillRightSquare className={colorIndice(data[index][indi])}/> {data[index][\"zona\"]}: {data[index][indi] ? `${data[index][indi]} ${unidad[indi]}` : \"No hay registro\"}</p>);\r\n                index++;\r\n            }\r\n\r\n            dataCol2.push(\r\n            <Accordion key={data[firstIndex].registros_id} id={data[firstIndex].registros_id}>\r\n                <Card>\r\n                    <Card.Header>\r\n                        <Accordion.Toggle as={Button} className=\"hora\"\r\n                            variant=\"link\"\r\n                            eventKey={data[firstIndex].registros_id}>\r\n                            <AiFillCaretDown color=\"lightgray\"/> {currHour.toString().padStart(2, 0)}:00\r\n                        </Accordion.Toggle>\r\n                    </Card.Header>\r\n                    <Accordion.Collapse eventKey={data[firstIndex].registros_id}>\r\n                        <Card.Body>\r\n                            {info}\r\n                        </Card.Body>\r\n                    </Accordion.Collapse>\r\n                </Card>\r\n            </Accordion>\r\n            )\r\n\r\n            currHour++;\r\n        }\r\n    } else {\r\n        dataCol1.push(<p>No hay datos para este día</p>);\r\n    }\r\n   \r\n    \r\n    return (\r\n        <div className=\"container mb-10\">\r\n            \r\n            <Row className=\"mb-5\">\r\n            <Col sm={12} lg={6}>\r\n            <div>\r\n                <Button className=\"btn btn-light mb-4 mt-4\" block onClick={downloadFile}>Descargar datos del mes</Button>\r\n                <Row className=\"mb-4\">\r\n                    <Col sm={6}>\r\n                    <Select\r\n                    options={meses}\r\n                    placeholder={'Mes'}\r\n                    onChange={(target) => setInMes(target.value)}\r\n                    defaultValue={meses[new Date().getMonth()]}\r\n                    />\r\n                    </Col>\r\n                    <Col sm={6}>\r\n                    <Select\r\n                    options={anios}\r\n                    placeholder={'Año'}\r\n                    onChange={(target) => setInAnio(target.value)}\r\n                    defaultValue={anios[anios.length - 1]}\r\n                    />\r\n                    </Col>\r\n                </Row>\r\n                <div className=\"detalles\">\r\n                    <h4>{value && value.format(\"DD/MM/YYYY\")} Detalle por hora</h4>\r\n                    <Row>\r\n                        <Col sm={6}>\r\n                            {dataCol1}\r\n                        </Col>\r\n                        <Col sm={6}>\r\n                            {dataCol2}\r\n                        </Col>\r\n                    </Row>\r\n                </div>\r\n            </div>\r\n            </Col>\r\n            <Col sm={12} lg={6} className=\"d-flex align-items-start justify-content-center\">\r\n                <DatePicker value={value} onChange={setValue}/>\r\n            </Col>\r\n            </Row>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Calendario\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport Chart from 'react-apexcharts';\r\nimport { apiUrl } from '../constants';\r\nimport { criteria } from '../handlers/statusCriteria';\r\nimport { unidad } from '../constants';\r\n\r\n// Componente para la página Registro Histórico, sección del calendario\r\nfunction HeatMap ({q, fecha, ubic, ind}) {\r\n    /* \r\n        Parámetros:\r\n            - q : query que proviene de RHFiltros\r\n            - fecha : dia seleccionada en el calendario\r\n            - ubic : sensores seleccionados en los filtros\r\n            - ind : gas seleccionado en los filtros\r\n    */\r\n\r\n    const [mes, setMes] = useState(null); \r\n    const [dataHM, setDataHM] = useState(null);\r\n\r\n    const queryAnt = useRef(null);\r\n    const mesAnt = useRef(mes);\r\n    let queryStr = \"\";\r\n\r\n    useEffect(() => {\r\n        if (fecha) {\r\n            // Cuando cambia la fecha seleccionada en el calendario, solo cambiamos el State del mes si sí cambió el mes\r\n            if (!mes || !mes.isSame(fecha.clone().startOf('month'))) {\r\n                mesAnt.current = mes;\r\n                setMes(fecha.clone().startOf('month'));\r\n            }\r\n        }\r\n    }, [fecha]);\r\n\r\n    useEffect(() => {\r\n        let newq = \"\";\r\n        if (q) {\r\n            newq = q.substring(0, q.indexOf(\"&inicio\")); // solo nos interesa saber las ubicaciones y gases seleccionados\r\n        }\r\n\r\n        if (!queryAnt.current || queryAnt.current !== newq || mesAnt.current != mes) { // Cambió la ubicación y gases seleccionados o el mes seleccionado\r\n            if (queryAnt.current !== q) queryAnt.current = newq;\r\n            if (mesAnt.current != mes) mesAnt.current = mes;\r\n\r\n            if (ubic && mes) {\r\n                // Creamos query, sacando los datos de todo el mes\r\n                queryStr = 'ubic=';\r\n\r\n                // ubic.forEach((element) => {\r\n                //     queryStr += element.value + ',';\r\n                // });\r\n\r\n                queryStr += ubic.value\r\n\r\n                // queryStr = queryStr.slice(0, -1);\r\n                queryStr +=\r\n                    '&ind=' + ind +\r\n                    '&inicio=' + mes.clone().format(\"YYYY-MM-DD\") +\r\n                    '&fin=' + mes.clone().endOf('month').format('YYYY-MM-DD');\r\n\r\n                    \r\n                console.log(\"Query HM: \" + queryStr);\r\n                fetch(`${apiUrl}/prom-data?${queryStr}`)\r\n                    .then(response => response.json())\r\n                    .then((json) => setDataHM(json))\r\n                    .catch((e) => console.log(e));\r\n\r\n            }\r\n        }\r\n    }, [q, mes]);\r\n\r\n    // Creación del Heatmap:\r\n    var options = {}; // Configuración\r\n    var series = []; // Datos\r\n\r\n    if (q && dataHM && dataHM.length > 0) {\r\n        /* EJEMPLO DEL FORMATO\r\n        series:[\r\n            {\r\n                name: dataHM[i][\"zona\"]\r\n                data: [\r\n                    {\r\n                        x: número del día,\r\n                        y: dataHM[i][ind],\r\n                        fecha: dataHM[i][fecha].format(\"DD-MM-YYYY\")\r\n                    }\r\n                ]\r\n            }\r\n        ] */\r\n        let index = 0;\r\n        let dataItem = {};\r\n\r\n        // Este codigo de abajo se cambio porque ya no era un array de ubicaciones se cambio solo a una ubicación\r\n\r\n        // for (let u = 0; u < ubic.length && dataHM[index]; u++) { // Por cada ubicacion seleccionada se crea una fila del heatmap\r\n            // let currUbic = dataHM[index][\"zona\"];\r\n            let currUbic = dataHM[index][\"zona\"];\r\n            let primerDia = new Date(dataHM[index].fecha.replace(/-/g, '\\/').replace(/T.+/, '')); // primer día registrado de los datos de una ubicacion\r\n            let currDia = 1;\r\n\r\n            let seriesItem = {\r\n                name : currUbic,\r\n                data: []\r\n            };\r\n            \r\n            // llenar primeros días vacíos si es que los datos del mes no empiezan en el primer día\r\n            while (primerDia.getDate() !== currDia) {\r\n                dataItem.x = currDia;\r\n                dataItem.y = -1;\r\n                seriesItem.data.push({...dataItem});\r\n                currDia++;\r\n            }\r\n            \r\n\r\n            // ahora sí hay datos\r\n            while (index < dataHM.length && dataHM[index][\"zona\"] === currUbic) {\r\n                dataItem.x = currDia;\r\n\r\n                // revisa que sí haya un registro de ese dia checando si coincide el número de día\r\n                if (currDia == parseInt(dataHM[index][\"fecha\"].substring(8))) {\r\n                    if (dataHM[index][\"prom\"] !== \"\") {\r\n                        dataItem.y = dataHM[index][\"prom\"];\r\n                        dataItem.fecha = dataHM[index][\"fecha\"];\r\n                    } else {\r\n                        dataItem.y = -1;\r\n                    }\r\n                    index++;\r\n                } else {\r\n                    dataItem.y = -1;\r\n                }\r\n\r\n                seriesItem.data.push({...dataItem});\r\n                currDia++;\r\n            }\r\n\r\n            series.push({...seriesItem});\r\n        // }\r\n\r\n        //console.log(series);\r\n\r\n        options = {\r\n            chart: {\r\n              type: 'heatmap',\r\n              toolbar: {\r\n                  show: false\r\n              }\r\n            },\r\n            plotOptions: {\r\n              heatmap: {\r\n                enableShades: false,\r\n                radius: 1,\r\n                useFillColorAsStroke: false,\r\n                colorScale: {\r\n                    ranges: [\r\n                    {\r\n                        from: -2,\r\n                        to: 0,\r\n                        name: 'No data',\r\n                        color: '#D3D3D3'\r\n                    },\r\n                    {\r\n                        from: 0,\r\n                        to: criteria['Aire y Salud'][ind][0],\r\n                        name: 'Buena',\r\n                        color: '#00E400'\r\n                    },\r\n                    {\r\n                        from: criteria['Aire y Salud'][ind][0],\r\n                        to: criteria['Aire y Salud'][ind][1],\r\n                        name: 'Aceptable',\r\n                        color: '#FFFF00'\r\n                    },\r\n                    {\r\n                        from: criteria['Aire y Salud'][ind][1],\r\n                        to: criteria['Aire y Salud'][ind][2],\r\n                        name: 'Mala',\r\n                        color: '#FF7E00'\r\n                    },\r\n                    {\r\n                        from: criteria['Aire y Salud'][ind][2],\r\n                        to: criteria['Aire y Salud'][ind][3],\r\n                        name: 'Muy mala',\r\n                        color: '#FF0000'\r\n                    },\r\n                    {\r\n                        from: criteria['Aire y Salud'][ind][3],\r\n                        to: criteria['Aire y Salud'][ind][3] * 1.5,\r\n                        name: 'Extremadamente mala',\r\n                        color: '#8F3F97'\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            },\r\n            dataLabels: {\r\n              enabled: false\r\n            },\r\n            stroke: {\r\n              width: 1\r\n            },\r\n            xaxis: {\r\n                position: \"bottom\"\r\n            },\r\n            legend: {\r\n                position: \"top\",\r\n                showForSingleSeries: true\r\n            },\r\n            tooltip: {\r\n                custom: function({series, seriesIndex, dataPointIndex, w}) {\r\n                    if (series[seriesIndex][dataPointIndex] !== -1) {\r\n                        return '<div class=\"arrow_box hmTooltip\">' +\r\n                        '<p>' + w.globals.initialSeries[seriesIndex].data[dataPointIndex].fecha + '</p>' +\r\n                        '<p><b>' + series[seriesIndex][dataPointIndex].toFixed(4) + ' ' + \r\n                        unidad[ind] + '</b></p>' +\r\n                        '</div>'\r\n                    }\r\n                    return '<div style=\"display:none;\">'\r\n                  }\r\n            }\r\n          };\r\n\r\n        //console.log(\"done\");\r\n    }\r\n\r\n\r\n    return (\r\n        <div>\r\n            <h3 className=\"mb-5\">Promedios diarios del mes</h3>\r\n            {q && (<Chart options={options} series={series} type=\"heatmap\" height={series.length * 100}/>)}\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\n\r\nexport default HeatMap\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport RHFiltros from './components/RHFiltros';\r\nimport Grafica from './components/Grafica';\r\nimport Calendario from './components/Calendario';\r\nimport HeatMap from './components/HeatMap';\r\nimport moment from 'moment';\r\nimport 'moment/locale/es';\r\nimport { apiUrl } from './constants';\r\nimport { Modal } from 'react-bootstrap';\r\n\r\nmoment.locale('es');\r\n\r\nfunction Registro() {\r\n    const [data, setData] = useState(null);\r\n    const [summaryData, setSummaryData] = useState(null);\r\n    const [radioValue, setRadioValue] = useState('1'); // sección seleccionada (Gráfica/Calendario)\r\n    const [q, setQ] = useState(null); // string del query\r\n\r\n    const [loading, setLoading] = useState(false); // gif\r\n    const [noData, setNoData] = useState(false); // Desplegar mensaje si no se encontraron datos en la BD\r\n\r\n    // Datos de los filtros:\r\n    //const [indi, setIndi] = useState('PM25');\r\n    const [desde, setDesde] = useState(null);\r\n    const [hasta, setHasta] = useState(null);\r\n    const [desdeHora, setDesdeHora] = useState('00:00:00');\r\n    const [hastaHora, setHastaHora] = useState('00:00:00');\r\n    const ind = useRef({ value: 'PM25' });\r\n    const ubic = useRef(null);\r\n    const syst = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (q) {\r\n            if (radioValue === '1') { // Sección gráfica\r\n                fetch(`${apiUrl}/get-graph-opt?${q}`)\r\n                    .then((response) => response.json())\r\n                    .then((json) => {\r\n                        if(json.hasOwnProperty('message')) setNoData(true);\r\n                        // Hacer cambio de horario por la zona horaria\r\n                        let fechasArray = []\r\n                        if(json.plot.data) {\r\n                            json.plot.data[0].x.forEach(fecha => {\r\n                                let time = moment.duration(\"05:00:00\");\r\n                                fecha = moment(fecha).subtract(time).format()\r\n                                fechasArray.push(fecha.split('-05:00')[0])\r\n                            });\r\n                        }\r\n                        json.plot.data[0].x = fechasArray\r\n\r\n                        console.log(json.plot)\r\n                        console.log(json.summary)\r\n                        setData(json.plot);\r\n                        setSummaryData(json.summary);\r\n                        setLoading(false);\r\n                    });\r\n            } else { // Sección calendario\r\n                fetch(`${apiUrl}/datos-fecha?${q}`)\r\n                    .then((response) => response.json())\r\n                    .then((json) => setData(json));\r\n            }\r\n        }\r\n    }, [q]); // Cada que cambia el string del query creado, hacemos un request al api\r\n\r\n    useEffect(() => {\r\n        setData(null);\r\n    }, [radioValue]); // Cuando cambiamos entre Gráfica y Calendario, borramos los datos\r\n\r\n    // Esta función es llamada por un componente hijo para actualizar los valores cada que cambian en los filtros\r\n    function updateMainFiltros(u, i, s) {\r\n        syst.current = s\r\n        ubic.current = u;\r\n        ind.current = i;\r\n    }\r\n\r\n    // Crea el string del query para la gráfica\r\n    function createQueryGraph() {\r\n        if (!ubic.current) {\r\n            alert('Selecciona una ubicación.');\r\n            return;\r\n        }\r\n        if (!desde || !hasta) {\r\n            alert('Selecciona las fechas.');\r\n            return;\r\n        }\r\n\r\n        setLoading(true); // Muestra gif de loading\r\n\r\n        // const locations = ubic.current\r\n        //     .map((u) => u.label)\r\n        //     .reduce(\r\n        //         (p, c) => (p === '' ? `locations=${c}` : `${p}&locations=${c}`),\r\n        //         ''\r\n        //     );\r\n\r\n        let queryStr = `location=${ubic.current.label}&gas=${\r\n            ind.current.value\r\n        }&system=${syst.current.opt}&start_date=${moment.utc(desde).format('MM/DD/YYYY')}${'/'}${desdeHora}&end_date=${moment\r\n            .utc(hasta)\r\n            .format('MM/DD/YYYY')}${'/'}${hastaHora}`;\r\n        \r\n        console.log(queryStr)\r\n        //setIndi(ind.current.value);\r\n        setQ(queryStr);\r\n    }\r\n\r\n    // Crea el string del query para el calendario\r\n    function createQueryCal(d, h) {\r\n        // Ejemplo:\r\n        // http://127.0.0.1:8000/datos-fecha?ubic=PA39362&ind=PM25&inicio=2020-10-05&fin=2020-10-06\r\n\r\n        if (!ubic.current) {\r\n            alert('Selecciona una ubicación.');\r\n            return;\r\n        }\r\n\r\n        if (!d || !h) {\r\n            d = desde;\r\n            h = hasta;\r\n        }\r\n\r\n        let queryStr = 'ubic=';\r\n\r\n        // ubic.current.forEach((element) => {\r\n        //     queryStr += element.value + ',';\r\n        // });\r\n\r\n        queryStr += ubic.current.value\r\n\r\n        // queryStr = queryStr.slice(0, -1);\r\n        queryStr +=\r\n            '&ind=' +\r\n            ind.current.value +\r\n            '&inicio=' +\r\n            d.format('YYYY-MM-DD') +\r\n            '&fin=' +\r\n            h.format('YYYY-MM-DD');\r\n\r\n        //setIndi(ind.current.value);\r\n        setQ(queryStr);\r\n    }\r\n\r\n    function downloadFile() {\r\n        if (q) {\r\n            let queryStr = 'ubic=';\r\n            ubic.current.forEach((element) => {\r\n                queryStr += element.value + ',';\r\n            });\r\n            queryStr = queryStr.slice(0, -1);\r\n\r\n            if (radioValue === '2') {\r\n                // Para el calendario se descarga todo el mes\r\n                queryStr +=\r\n                    '&ind=' +\r\n                    ind.current.value +\r\n                    '&inicio=' +\r\n                    desde.startOf('month').format('YYYY-MM-DD') +\r\n                    '&fin=' +\r\n                    hasta.endOf('month').format('YYYY-MM-DD');\r\n            } else {\r\n                // Para la sección de la gráfica se descarga según las fechas seleccionadas\r\n                queryStr +=\r\n                    '&ind=' +\r\n                    ind.current.value +\r\n                    '&inicio=' +\r\n                    desde.format('YYYY-MM-DD') +\r\n                    '&fin=' +\r\n                    hasta.format('YYYY-MM-DD');\r\n            }\r\n\r\n            fetch(`${apiUrl}/download-data?${queryStr}`)\r\n                .then((response) => response.blob())\r\n                .then((blob) => {\r\n                    const url = URL.createObjectURL(blob);\r\n\r\n                    const a = document.createElement('a');\r\n                    a.href = url;\r\n                    a.download = 'data.csv';\r\n\r\n                    const clickHandler = () => {\r\n                        setTimeout(() => {\r\n                            URL.revokeObjectURL(url);\r\n                            a.removeEventListener('click', clickHandler);\r\n                        }, 150);\r\n                    };\r\n\r\n                    a.addEventListener('click', clickHandler, false);\r\n                    a.click();\r\n                });\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"container mb-10\">\r\n            {/* Sería bueno refactorear esto a un componente */}\r\n            <Modal \r\n                show={noData} \r\n                onHide={() => setNoData(false)} \r\n                aria-labelledby=\"contained-modal-title-vcenter\" \r\n                centered\r\n                >\r\n                <Modal.Header closeButton>\r\n                    <h5>Datos no encontrados</h5>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <p>Revise los parametros e intente de nuevo.</p>\r\n                </Modal.Body>\r\n            </Modal>\r\n            <RHFiltros\r\n                createQueryGraph={createQueryGraph}\r\n                createQueryCal={createQueryCal}\r\n                radioValue={radioValue}\r\n                setRadioValue={setRadioValue}\r\n                updateMainFiltros={updateMainFiltros}\r\n            />\r\n            <div className=\"text-center\">\r\n                <img\r\n                    src=\"loading.gif\"\r\n                    alt=\"Cargando...\"\r\n                    className=\"loading\"\r\n                    style={loading ? {} : { display: 'none' }}\r\n                />\r\n            </div>\r\n            {radioValue === '1' && (\r\n                <Grafica\r\n                    setDesde={setDesde}\r\n                    setHasta={setHasta}\r\n                    setDesdeHora={setDesdeHora}\r\n                    setHastaHora={setHastaHora}\r\n                    downloadFile={downloadFile}\r\n                    summary={summaryData}\r\n                    {...data}\r\n                />\r\n            )}\r\n            {radioValue === '2' && (\r\n                <>\r\n                    <Calendario\r\n                        q={q}\r\n                        create={createQueryCal}\r\n                        data={data}\r\n                        indi={ind.current.value}\r\n                        setDesde={setDesde}\r\n                        setHasta={setHasta}\r\n                        downloadFile={downloadFile}\r\n                    />\r\n                    <HeatMap\r\n                        q={q}\r\n                        fecha={desde}\r\n                        ubic={ubic.current}\r\n                        ind={ind.current.value}\r\n                    />\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Registro;\r\n","import React, {useRef, useImperativeHandle, useMemo, useState, useEffect} from 'react'\r\nimport { Form, Button, Col, Row } from 'react-bootstrap'\r\nimport Select from 'react-select';\r\nimport { systemOptions, indicadores, idBlacklistpriv } from '../constants';\r\n\r\n// Componente para la página de Compara Datos\r\nconst ComparaFiltros = (props) => {\r\n    const id = useRef(props.id); // ID para el componente, pues se pueden agregar varios\r\n    let sensores = props.sensores; // Opciones del dropdown de sensores\r\n    \r\n    // Datos de cada input:\r\n    const [system, setSystem] = useState(\"PurpleAir\");\r\n    const [indOptions, setIndOptions] = useState(indicadores)\r\n    const [location, setLocation] = useState(null)\r\n    const ubic = useRef(sensores[0].zona ? sensores[0].zona : null);\r\n    const ind = useRef(indicadores[0].value);\r\n    const desde = useRef(null);\r\n    const hasta = useRef(null);\r\n    const desdeHora = useRef('00:00:00');\r\n    const hastaHora = useRef('00:00:00');\r\n\r\n    useEffect(() => {\r\n        system === \"PurpleAir\" ? setIndOptions([indicadores[0]]) : setIndOptions(indicadores)\r\n    }, [system]);\r\n\r\n    const sensorOptions = useMemo(() => {\r\n        return sensores\r\n            .filter(\r\n                (sensor) =>\r\n                    sensor.sistema === system &&\r\n                    !idBlacklistpriv.includes(sensor.Sistema)\r\n            )\r\n            .map((record) => ({\r\n                value: record.sensor_id,\r\n                label: record.zona,\r\n            }));\r\n    }, [sensores, system]);\r\n\r\n    // Cada que cambie uno de los inputs, se mandan al componente padre porque allá se crea el query\r\n    function updateData() {\r\n        let formData = {\r\n            ubic: ubic.current,\r\n            ind: ind.current,\r\n            desde: desde.current,\r\n            hasta: hasta.current,\r\n            desdeHora: desdeHora.current,\r\n            hastaHora: hastaHora.current\r\n        }\r\n        // console.log(ubic.current)\r\n        props.modifyData(formData, id.current);\r\n    }\r\n    \r\n    return (\r\n        <Col sm={6}>\r\n            <div className=\"compara-filtros mt-2 mb-4\" id={\"filtro-\" + id.current}>\r\n                <Form>\r\n                    <Form.Group as={Row}>\r\n                        <Col sm={12}>\r\n                            <Row>\r\n                                <Col sm={6}>\r\n                                    <Select \r\n                                    options={systemOptions} \r\n                                    placeholder={'Sistema'}\r\n                                    className=\"mb-2\"\r\n                                    onChange={(value) => {\r\n                                        setSystem(value.value)\r\n                                        setLocation(null)\r\n                                        ubic.current = null\r\n                                        updateData()\r\n                                    }}\r\n                                    />\r\n                                    <Select \r\n                                    options={sensorOptions} \r\n                                    value={location}\r\n                                    placeholder={'Ubicación'}\r\n                                    className=\"mb-2\"\r\n                                    onChange={(value) => {\r\n                                        setLocation(value)\r\n                                        ubic.current = value;\r\n                                        updateData()}}\r\n                                    />\r\n                                </Col>\r\n                                <Col sm={6}>\r\n                                    <Select \r\n                                    options={indOptions} \r\n                                    defaultValue={indicadores[0]}\r\n                                    onChange={(value) => {\r\n                                        ind.current = value.value;\r\n                                        updateData()}}\r\n                                />\r\n                                </Col>\r\n                            </Row>\r\n                        </Col>\r\n                    </Form.Group>\r\n                    <Form.Group as={Row}>\r\n                        <Col sm={12}>\r\n                            <Row>\r\n                                <Col sm={6}>\r\n                                    <Row>\r\n                                        <Col sm={3}>\r\n                                            <p>Desde:</p>\r\n                                        </Col>\r\n                                        <Col sm={9}>\r\n                                        <Form.Control \r\n                                        className=\"cf-input\" \r\n                                        type=\"date\" \r\n                                        onChange={(event) => {\r\n                                            desde.current = event.target.value;\r\n                                            updateData()}}>\r\n                                        </Form.Control>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row>\r\n                                        <Col sm={3}></Col>\r\n                                        <Col sm={9}>\r\n                                            <Form.Control \r\n                                            onChange={(event) => {\r\n                                                desdeHora.current = event.target.value + ':00';\r\n                                                updateData()\r\n                                            }}\r\n                                            type=\"time\">\r\n                                            </Form.Control>\r\n                                        </Col>\r\n                                    </Row>\r\n                                </Col>\r\n                                <Col sm={6}>\r\n                                    <Row>\r\n                                        <Col sm={3}>\r\n                                            <p>Hasta:</p>\r\n                                        </Col>\r\n                                        <Col sm={9}>\r\n                                        <Form.Control \r\n                                        className=\"cf-input\" \r\n                                        type=\"date\" \r\n                                        onChange={(event) => {\r\n                                            hasta.current = event.target.value;\r\n                                            updateData()}}>\r\n                                        </Form.Control>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row>\r\n                                        <Col sm={3}></Col>\r\n                                        <Col sm={9}>\r\n                                            <Form.Control\r\n                                            onChange={(event) => {\r\n                                                hastaHora.current = event.target.value + ':00';\r\n                                                updateData()\r\n                                            }}                                            \r\n                                            type=\"time\"></Form.Control>\r\n                                        </Col>\r\n                                    </Row>\r\n                                </Col>\r\n                            </Row>\r\n                        </Col>\r\n                    </Form.Group>\r\n                </Form>\r\n            </div>\r\n        </Col>\r\n    )\r\n}\r\n\r\nexport default ComparaFiltros\r\n","import React, {useRef,  useEffect, useState} from 'react'\r\nimport ComparaFiltros from './components/ComparaFiltros'\r\nimport { Col, Row, Button } from 'react-bootstrap'\r\nimport { fetchSummaryData } from './handlers/data';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setSensorData } from './redux/reducers';\r\nimport moment from 'moment';\r\nimport 'moment/locale/es';\r\nimport { apiUrl } from './constants';\r\nimport Plot from 'react-plotly.js';\r\n\r\nfunction Compara() {\r\n\r\n    const dispatch = useDispatch();\r\n    const { sensorDataLastUpdate, sensorData } = useSelector((state) => state);\r\n    const [sensRaw, setSensRaw] = useState(null);\r\n    let sensores = [];\r\n\r\n    useEffect(() => {\r\n        const diff = sensorDataLastUpdate\r\n            ? moment().diff(sensorDataLastUpdate, 'minutes')\r\n            : 999;\r\n\r\n        if (diff > 60) {\r\n            fetchSummaryData()\r\n                .then((data) => {\r\n                    dispatch(setSensorData(data));\r\n                    setSensRaw(data);\r\n                })\r\n                .catch((err) => console.error(err));\r\n        } else {\r\n            setSensRaw(sensorData);\r\n        }\r\n    }, []);\r\n\r\n    // Crear valores para mandar al componente ComparaFiltros:\r\n    if (sensRaw) {\r\n        sensRaw.forEach(element => {\r\n            sensores.push({sensor_id: element.Sensor_id, zona: element.Zona, sistema: element.Sistema});\r\n        });\r\n    }\r\n\r\n    const maxNum = 3;\r\n    const numFiltros = useRef(-1);\r\n    const [filters, setFilters] = useState([]);\r\n    const filterData = useRef([]);\r\n\r\n    const [data, setData] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n\r\n    // Esta función es llamada por los cada componente hijo (CompraFiltros) cuando se modifican los valores seleccionados\r\n    // Todos los valores de los filtros se guardan en un solo arreglo \r\n    function modifyData(data, index) {\r\n        filterData.current[index] = data;\r\n    }\r\n\r\n    function addFiltro() {\r\n        if (numFiltros.current < maxNum) {\r\n            numFiltros.current = numFiltros.current + 1;\r\n            setFilters([...filters, <ComparaFiltros id={numFiltros.current} modifyData={modifyData} sensores={sensores}/>]);\r\n        }\r\n    }\r\n\r\n    // Elimina el último filtro\r\n    function deleteFiltro() {\r\n        if (numFiltros.current != -1) {\r\n            let filtroDiv = document.getElementById(`filtro-${numFiltros.current}`).parentNode;\r\n            filtroDiv.parentNode.removeChild(filtroDiv);\r\n            numFiltros.current = numFiltros.current - 1;\r\n        }\r\n    }\r\n\r\n    function queryData() {\r\n        if (numFiltros.current < 0) {\r\n            return;\r\n        }\r\n        let ubicaciones = \"\";\r\n        let gases = \"\";\r\n        let fechas_inicio = \"\";\r\n        let fechas_fin = \"\";\r\n\r\n        for (let i=0; i<=numFiltros.current ; i++) {\r\n            if (!filterData.current[i]|| !filterData.current[i][\"desde\"] || !filterData.current[i][\"hasta\"]) { // A alguno le falta seleccionar fechas\r\n                alert(\"Selecciona las fechas\");\r\n                return;\r\n            } else {\r\n                // Unir con comas\r\n                ubicaciones += filterData.current[i][\"ubic\"].label + \",\";\r\n                gases += filterData.current[i][\"ind\"] + \",\";\r\n                fechas_inicio += filterData.current[i][\"desde\"] + \"/\" + filterData.current[i][\"desdeHora\"] + \",\";\r\n                fechas_fin += filterData.current[i][\"hasta\"] + \"/\" + filterData.current[i][\"hastaHora\"] + \",\";\r\n            }\r\n        }\r\n\r\n        // Quitar última coma\r\n        ubicaciones = ubicaciones.slice(0, -1);\r\n        gases = gases.slice(0, -1);\r\n        fechas_inicio = fechas_inicio.slice(0, -1);\r\n        fechas_fin = fechas_fin.slice(0, -1);\r\n\r\n        let query = `ubic=${ubicaciones}&ind=${gases}&inicio=${fechas_inicio}&fin=${fechas_fin}`;\r\n\r\n        setLoading(true); // Muestra gif de loading\r\n\r\n        fetch(`${apiUrl}/compare?${query}`)\r\n            .then((response) => response.json())\r\n            .then((json) => {\r\n                console.log(json)\r\n                setLoading(false);\r\n                setData(json)\r\n            });\r\n\r\n    }\r\n\r\n    useEffect(() => {\r\n        createGraph();\r\n    }, [data])\r\n\r\n    const [limiteOMS, setLimiteOMS] = useState(null);\r\n\r\n    let graphLayout = {\r\n        title: {\r\n            text: 'Compara datos',\r\n        },\r\n        showlegend: true,\r\n        hovermode: 'closest',\r\n        width: 1000,\r\n        height: 700\r\n    };\r\n\r\n    let getAnnotations = () => [\r\n        {\r\n            xref: 'paper',\r\n            x: 1.01,\r\n            y: (limiteOMS),\r\n            xanchor: 'left',\r\n            yanchor: 'middle',\r\n            text: 'Límite recomendado <br>por la OMS 24h',\r\n            showarrow: false,\r\n            font: {\r\n                family: 'Arial',\r\n                size: 12,\r\n                color: 'white'\r\n            },\r\n            bgcolor: '#4682b4',\r\n        }\r\n    ];\r\n\r\n    let getShapes = () => {\r\n        let min1, max1, min2, max2, min3, max3, min4, max4, min5, max5;\r\n\r\n        switch(gas) {\r\n            case 'PM2.5':\r\n                min1 = 0;\r\n                max1 = 25;\r\n                min2 = 25;\r\n                max2 = 45;\r\n                min3 = 45;\r\n                max3 = 79;\r\n                min4 = 79;\r\n                max4 = 147;\r\n                min5 = 147;\r\n                max5 = 172;\r\n                break;\r\n            case 'PM10':\r\n                min1 = 0;\r\n                max1 = 50;\r\n                min2 = 50;\r\n                max2 = 75;\r\n                min3 = 75;\r\n                max3 = 155;\r\n                min4 = 155;\r\n                max4 = 235;\r\n                min5 = 235;\r\n                max5 = 255;\r\n                break;\r\n            case 'O3':\r\n                min1 = 0;\r\n                max1 = 0.051;\r\n                min2 = 0.051;\r\n                max2 = 0.070;\r\n                min3 = 0.070;\r\n                max3 = 0.092;\r\n                min4 = 0.092;\r\n                max4 = 0.114;\r\n                min5 = 0.114;\r\n                max5 = 0.139;\r\n                break;\r\n            case 'CO':\r\n                min1 = 0;\r\n                max1 = 8.75;\r\n                min2 = 8.75;\r\n                max2 = 11;\r\n                min3 = 11;\r\n                max3 = 13.3;\r\n                min4 = 13.3;\r\n                max4 = 15.5;\r\n                min5 = 15.5;\r\n                max5 = 17.5;\r\n                break;\r\n            case 'NO2':\r\n                min1 = 0;\r\n                max1 = 0.107;\r\n                min2 = 0.107;\r\n                max2 = 0.210;\r\n                min3 = 0.210;\r\n                max3 = 0.230;\r\n                min4 = 0.230;\r\n                max4 = 0.250;\r\n                min5 = 0.250;\r\n                max5 = 0.275;\r\n                break;\r\n            case 'SO2':\r\n                min1 = 0;\r\n                max1 = 0.008;\r\n                min2 = 0.008;\r\n                max2 = 0.110;\r\n                min3 = 0.110;\r\n                max3 = 0.165;\r\n                min4 = 0.165;\r\n                max4 = 0.220;\r\n                min5 = 0.220;\r\n                max5 = 0.255;\r\n                break;\r\n            default:\r\n                min1 = 0;\r\n                max1 = 25;\r\n                min2 = 25;\r\n                max2 = 45;\r\n                min3 = 45;\r\n                max3 = 79;\r\n                min4 = 79;\r\n                max4 = 147;\r\n                min5 = 147;\r\n                max5 = 172;\r\n                break;\r\n        }\r\n\r\n        let shapes = [\r\n            // Nivel 1\r\n            {\r\n                type: 'rect',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: min1,\r\n                x1: 1,\r\n                y1: max1,\r\n                fillcolor: 'rgb(0, 228, 0)',\r\n                opacity: 0.3,\r\n                line: {\r\n                    width: 0\r\n                }\r\n            }, \r\n            // Nivel 2\r\n            {\r\n                type: 'rect',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: min2,\r\n                x1: 1,\r\n                y1: max2,\r\n                fillcolor: 'rgb(255, 255, 0)',\r\n                opacity: 0.3,\r\n                line: {\r\n                    width: 0\r\n                }\r\n            }, \r\n            // Nivel 3\r\n            {\r\n                type: 'rect',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: min3,\r\n                x1: 1,\r\n                y1: max3,\r\n                fillcolor: 'rgb(255, 126, 0)',\r\n                opacity: 0.3,\r\n                line: {\r\n                    width: 0\r\n                }\r\n            }, \r\n            // Nivel 4\r\n            {\r\n                type: 'rect',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: min4,\r\n                x1: 1,\r\n                y1: max4,\r\n                fillcolor: 'rgb(255, 0, 0)',\r\n                opacity: 0.3,\r\n                line: {\r\n                    width: 0\r\n                }\r\n            }, \r\n            // Nivel 5\r\n            {\r\n                type: 'rect',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: min5,\r\n                x1: 1,\r\n                y1: max5,\r\n                fillcolor: 'rgb(143, 63, 151)',\r\n                opacity: 0.3,\r\n                line: {\r\n                    width: 0\r\n                }\r\n            },\r\n            {\r\n                type: 'line',\r\n                xref: 'paper',\r\n                x0: 0,\r\n                y0: limiteOMS,\r\n                x1: 1,\r\n                y1: limiteOMS,\r\n                line:{\r\n                    color: '#4682b4',\r\n                    width: 2,\r\n                    dash:'dash'\r\n                }\r\n            } \r\n        ];\r\n        \r\n        return shapes\r\n    }\r\n\r\n\r\n    const [graphData, setGraphData] = useState([]);\r\n    const [gas, setGas] = useState(null);\r\n\r\n    let colors = ['red', 'green', 'blue', 'orange']; // Opciones de color de las líneas\r\n    let colors2 = ['purple', 'pink', 'black', 'cyan']; // Opciones de color de las líneas\r\n    let colors3 = ['orange', 'brown', 'grey', 'maroon']; // Opciones de color de las líneas\r\n\r\n    function createGraph() {\r\n        let graph = [];\r\n        // console.log(data)\r\n        if (data) {\r\n            for (let i = 0; i < data.length; i++) {\r\n                // console.log(filterData.current[i][\"ubic\"].value)\r\n                // console.log(sensores)\r\n                let ubicacion = sensores.find(sensor => sensor.sensor_id === filterData.current[i][\"ubic\"].value).zona;\r\n                let gas = filterData.current[i][\"ind\"] == \"PM25\" ? \"PM2.5\" : filterData.current[i][\"ind\"];\r\n                setGas(gas);\r\n\r\n                switch(gas) {\r\n                    case 'PM2.5':\r\n                        setLimiteOMS(15);\r\n                        break;\r\n                    case 'PM10':\r\n                        setLimiteOMS(45);\r\n                        break;\r\n                    case 'O3':\r\n                        setLimiteOMS(0.051);\r\n                        break;\r\n                    case 'NO2':\r\n                        setLimiteOMS(0.013);\r\n                        break;\r\n                    case 'SO2':\r\n                        setLimiteOMS(0.015);\r\n                        break;\r\n                    default:\r\n                        setLimiteOMS(null);\r\n                        break;\r\n                }\r\n\r\n                data[i].name = `${ubicacion} (${gas})`; \r\n                data[i].type = \"scatter\";\r\n                data[i].mode = \"lines\";\r\n                data[i].marker = { color: colors[i] };\r\n                \r\n                data[i].text = data[i].dia.map(function(d) { return moment.utc(new Date(d)).format('DD-MM-YYYY HH:mm:ss') } );\r\n\r\n                data[i].hovertemplate = '<i>Medida</i>: %{y:.4f}' +'<br><b>%{text}</b>'; // Tooltip\r\n\r\n                graph.push(data[i]);\r\n\r\n                if(gas == 'PM2.5' || gas == 'PM10') {\r\n                    // Agregar promedio movil 24h\r\n                    const dataPromMovil = { ...data[i] }\r\n                    dataPromMovil.name = `${ubicacion} (${gas}) Promedio movil 24h`\r\n                    dataPromMovil.marker = { color: colors2[i] }\r\n                    // for(let i=0;i<23;i++) {\r\n                    //     moving_average.unshift(null)\r\n                    // }\r\n                    dataPromMovil.y = dataPromMovil.moving_average;\r\n                    graph.push(dataPromMovil)\r\n                    \r\n                    // Agregar Indice aire y salud\r\n                    const dataICAR = { ...data[i] }\r\n                    dataICAR.name = `${ubicacion} (${gas}) Indice Aire y Salud`\r\n                    dataICAR.marker = { color: colors3[i] }\r\n                    // for(let i=0;i<23;i++) {\r\n                    //     moving_average.unshift(null)\r\n                    // }\r\n                    dataICAR.y = dataICAR.ICAR;\r\n                    graph.push(dataICAR)\r\n\r\n                } else if (gas == 'SO2') {\r\n                    // Agregar promedio movil 24h\r\n                    const dataPromMovil = { ...data[i] }\r\n                    dataPromMovil.name = `${ubicacion} (${gas}) Promedio movil 24h`\r\n                    dataPromMovil.marker = { color: colors2[i] }\r\n                    // for(let i=0;i<23;i++) {\r\n                    //     moving_average.unshift(null)\r\n                    // }\r\n                    dataPromMovil.y = dataPromMovil.moving_average;\r\n                    graph.push(dataPromMovil)\r\n                    \r\n                } else if (gas == 'CO') {\r\n                    // Agregar promedio movil 8h\r\n                    const dataPromMovil = { ...data[i] }\r\n                    dataPromMovil.name = `${ubicacion} (${gas}) Promedio movil 8h`\r\n                    dataPromMovil.marker = { color: colors2[i] }\r\n                    // for(let i=0;i<7;i++) {\r\n                    //     moving_average.unshift(null)\r\n                    // }\r\n                    dataPromMovil.y = dataPromMovil.moving_average;\r\n                    graph.push(dataPromMovil)\r\n                }\r\n            }\r\n\r\n            setGraphData(graph);\r\n        }\r\n\r\n    }\r\n    \r\n    return (\r\n        <div className=\"container mt-5\">\r\n            <div className=\"ta-center mb-5\">\r\n                <h2>Compara datos</h2>\r\n                <p>Compara la calidad del aire en diferente lugar y tiempo</p>\r\n            </div>\r\n            <hr className=\"mb-4\"/>\r\n            <Row className=\"mt-2 mb-1 d-flex justify-content-center\" id=\"filtros\">\r\n                {filters}\r\n            </Row>\r\n            <Row className=\"d-flex justify-content-end\">\r\n                <Col sm={6} className=\"d-flex justify-content-between\">\r\n                    <Button onClick={() => addFiltro()}>Agregar un filtro</Button>\r\n                    <Button onClick={() => deleteFiltro()}>Eliminar un filtro</Button>\r\n                    <Button onClick={() => queryData()}>Generar gráfica</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n            <Col sm={12}>\r\n                <div className=\"text-center\">\r\n                    <img\r\n                        src=\"loading.gif\"\r\n                        alt=\"Cargando...\"\r\n                        className=\"loading\"\r\n                        style={loading ? {} : { display: 'none' }}\r\n                    />\r\n                </div>\r\n                <div class=\"grafico-compara mt-5\">\r\n                    <Plot\r\n                        data={graphData}\r\n                        layout={ data ? {...graphLayout, shapes: getShapes(), annotations: getAnnotations()} : {...graphLayout}}\r\n                    />\r\n                </div>\r\n            </Col>\r\n            </Row>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Compara\r\n","import { Nav, Navbar } from 'react-bootstrap';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { useState } from 'react'\r\n\r\nconst Header = () => {\r\n    const [expanded, setExpanded] = useState(false);\r\n\r\n    return (\r\n        <Navbar variant=\"dark\" expand=\"lg\" expanded={expanded}>\r\n            <Navbar.Brand>\r\n                <NavLink to=\"/\">\r\n                    <img\r\n                        src=\"/logo.jpg\"\r\n                        width=\"40\"\r\n                        height=\"40\"\r\n                        className=\"d-inline-block align-top\"\r\n                        alt=\"React Bootstrap logo\"\r\n                    />\r\n                </NavLink>\r\n            </Navbar.Brand>\r\n            <Navbar.Text>\r\n                <h1 className=\"white h1-nav mb-0\">Comité Ecológico Integral (Beta)</h1>\r\n            </Navbar.Text>\r\n            <Navbar.Toggle aria-controls=\"basic-navbar-nav\" onClick={() => setExpanded(expanded ? false : \"expanded\")} />\r\n            <Navbar.Collapse id=\"basic-navbar-nav\">\r\n                <Nav className=\"ml-auto\">\r\n                <NavLink  onClick={() => setExpanded(false)} activeClassName=\"nav-active\" className=\"menu-link\" exact to=\"/\">Mapa</NavLink>\r\n                <NavLink  onClick={() => setExpanded(false)} activeClassName=\"nav-active\" className=\"menu-link\" to=\"/registro\">Registro histórico</NavLink>\r\n                <NavLink  onClick={() => setExpanded(false)} activeClassName=\"nav-active\" className=\"menu-link\" to=\"/compara\">Compara datos</NavLink>\r\n                <NavLink  onClick={() => setExpanded(false)} activeClassName=\"nav-active\" className=\"menu-link\" to=\"/\">Acerca de</NavLink>\r\n                </Nav>\r\n            </Navbar.Collapse>\r\n        </Navbar>\r\n    )\r\n}\r\n\r\nexport default Header\r\n","import React from 'react';\r\n\r\nconst Footer = () => {\r\n    return (\r\n        <footer>\r\n            <div className=\"container\">\r\n                <div className=\"row\">\r\n                    <div className=\"col-auto py-3\">\r\n                        <p className=\"mb-1 mt-2\">\r\n                            Los datos oficiales provienen de{' '}\r\n                            <a className='text-white' href=\"https://sinaica.inecc.gob.mx/\">Sinaica</a>{' '}\r\n                            y de <a className='text-white' href=\"http://aire.nl.gob.mx/\">Sima</a>\r\n                        </p>\r\n                        <p className=\"mb-1\">Patrocinado por Natuuramika® 2021</p>\r\n                        <p>Proyecto Solidario TEC de Monterrey</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </footer>\r\n    );\r\n};\r\n\r\nexport default Footer;\r\n","import './App.css';\r\nimport Mapa from './Mapa';\r\nimport Registro from './Registro';\r\nimport Compara from './Compara';\r\nimport { Route, Switch, BrowserRouter } from 'react-router-dom';\r\nimport Header from './components/Header.js';\r\nimport Footer from './components/Footer.js';\r\n\r\nfunction App() {\r\n    return (\r\n        <div className=\"App\">\r\n            <BrowserRouter>\r\n                <Header />\r\n                <Switch>\r\n                    <Route exact path=\"/\" component={Mapa} />\r\n                    <Route exact path=\"/registro\" component={Registro} />\r\n                    <Route exact path=\"/compara\" component={Compara} />\r\n                </Switch>\r\n                <Footer />\r\n            </BrowserRouter>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { createStore } from 'redux';\r\nimport { persistStore, persistReducer } from 'redux-persist';\r\nimport storage from 'redux-persist/lib/storage';\r\n\r\nimport rootReducer from './reducers';\r\n\r\nconst persistedReducer = persistReducer(\r\n    {\r\n        key: 'root',\r\n        storage,\r\n    },\r\n    rootReducer\r\n);\r\n\r\n// const config = \r\n\r\nexport default () => {\r\n    let store = createStore(persistedReducer);\r\n    let persistor = persistStore(store);\r\n    return { store, persistor };\r\n};\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport reduxConfig from './redux/config';\r\nimport { Provider } from 'react-redux';\r\nimport { PersistGate } from 'redux-persist/integration/react';\r\n\r\nconst { store, persistor } = reduxConfig();\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <PersistGate loading={null} persistor={persistor}>\r\n            <BrowserRouter>\r\n                <App />\r\n            </BrowserRouter>\r\n        </PersistGate>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}